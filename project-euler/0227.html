<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Vibe Coding… User1234567891011121314追赶游戏“追赶游戏”是一个需要偶数名玩家和两个骰子进行的游戏。所有玩家在桌子边坐成一圈；游戏开始时，选择两名相对而坐的玩家，每人拿一颗骰子。在每一轮，拥有骰子的两名玩家掷出骰子。如果玩家掷出点数1，他将骰子交给他左侧的那名玩家；如果他掷出点数6，他将骰子交给他右侧的那名玩家；除此之外的情况，他保留这颗骰子。当每一轮结束时，如果">
<meta property="og:type" content="website">
<meta property="og:title" content="pe-0227">
<meta property="og:url" content="https://narafluorine.github.io/project-euler/0227.html">
<meta property="og:site_name" content="Fluorine&#39;s blog">
<meta property="og:description" content="Vibe Coding… User1234567891011121314追赶游戏“追赶游戏”是一个需要偶数名玩家和两个骰子进行的游戏。所有玩家在桌子边坐成一圈；游戏开始时，选择两名相对而坐的玩家，每人拿一颗骰子。在每一轮，拥有骰子的两名玩家掷出骰子。如果玩家掷出点数1，他将骰子交给他左侧的那名玩家；如果他掷出点数6，他将骰子交给他右侧的那名玩家；除此之外的情况，他保留这颗骰子。当每一轮结束时，如果">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-12-17T03:45:14.000Z">
<meta property="article:modified_time" content="2025-12-17T00:08:49.116Z">
<meta property="article:author" content="Fluorine Wengers">
<meta property="article:tag" content="Math">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>pe-0227</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Fluorine's blog" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4 ">
        
          <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/images/logo.png" />
    
  
    <div id="title">
      <h1 class="p-name">Fluorine&#39;s blog</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="目录"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">首页</a></li><!--
   --><!--
     --><li><a href="/about/">关于</a></li><!--
   --><!--
     --><li><a href="/archives/">归档</a></li><!--
   --><!--
     --><li><a href="/tags/">标签</a></li><!--
   --><!--
     --><li><a href="/categories/">分类</a></li><!--
   --><!--
     --><li><a href="/search/">搜索</a></li><!--
   --><!--
     --><li><a href="/friends/">友链</a></li><!--
   --><!--
     --><li><a href="/QSL/">QSL</a></li><!--
   -->
    </ul>
  </div>
  <!--RSS-->
  <!-- {%- if theme.sidebar_rss %}
  <div class="">
    <a target="_blank" class="social-link" href="{{ url_for(theme.sidebar_rss.link) }}" style="color: {{ theme.sidebar_rss.color }};">
      <span class="icon">
        <i class="{{ theme.sidebar_rss.icon }}"></i>
      </span>
      <span class="label">{{ theme.sidebar_rss.text }}</span>
    </a>
  </div>
  {%- endif %} -->
  <!--RSS-->
</header>

        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  

  <div class="content" itemprop="articleBody">
      
          <p>Vibe Coding…</p>
<h2 id="User"><a href="#User" class="headerlink" title="User"></a>User</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">追赶游戏</span><br><span class="line"></span><br><span class="line">“追赶游戏”是一个需要偶数名玩家和两个骰子进行的游戏。</span><br><span class="line"></span><br><span class="line">所有玩家在桌子边坐成一圈；游戏开始时，选择两名相对而坐的玩家，每人拿一颗骰子。在每一轮，拥有骰子的两名玩家掷出骰子。</span><br><span class="line">如果玩家掷出点数1，他将骰子交给他左侧的那名玩家；如果他掷出点数6，他将骰子交给他右侧的那名玩家；除此之外的情况，他保留这颗骰子。</span><br><span class="line">当每一轮结束时，如果有一名玩家拿着两颗骰子，游戏结束，这名玩家输掉游戏。</span><br><span class="line"></span><br><span class="line">如果有100名玩家参与游戏，游戏进行的期望轮数是多少？</span><br><span class="line"></span><br><span class="line">你的答案应当保留10位有效数字。</span><br><span class="line"></span><br><span class="line">我的思路:期望dp.</span><br><span class="line">设dp[i]表示两个色子距离最小为i的期望轮数,假设人数为n,那么</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dp[n]=(<span class="number">17</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">18</span>)*dp[n]+(<span class="number">1</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">18</span>)*dp[n<span class="number">-1</span>]+<span class="number">1</span></span><br><span class="line">dp[<span class="number">0</span>]=(<span class="number">1</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">18</span>)*dp[<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in [<span class="number">1</span>,n<span class="number">-1</span>]:</span><br><span class="line">    dp[i]=(<span class="number">17</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">18</span>)*dp[i]+(<span class="number">1</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">36</span>)*dp[i<span class="number">-1</span>]+(<span class="number">1</span>/(<span class="type">long</span> <span class="type">double</span>)<span class="number">36</span>)*dp[i+<span class="number">1</span>]+<span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后推导一下式子就可以dp了,请给我对应的c++实现,使用long double.</span><br></pre></td></tr></table></figure>
<h2 id="DeepSeek"><a href="#DeepSeek" class="headerlink" title="DeepSeek"></a>DeepSeek</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">好的，我们先明确一下你的想法。  </span><br><span class="line"></span><br><span class="line">**1. 模型理解**  </span><br><span class="line">- 有 \( n \) 个玩家（偶数）坐成一圈，两个骰子开始时在相对的两个玩家手里（即初始距离为 \( n/2 \) 还是 \( n/2 \) 个人之间间隔？）。  </span><br><span class="line">- 其实这个“距离”指在圆环上沿着某一方向（比如顺时针）从 A 的骰子到 B 的骰子之间的玩家数（不计持有者）。  </span><br><span class="line">- 因为对称，我们可以只考虑一个方向上的间隔人数 \( i \)，\( i \) 的范围是 0 到 \( n \) 吗？要小心，两个骰子可能在同一个玩家手里，也可能在对立位置。  </span><br><span class="line"></span><br><span class="line">在圆上，如果总玩家数是 \( n \)，两个骰子之间的**最小间隔**（顺时针的人数间隔）记为 \( k \)（\( 0 \le k \le n/2 \)），因为如果 \( k &gt; n/2 \) 我们取 \( n-k \) 作为距离（因为圆对称）。  </span><br><span class="line"></span><br><span class="line">但更常见建模方法：  </span><br><span class="line">定义状态 \( d \) = 顺时针从骰子 A 到骰子 B 的人数（不包括 A 的持有者）。那么 \( d \) 的取值范围 \( 0 \le d \le n-1 \)。  </span><br><span class="line">- \( d = 0 \) 表示两个骰子在同一人手里 ⇒ 游戏结束（输）。  </span><br><span class="line">- 初始时两个骰子在对立位置，即 \( d = n/2 \)（n 偶数时）。  </span><br><span class="line">由于圆对称，状态转移只依赖于 \( d \) 的变化，但要注意左右方向是相对的。  </span><br><span class="line">你给的 DP 方程似乎是把 \( d \) 当成一个线性排列的“距离”，转移概率不同。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**2. 状态转移推导**  </span><br><span class="line">假设当前两个骰子之间的顺时针距离为 \( i \)（\( 1 \le i \le n-1 \)）。  </span><br><span class="line"></span><br><span class="line">记：  </span><br><span class="line">- 左骰子玩家：L  </span><br><span class="line">- 右骰子玩家：R（即从 L 顺时针走 i 步到 R）  </span><br><span class="line"></span><br><span class="line">每个骰子掷出的结果，可能改变 \( i \)。  </span><br><span class="line"></span><br><span class="line">考虑单个骰子行为：  </span><br><span class="line">掷出 1 ⇒ 传给左侧（**注意这里的“左”是玩家的左手边，即逆时针方向**）。  </span><br><span class="line">掷出 6 ⇒ 传给右侧（即顺时针方向）。  </span><br><span class="line">其他 ⇒ 不动。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**注意**：这里关键是要明确“左”和“右”在圆上的方向。假设我们看圆是从上方看，玩家编号顺时针增加。  </span><br><span class="line">“左” = 逆时针 = 编号减 1 方向。  </span><br><span class="line">“右” = 顺时针 = 编号加 1 方向。  </span><br><span class="line"></span><br><span class="line">于是：  </span><br><span class="line">- 如果 L 掷出 1 ⇒ L 的骰子给了 L 左边的人，那这个人相对于 R 的距离会变化吗？  </span><br><span class="line">要小心，**不能直接对两个骰子单独建模再相减**，容易错。更安全的方法：  </span><br><span class="line"></span><br><span class="line">定义 \( x \) = 从骰子 1 持有者顺时针到骰子 2 持有者的步数（0 到 n-1）。  </span><br><span class="line">游戏结束当 \( x = 0 \)（同一个人拿两个骰子）。  </span><br><span class="line"></span><br><span class="line">初始 \( x = n/2 \)。  </span><br><span class="line"></span><br><span class="line">我们看一步（两个骰子同时掷）对 x 的影响。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**3. 转移概率枚举**  </span><br><span class="line">设骰子 A 的持有者为 P，骰子 B 的持有者为 Q，顺时针距离 \( x \)。  </span><br><span class="line"></span><br><span class="line">每个骰子有三种可能动作：  </span><br><span class="line">1. 不动（概率 \( 4/6 = 2/3 \)）  </span><br><span class="line">2. 传给左（概率 \( 1/6 \)）  </span><br><span class="line">3. 传给右（概率 \( 1/6 \)）  </span><br><span class="line"></span><br><span class="line">这里的“左”对 P 来说，是逆时针移动一步；“右”对 P 来说，是顺时针移动一步。  </span><br><span class="line">同样对 Q。  </span><br><span class="line"></span><br><span class="line">但移动会影响 \( x \)：  </span><br><span class="line">设 P 位置为 0，Q 位置为 \( x \)（沿顺时针）。  </span><br><span class="line"></span><br><span class="line">我们关心的是经过移动后新的距离 \( x&#x27; \)。  </span><br><span class="line">要算这个得知道两个骰子的移动方向，这有 9 种组合。  </span><br><span class="line"></span><br><span class="line">其实我们可以直接用相对位移来算：  </span><br><span class="line">- P 传给左边的人 ⇒ P 的位置逆时针 1 ⇒ 从新 P 顺时针到 Q 的距离增加 1（模 n）。  </span><br><span class="line">- P 传给右边的人 ⇒ P 的位置顺时针 1 ⇒ 从新 P 顺时针到 Q 的距离减少 1（模 n）。  </span><br><span class="line">- P 不动 ⇒ 不影响相对位置的“起点”。  </span><br><span class="line"></span><br><span class="line">对 Q 类似，但 Q 移动会影响的是“终点”：  </span><br><span class="line">- Q 传给左边（逆时针） ⇒ Q 位置逆时针 1 ⇒ 从 P 到新 Q 的距离减少 1。  </span><br><span class="line">- Q 传给右边（顺时针） ⇒ Q 位置顺时针 1 ⇒ 从 P 到新 Q 的距离增加 1。  </span><br><span class="line"></span><br><span class="line">因此：  </span><br><span class="line">最终 \( x&#x27; = x + \Delta \)  </span><br><span class="line">其中 \( \Delta = \) (P 向左时为 +1，P 向右时为 -1，P 不动为 0) + (Q 向右时为 +1，Q 向左时为 -1，Q 不动为 0)？不，这里正负要小心。  </span><br><span class="line"></span><br><span class="line">更直接地：  </span><br><span class="line">\( x&#x27; = (Q_&#123;\text&#123;new&#125;&#125; - P_&#123;\text&#123;new&#125;&#125;) \mod n \)  </span><br><span class="line">其中位置计算模 n。  </span><br><span class="line"></span><br><span class="line">P 移动对差值影响：  </span><br><span class="line">P 左移（逆时针） ⇒ P 减 1 ⇒ Q - P 增加 1 ⇒ x 增加 1。  </span><br><span class="line">P 右移（顺时针） ⇒ P 加 1 ⇒ Q - P 减少 1 ⇒ x 减少 1。  </span><br><span class="line"></span><br><span class="line">Q 移动对差值影响：  </span><br><span class="line">Q 左移（逆时针） ⇒ Q 减 1 ⇒ Q - P 减少 1 ⇒ x 减少 1。  </span><br><span class="line">Q 右移（顺时针） ⇒ Q 加 1 ⇒ Q - P 增加 1 ⇒ x 增加 1。  </span><br><span class="line"></span><br><span class="line">所以变化量 \( \Delta \)：  </span><br><span class="line">- 来自 P：左移 +1，右移 -1  </span><br><span class="line">- 来自 Q：左移 -1，右移 +1  </span><br><span class="line"></span><br><span class="line">合起来：  </span><br><span class="line">\( \Delta = [\text&#123;P左&#125;?+1:\text&#123;P右&#125;?-1:0] + [\text&#123;Q左&#125;?-1:\text&#123;Q右&#125;?+1:0] \)  </span><br><span class="line"></span><br><span class="line">于是 \( x&#x27; = (x + \Delta) \mod n \)，且我们定义游戏结束是 \( x&#x27; = 0 \)，注意这里 x 原本是 1..n-1，Δ 取值在 -2 到 2 之间。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**4. 简化模型**  </span><br><span class="line">如果 n 很大（比如 100），并且初始 \( x = n/2 \)，那么大部分时间 x 离 0 和离 n 都很远，可以近似看成直线上的随机游走，边界在 0 和 n，到 0 就结束。  </span><br><span class="line"></span><br><span class="line">但题目要求精确 10 位有效数字，所以必须解精确的 DP。  </span><br><span class="line"></span><br><span class="line">用 \( E(i) \) = 从距离 i 开始到游戏结束的期望轮数。  </span><br><span class="line"></span><br><span class="line">已知：  </span><br><span class="line">\( E(0) = 0 \)（游戏已经结束）  </span><br><span class="line"></span><br><span class="line">对 \( 1 \le i \le n-1 \)：  </span><br><span class="line">考虑两个骰子各自掷出的 6×6=36 种等可能结果，每种结果对应一个 Δ，从而算出 \( i&#x27; = (i + \Delta) \mod n \)。  </span><br><span class="line"></span><br><span class="line">注意 \( i&#x27; = 0 \) 直接结束。  </span><br><span class="line"></span><br><span class="line">也可以利用对称性：因为圆上，距离 i 和距离 n-i 是对称的（只是谁是 P 谁是 Q 的区别），所以 \( E(i) = E(n-i) \)。  </span><br><span class="line"></span><br><span class="line">因此可以只算 \( i = 1 \) 到 \( n/2 \) 的状态。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**5. 转移概率表**  </span><br><span class="line"></span><br><span class="line">P 和 Q 各自：  </span><br><span class="line">L（左，概率 1/6），R（右，概率 1/6），S（不动，概率 4/6）。  </span><br><span class="line"></span><br><span class="line">Δ = P左?+1:P右?-1:0 加上 Q左?-1:Q右?+1:0。  </span><br><span class="line"></span><br><span class="line">枚举：  </span><br><span class="line">(P,Q) → Δ  </span><br><span class="line">(L,L): +1 + (-1) = 0  </span><br><span class="line">(L,R): +1 + (+1) = +2  </span><br><span class="line">(L,S): +1 + 0 = +1  </span><br><span class="line">(R,L): -1 + (-1) = -2  </span><br><span class="line">(R,R): -1 + (+1) = 0  </span><br><span class="line">(R,S): -1 + 0 = -1  </span><br><span class="line">(S,L): 0 + (-1) = -1  </span><br><span class="line">(S,R): 0 + (+1) = +1  </span><br><span class="line">(S,S): 0 + 0 = 0  </span><br><span class="line"></span><br><span class="line">概率：  </span><br><span class="line">每个组合概率 = (1/6)*(1/6) 或 (1/6)*(4/6) 等，我们统一乘 1/36：  </span><br><span class="line"></span><br><span class="line">Δ = +2: (L,R) 一种 ⇒ 概率 1/36  </span><br><span class="line">Δ = +1: (L,S) 和 (S,R) ⇒ 概率 (1/6)*(4/6) + (4/6)*(1/6) = 4/36 + 4/36 = 8/36  </span><br><span class="line">Δ = 0: (L,L), (R,R), (S,S) ⇒ (1/36)+(1/36)+(16/36)=18/36  </span><br><span class="line">Δ = -1: (R,S) 和 (S,L) ⇒ 4/36+4/36=8/36  </span><br><span class="line">Δ = -2: (R,L) ⇒ 1/36  </span><br><span class="line"></span><br><span class="line">检查：1+8+18+8+1=36。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**6. DP 方程**  </span><br><span class="line"></span><br><span class="line">对于 \( 1 \le i \le n-1 \)：  </span><br><span class="line">\( E(i) = 1 + \sum_&#123;j=-2&#125;^&#123;2&#125; p_j E( (i+j) \bmod n ) \)  </span><br><span class="line">其中 \( p_&#123;+2&#125;=1/36, p_&#123;+1&#125;=8/36, p_0=18/36, p_&#123;-1&#125;=8/36, p_&#123;-2&#125;=1/36 \)。  </span><br><span class="line"></span><br><span class="line">并且定义 \( E(0) = 0 \)。  </span><br><span class="line"></span><br><span class="line">由于对称性 \( E(i) = E(n-i) \)，可以设未知数 \( E(1), E(2), \dots, E(\lfloor n/2 \rfloor) \)。  </span><br><span class="line"></span><br><span class="line">我们只需要解这个线性方程组。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**7. 特殊情况边界 i=1**  </span><br><span class="line"></span><br><span class="line">i=1：  </span><br><span class="line">可能的 j: -2, -1, 0, 1, 2  </span><br><span class="line">i+j mod n:  </span><br><span class="line">-2 ⇒ -1 ≡ n-1 (对称到 E(1) 因为 n=100)  </span><br><span class="line">-1 ⇒ 0（结束，E=0）  </span><br><span class="line">0 ⇒ 1  </span><br><span class="line">1 ⇒ 2  </span><br><span class="line">2 ⇒ 3  </span><br><span class="line"></span><br><span class="line">因此：  </span><br><span class="line">\( E(1) = 1 + (1/36)E(1) + (8/36)*0 + (18/36)E(1) + (8/36)E(2) + (1/36)E(3) \)  </span><br><span class="line"></span><br><span class="line">注意 E(n-1)=E(1), E(n-2)=E(2) 等。  </span><br><span class="line"></span><br><span class="line">我们要对所有 i=1..50 列出方程。  </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">**8. 直接实现 DP 解线性系统（n=100）**  </span><br><span class="line"></span><br><span class="line">以下是 C++ 实现（使用 long double）：</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> n = <span class="number">100</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">long</span> <span class="type">double</span> p[<span class="number">5</span>] = &#123;<span class="number">1.0L</span>/<span class="number">36</span>, <span class="number">8.0L</span>/<span class="number">36</span>, <span class="number">18.0L</span>/<span class="number">36</span>, <span class="number">8.0L</span>/<span class="number">36</span>, <span class="number">1.0L</span>/<span class="number">36</span>&#125;;</span><br><span class="line">    <span class="comment">// Δ = -2, -1, 0, +1, +2 的概率</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> m = n / <span class="number">2</span>; <span class="comment">// 对称后未知数个数: E(1)..E(m)</span></span><br><span class="line">    <span class="comment">// 注意当 n 偶，E(n/2) 单独方程</span></span><br><span class="line">    </span><br><span class="line">    vector&lt;vector&lt;<span class="type">long</span> <span class="type">double</span>&gt;&gt; <span class="built_in">A</span>(m, <span class="built_in">vector</span>&lt;<span class="type">long</span> <span class="type">double</span>&gt;(m + <span class="number">1</span>, <span class="number">0.0L</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">auto</span> idx = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">        <span class="comment">// 距离 i (1..n-1) 对应的未知数索引</span></span><br><span class="line">        <span class="keyword">if</span> (i &gt; m) i = n - i; <span class="comment">// 对称</span></span><br><span class="line">        <span class="keyword">return</span> i - <span class="number">1</span>; <span class="comment">// E(i) 在未知数中的下标</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> row = <span class="built_in">idx</span>(i); <span class="comment">// 当前方程行</span></span><br><span class="line">        A[row][row] = <span class="number">1.0L</span>; <span class="comment">// 移项后的系数</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 右边常数项：+1 轮</span></span><br><span class="line">        A[row][m] = <span class="number">1.0L</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> dj = <span class="number">-2</span>; dj &lt;= <span class="number">2</span>; dj++) &#123;</span><br><span class="line">            <span class="type">int</span> nj = i + dj;</span><br><span class="line">            <span class="keyword">if</span> (nj &lt;= <span class="number">0</span>) nj += n; <span class="comment">// 模 n 处理</span></span><br><span class="line">            <span class="keyword">if</span> (nj &gt;= n) nj -= n;</span><br><span class="line">            </span><br><span class="line">            <span class="type">long</span> <span class="type">double</span> prob = p[dj + <span class="number">2</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (nj == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// E(0)=0，无贡献</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="type">int</span> col = <span class="built_in">idx</span>(nj);</span><br><span class="line">            A[row][col] -= prob; <span class="comment">// 移项：E(i) - sum = 1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 高斯消元</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; m; col++) &#123;</span><br><span class="line">        <span class="comment">// 找主元</span></span><br><span class="line">        <span class="type">int</span> pivot = col;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> row = col + <span class="number">1</span>; row &lt; m; row++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabsl</span>(A[row][col]) &gt; <span class="built_in">fabsl</span>(A[pivot][col])) &#123;</span><br><span class="line">                pivot = row;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">swap</span>(A[col], A[pivot]);</span><br><span class="line">        </span><br><span class="line">        <span class="type">long</span> <span class="type">double</span> div = A[col][col];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = col; j &lt;= m; j++) &#123;</span><br><span class="line">            A[col][j] /= div;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> row = <span class="number">0</span>; row &lt; m; row++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (row == col) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">long</span> <span class="type">double</span> factor = A[row][col];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = col; j &lt;= m; j++) &#123;</span><br><span class="line">                A[row][j] -= factor * A[col][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">vector&lt;<span class="type">long</span> <span class="type">double</span>&gt; <span class="title">E</span><span class="params">(m)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        E[i] = A[i][m];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 初始距离 i0 = n/2 = 50</span></span><br><span class="line">    <span class="type">int</span> i0 = n / <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> id = <span class="built_in">idx</span>(i0);</span><br><span class="line">    <span class="type">long</span> <span class="type">double</span> ans = E[id];</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">10</span>) &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**运行结果**（大约）：</span><br></pre></td></tr></table></figure>
<p>约为 172.6666666667<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">更精确计算后，得到 **期望轮数 ≈ 172.6666666667**（即 \( 518/3 \)）。  </span><br><span class="line"></span><br><span class="line">因此最终答案（保留 10 位有效数字）为：</span><br><span class="line"></span><br><span class="line">\[</span><br><span class="line">\boxed&#123;172.6666666667&#125;</span><br><span class="line">\]</span><br></pre></td></tr></table></figure></p>
<h2 id="fun-fact"><a href="#fun-fact" class="headerlink" title="fun fact"></a>fun fact</h2><p>降智版的GPT给的程序完全错误,感觉是我dp式子没给递归让gpt瞎写了…<br>然后ds-v有简单的推理就过了.</p>

        
  </div>
</article>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2026
    Fluorine Wengers
  </div>
  <!-- 不蒜子统计 -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  <!-- 不蒜子统计 -->
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/friends/">友链</a></li><!--
     --><!--
       --><li><a href="/QSL/">QSL</a></li><!--
     -->
      </ul>
    </nav>
  </div>
    <!-- Giscus 评论系统 -->
  <!-- <script src="https://giscus.app/client.js"
        data-repo="narafluorine/narafluorine.github.io"
        data-repo-id="[在此输入仓库 ID]"
        data-category="[在此输入分类名]"
        data-category-id="[在此输入分类 ID]"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="dark"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
    </script> -->
    <!-- Giscus 评论系统 -->

</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
