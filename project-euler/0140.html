<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="建议和137题连起来看. 根据137题的thread,我们首先用生成函数表示整个数列,然后令整数n等于式子,由于x是有理数,所以delta必须是平方数. 得到一个pell方程. user12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849修正斐波那契金块考虑无穷级数A_G(">
<meta property="og:type" content="website">
<meta property="og:title" content="pe-0140">
<meta property="og:url" content="https://narafluorine.github.io/project-euler/0140.html">
<meta property="og:site_name" content="Fluorine&#39;s blog">
<meta property="og:description" content="建议和137题连起来看. 根据137题的thread,我们首先用生成函数表示整个数列,然后令整数n等于式子,由于x是有理数,所以delta必须是平方数. 得到一个pell方程. user12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849修正斐波那契金块考虑无穷级数A_G(">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-12-17T03:45:14.000Z">
<meta property="article:modified_time" content="2026-01-11T08:16:46.372Z">
<meta property="article:author" content="Fluorine Wang">
<meta property="article:tag" content="Math">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>pe-0140</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Fluorine's blog" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4 ">
        
          <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/images/logo.png" />
    
  
    <div id="title">
      <h1 class="p-name">Fluorine&#39;s blog</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="目录"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">首页</a></li><!--
   --><!--
     --><li><a href="/about/">关于</a></li><!--
   --><!--
     --><li><a href="/archives/">归档</a></li><!--
   --><!--
     --><li><a href="/tags/">标签</a></li><!--
   --><!--
     --><li><a href="/categories/">分类</a></li><!--
   --><!--
     --><li><a href="/search/">搜索</a></li><!--
   --><!--
     --><li><a href="/friends/">友链</a></li><!--
   --><!--
     --><li><a href="/QSL/">QSL</a></li><!--
   -->
    </ul>
  </div>
  <!--RSS-->
  <!-- {%- if theme.sidebar_rss %}
  <div class="">
    <a target="_blank" class="social-link" href="{{ url_for(theme.sidebar_rss.link) }}" style="color: {{ theme.sidebar_rss.color }};">
      <span class="icon">
        <i class="{{ theme.sidebar_rss.icon }}"></i>
      </span>
      <span class="label">{{ theme.sidebar_rss.text }}</span>
    </a>
  </div>
  {%- endif %} -->
  <!--RSS-->
</header>

        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  

  <div class="content" itemprop="articleBody">
      
          <p>建议和137题连起来看.</p>
<p>根据137题的thread,我们首先用生成函数表示整个数列,然后令整数n等于式子,由于x是有理数,所以delta必须是平方数.</p>
<p>得到一个pell方程.</p>
<h2 id="user"><a href="#user" class="headerlink" title="user"></a>user</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">修正斐波那契金块</span><br><span class="line"></span><br><span class="line">考虑无穷级数A_G(x) = xG_1 + x^2G_2 + x^3G_3 + …，其中G_k是二阶递归关系G_k = G_&#123;k-1&#125; + G_&#123;k-2&#125;的第k项，其中G_1 = 1，G_2 = 4，该序列为1, 4, 5, 9, 14, 23, … 。</span><br><span class="line"></span><br><span class="line">在这个问题中，我们感兴趣的是那些使得A_G(x)为正整数的x。</span><br><span class="line"></span><br><span class="line">对应于前五个自然数的x如下所示。</span><br><span class="line"></span><br><span class="line">x   A_G(x)</span><br><span class="line">(√5-1)/4    1</span><br><span class="line">2/5 2</span><br><span class="line">(√22-2)/6   3</span><br><span class="line">(√137-5)/14 4</span><br><span class="line">1/2 5</span><br><span class="line">当x是有理数时，我们称A_G(x)是一个修正斐波那契金块，因为这样的数将会变得越来越稀少，例如，第20个修正斐波那契金块将是211345365。</span><br><span class="line"></span><br><span class="line">求前30个修正斐波那契金块的和。</span><br><span class="line"></span><br><span class="line">我的思路:生成函数.</span><br><span class="line"></span><br><span class="line">$$\begin&#123;aligned&#125;</span><br><span class="line">A_G(x) &amp;= xG_1 + x^2G_2 + x^3G_3+...\\</span><br><span class="line">xA_G(x) &amp;=\qquad\,\,\,\,\,\, x^2G_1 + x^3G_2 + x^4G_3+...\\</span><br><span class="line">x^2A_G(x) &amp;=\qquad\,\,\,\,\,\,\qquad\,\,\,\,\,\,\,\,\, x^3G_1 + x^4G_2 + x^5G_3+...</span><br><span class="line">\end&#123;aligned&#125;$$</span><br><span class="line"></span><br><span class="line">因为初始项分别为1和4,那么有</span><br><span class="line"></span><br><span class="line">$$A_G(x)=xA_G(x)+x^2A_G(x)+x+3x^2$$</span><br><span class="line">化简:</span><br><span class="line">$$A_G(x)=\frac&#123;x+3x^2&#125;&#123;1-x-x^2&#125;$$</span><br><span class="line">这就是修正的生成函数.</span><br><span class="line"></span><br><span class="line">令n=A_G(x),得到方程</span><br><span class="line"></span><br><span class="line">$$n(1-x-x^2)=x+3x^2$$</span><br><span class="line">其中</span><br><span class="line">$$\Delta=(1+n)^2-4(3+n)(-n)=5n^2+14n+1$$</span><br><span class="line">若有有理数解,那么delta必须是平方数,令</span><br><span class="line">$$5n^2+14n+1=m^2$$</span><br><span class="line">配方成pell方程直接求解:</span><br><span class="line"></span><br><span class="line">令</span><br><span class="line">X=5n+7,Y=m</span><br><span class="line"></span><br><span class="line"> Pell 方程：</span><br><span class="line"></span><br><span class="line">$$X^2-5Y^2=44$$</span><br><span class="line">直接求解判断即可,请给我python代码实现</span><br></pre></td></tr></table></figure>
<h2 id="gemini"><a href="#gemini" class="headerlink" title="gemini"></a>gemini</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">这是一个非常经典的生成函数与佩尔方程（Pell&#x27;s Equation）结合的问题。你的推导过程非常专业且准确，我们先简要复盘一下你的数学逻辑，然后给出 Python 实现。</span><br><span class="line"></span><br><span class="line">### 数学逻辑复盘</span><br><span class="line"></span><br><span class="line">1. **生成函数**：</span><br><span class="line">你推导出的生成函数  是完全正确的。</span><br><span class="line">2. **有理数判定**：</span><br><span class="line">令 ，得到关于  的二次方程：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">根据求根公式，若  为有理数，则判别式  必须是完全平方数：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3. **转化为佩尔方程**：</span><br><span class="line">为了求解 ，通过配方：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">令 ，，我们得到了广义佩尔方程：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们需要找到该方程满足  且  的前 30 个正整数解对应的 。</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">### Python 代码实现</span><br><span class="line"></span><br><span class="line">为了求解广义佩尔方程，我们首先需要找到**基本解**（Fundamental Solutions），然后利用单位方程  的基本解  来生成所有后续解。</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_modified_fibonacci_nuggets</span>(<span class="params">limit=<span class="number">30</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    求解方程 X^2 - 5Y^2 = 44</span></span><br><span class="line"><span class="string">    n = (X - 7) / 5</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 单位方程 u^2 - 5v^2 = 1 的基本解</span></span><br><span class="line">    u, v = <span class="number">9</span>, <span class="number">4</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 广义佩尔方程 X^2 - 5Y^2 = 44 的基本解 (x_i, y_i)</span></span><br><span class="line">    <span class="comment"># 搜索范围通过 Lmmel 算法确定，通常较小</span></span><br><span class="line">    <span class="comment"># 经检验，基本解集为:</span></span><br><span class="line">    fundamental_sols = [</span><br><span class="line">        (<span class="number">7</span>, <span class="number">1</span>), (<span class="number">7</span>, -<span class="number">1</span>),   <span class="comment"># 对应 n=0 (忽略)</span></span><br><span class="line">        (<span class="number">8</span>, <span class="number">2</span>), (<span class="number">8</span>, -<span class="number">2</span>),   <span class="comment"># 对应 n=0.2 (忽略)</span></span><br><span class="line">        (<span class="number">13</span>, <span class="number">5</span>), (<span class="number">13</span>, -<span class="number">5</span>)  <span class="comment"># 对应 n=1.2 (忽略)</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    nuggets = <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 从每个基本解出发生成序列</span></span><br><span class="line">    <span class="keyword">for</span> sx, sy <span class="keyword">in</span> fundamental_sols:</span><br><span class="line">        cx, cy = sx, sy</span><br><span class="line">        <span class="comment"># 生成足够多的解以确保覆盖前30个</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(limit * <span class="number">2</span>):</span><br><span class="line">            <span class="comment"># 下一个解迭代公式: (x + y√5) * (u + v√5)</span></span><br><span class="line">            nx = cx * u + <span class="number">5</span> * cy * v</span><br><span class="line">            ny = cx * v + cy * u</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查是否满足 n 是正整数</span></span><br><span class="line">            <span class="keyword">if</span> nx &gt; <span class="number">7</span> <span class="keyword">and</span> (nx - <span class="number">7</span>) % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">                n = (nx - <span class="number">7</span>) // <span class="number">5</span></span><br><span class="line">                nuggets.add(n)</span><br><span class="line">            </span><br><span class="line">            cx, cy = nx, ny</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># 排序并取前 30 个</span></span><br><span class="line">    result_list = <span class="built_in">sorted</span>(<span class="built_in">list</span>(nuggets))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证第20个是否为 211345365 (题目给出的提示)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(result_list) &gt;= <span class="number">20</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;第20个金块验证: <span class="subst">&#123;result_list[<span class="number">19</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    final_30 = result_list[:limit]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(final_30)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行计算</span></span><br><span class="line">total_sum = solve_modified_fibonacci_nuggets(<span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;前30个修正斐波那契金块的和为: <span class="subst">&#123;total_sum&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"></span><br><span class="line">### 代码要点说明</span><br><span class="line"></span><br><span class="line">* **基本解生成**：方程  有三组主基本解类。在代码中，我们通过 `(7, 1), (8, 2), (13, 5)` 及其共轭形式来初始化。</span><br><span class="line">* **迭代公式**：基于佩尔方程的特性，所有解都可以通过基本解与单位根的幂相乘得到。迭代式为：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* **过滤条件**：</span><br><span class="line">* ：确保 。</span><br><span class="line">* ：确保  是整数。由于  在迭代中模 5 的余数会呈现周期性（），所以每个序列中每两项就会产生一个整数 。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 下一步建议</span><br><span class="line"></span><br><span class="line">这段代码计算速度极快（毫秒级）。如果你对如何**手动寻找广义佩尔方程的基本解**感兴趣，我可以为你演示如何使用连分数法或暴力搜索法来确定这些起始点。你想了解这部分数学背景吗？</span><br></pre></td></tr></table></figure>
<h2 id="fun-fact"><a href="#fun-fact" class="headerlink" title="fun fact"></a>fun fact</h2><p>GPT一发WA,gemini一发过了,ds比gemini早想,但交题ac之后还在思考,真慢(最后答对了)</p>
<p>非常喜欢gemini的一点是,题简单思考时间也短,真的很像一个学者而不是程序.</p>
<p>Flu只有一个基础pell方程板子,碰到要解广义pell的题再说.</p>

        
  </div>
</article>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2026
    Fluorine Wang
  </div>
  <!-- 不蒜子统计 -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  <!-- 不蒜子统计 -->
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/friends/">友链</a></li><!--
     --><!--
       --><li><a href="/QSL/">QSL</a></li><!--
     -->
      </ul>
    </nav>
  </div>

</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
